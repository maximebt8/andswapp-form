<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer mon profil &SWAPP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #f8fafc 100%);
            min-height: 100%;
        }
        
        html, body {
            height: 100%;
        }
        
        :root {
            --green-dark: #2E5941;
            --green-light: #A5C1AA;
            --yellow: #FFCC00;
            --yellow-hover: #e6b800;
        }
        
        .form-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .step-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(46, 89, 65, 0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .step-header {
            background: linear-gradient(135deg, var(--green-dark) 0%, #3a6b4f 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .step-content {
            padding: 2rem;
        }
        
        .selection-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .selection-card:hover {
            border-color: #d1d5db;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .selection-card.selected {
            border-color: var(--green-dark);
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
            box-shadow: 0 8px 25px rgba(46, 89, 65, 0.12);
            transform: translateY(-2px);
        }
        
        .selection-card.selected::after {
            content: '✓';
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--green-dark);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .input-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .textarea-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
            min-height: 120px;
            resize: vertical;
        }
        
        .textarea-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .btn-primary {
            background: var(--yellow);
            color: var(--green-dark);
            border: none;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.3);
            font-size: 16px;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: var(--yellow-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: white;
            color: var(--green-dark);
            border: 2px solid var(--green-light);
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-secondary:hover {
            border-color: var(--green-dark);
            background: #f0f9f2;
            transform: translateY(-1px);
        }
        
        .btn-skip {
            background: #f8fafc;
            color: #64748b;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-skip:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        
        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--yellow) 0%, #ffd700 100%);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e5e7eb;
            margin: 0 6px;
            transition: all 0.3s ease;
        }
        
        .step-dot.active {
            background: var(--yellow);
            transform: scale(1.2);
        }
        
        .step-dot.completed {
            background: var(--green-dark);
        }
        
        .required::after {
            content: ' *';
            color: #ef4444;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }
        
        .modal.show .modal-content {
            transform: scale(1);
        }
        
        .emoji-large {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .date-range {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option {
            background: #f0f9ff;
            border: 2px solid #bae6fd;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option.selected {
            border-color: var(--green-dark);
            background: #f0fdf4;
        }
        
        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .priority-1 {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .priority-2 {
            background: #fef3c7;
            color: #d97706;
        }
        
        .priority-3 {
            background: #f0f9ff;
            color: #2563eb;
        }

        .copy-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 0.5rem;
        }
        
        .copy-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }
        
        .copy-button.copied {
            background: #dcfce7;
            border-color: #16a34a;
            color: #16a34a;
        }

        .city-vignette {
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .city-vignette:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        
        .city-vignette:active {
            transform: translateY(0);
        }

        .assistant-modal .modal-content {
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            text-align: left;
        }

        .assistant-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .assistant-preview {
            background: #f0fdf4;
            border: 2px solid #bbf7d0;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 100px;
        }

        .quality-tag {
            display: inline-block;
            background: #e0f2fe;
            border: 1px solid #0891b2;
            border-radius: 20px;
            padding: 0.25rem 0.75rem;
            margin: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quality-tag.selected {
            background: var(--green-dark);
            color: white;
            border-color: var(--green-dark);
        }

        .quality-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .city-suggestion {
            padding: 0.75rem;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s ease;
        }

        .city-suggestion:hover {
            background-color: #f8fafc;
        }

        .city-suggestion:last-child {
            border-bottom: none;
        }

        .city-suggestion.highlighted {
            background-color: #f0f9ff;
            border-left: 3px solid var(--green-dark);
        }

        .city-suggestion-name {
            font-weight: 600;
            color: var(--green-dark);
        }

        .city-suggestion-details {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .form-container {
                padding: 1rem;
            }
            
            .step-card {
                border-radius: 16px;
            }
            
            .step-content {
                padding: 1.5rem;
            }

            .assistant-modal .modal-content {
                max-width: 95%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="min-h-full">
        <!-- Header -->
        <div class="bg-white border-b border-gray-100 sticky top-0 z-40">
            <div class="form-container py-4 px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="text-2xl font-bold text-green-800">&SWAPP</div>
                        <div class="ml-4 text-gray-600">
                            <span class="text-sm">✨ Création de profil</span>
                        </div>
                    </div>
                    <div class="text-sm text-gray-500">
                        Étape <span id="current-step">1</span> sur 4
                    </div>
                </div>
            </div>
        </div>

        <div class="form-container py-8 px-4">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                </div>
                <div class="step-indicator mt-4">
                    <div class="step-dot active" data-step="1"></div>
                    <div class="step-dot" data-step="2"></div>
                    <div class="step-dot" data-step="3"></div>
                    <div class="step-dot" data-step="4"></div>
                </div>
            </div>

            <!-- Étape 1: Info sur mon appartement -->
            <div class="step-card" id="step-1">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 1</div>
                    <div class="emoji-large">🏡</div>
                    <h2 class="text-2xl font-bold mb-2">Info sur mon appartement</h2>
                    <p class="text-green-100">Présentez votre logement aux futurs swappers</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <!-- Localisation -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📍 Localisation</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="country" class="block text-sm font-medium text-gray-700 mb-2 required">Pays</label>
                                    <select id="country" class="input-field" required>
                                        <option value="">Sélectionner un pays</option>
                                        <option value="FR">France</option>
                                        <option value="ES">Espagne</option>
                                        <option value="IT">Italie</option>
                                        <option value="DE">Allemagne</option>
                                        <option value="UK">Royaume-Uni</option>
                                        <option value="US">États-Unis</option>
                                        <option value="CA">Canada</option>
                                        <option value="PT">Portugal</option>
                                        <option value="BE">Belgique</option>
                                        <option value="CH">Suisse</option>
                                        <option value="NL">Pays-Bas</option>
                                        <option value="other">Autre</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="region" class="block text-sm font-medium text-gray-700 mb-2 required">Région / État / Département</label>
                                    <input type="text" id="region" class="input-field" placeholder="Ex: Île-de-France, Californie, Toscane..." required>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="city" class="block text-sm font-medium text-gray-700 mb-2 required">Ville</label>
                                        <div class="relative">
                                            <input type="text" id="city" class="input-field" placeholder="Ex: Paris, Lyon, Marseille..." required autocomplete="off">
                                            <div id="city-suggestions" class="absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg hidden max-h-60 overflow-y-auto"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="postal-code" class="block text-sm font-medium text-gray-700 mb-2 required">Code postal</label>
                                        <input type="text" id="postal-code" class="input-field" placeholder="Ex: 75001" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Caractéristiques -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🏘️ Caractéristiques</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de chambres</label>
                                    <select id="bedrooms" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="0">Studio</option>
                                        <option value="1">1 chambre</option>
                                        <option value="2">2 chambres</option>
                                        <option value="3">3 chambres</option>
                                        <option value="4">4 chambres</option>
                                        <option value="5+">5+ chambres</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de couchages</label>
                                    <select id="sleeping-spots" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="1">1 personne</option>
                                        <option value="2">2 personnes</option>
                                        <option value="4">4 personnes</option>
                                        <option value="6">6 personnes</option>
                                        <option value="8+">8+ personnes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Superficie (m²)</label>
                                    <input type="number" id="surface" class="input-field" placeholder="Ex: 65">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Type de logement</label>
                                    <select id="housing-type" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="apartment">Appartement</option>
                                        <option value="house">Maison</option>
                                        <option value="room">Chambre</option>
                                        <option value="shared">Colocation complète</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Équipements -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">⚙️ Équipements essentiels</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="wifi">
                                    <span class="text-sm">📶 Wifi</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="workspace">
                                    <span class="text-sm">💻 Espace de travail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="kitchen">
                                    <span class="text-sm">🍳 Cuisine équipée</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="washing-machine">
                                    <span class="text-sm">🧺 Machine à laver</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="balcony">
                                    <span class="text-sm">🌿 Balcon / terrasse</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="parking">
                                    <span class="text-sm">🚗 Parking</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="pets-accepted">
                                    <span class="text-sm">🐾 Animaux acceptés</span>
                                </label>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Autre équipement</label>
                                <input type="text" id="other-equipment" class="input-field" placeholder="Ex: piscine, jardin, climatisation...">
                            </div>
                        </div>

                        <!-- Obligations pour le swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📋 Obligations pour la personne qui vient chez moi (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez ce que vous attendez de votre swapper pendant son séjour</p>
                            
                            <div class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="pet-care">
                                        <span class="text-sm">🐾 Garder mon animal</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="plant-care">
                                        <span class="text-sm">🌱 Arroser mes plantes</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="mail-collection">
                                        <span class="text-sm">📬 Relever le courrier</span>
                                    </label>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autres obligations ou instructions</label>
                                    <textarea id="other-obligations" class="textarea-field" placeholder="Ex: nourrir le chat 2x/jour, arroser les orchidées le dimanche, ne pas utiliser la machine à laver après 22h..." style="min-height: 80px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Photos -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📷 Photos de mon logement</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">📸</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photos demandées dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter vos photos après la création du profil pour optimiser vos chances de match !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Préparez 5-8 photos de qualité de votre logement (salon, chambre, cuisine, salle de bain, extérieur si applicable)</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between">
                            <div></div>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 2: Mon style d'échange et avec qui je veux échanger -->
            <div class="step-card hidden" id="step-2">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 2</div>
                    <div class="emoji-large">🔄</div>
                    <h2 class="text-2xl font-bold mb-2">Mon style d'échange et avec qui je veux échanger</h2>
                    <p class="text-green-100">Définissez vos préférences d'échange</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Style d'échange -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🔁 Mon style d'échange</h3>
                            <div class="space-y-4">
                                <div class="selection-card" data-exchange-style="reciprocal">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🔄</div>
                                        <div>
                                            <h4 class="font-semibold">Échange réciproque</h4>
                                            <p class="text-sm text-gray-600">Chacun séjourne chez l'autre aux mêmes dates</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="delayed">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⏳</div>
                                        <div>
                                            <h4 class="font-semibold">Échange décalé (non simultané)</h4>
                                            <p class="text-sm text-gray-600">Tu accueilles pendant ton absence, et séjournes plus tard chez l'autre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="both">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⚖️</div>
                                        <div>
                                            <h4 class="font-semibold">Ouvert aux deux</h4>
                                            <p class="text-sm text-gray-600">Flexible selon les opportunités</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="delayed-dates">
                                <h4 class="font-semibold text-gray-700 mb-2">Dates où mon logement sera libre pour accueillir quelqu'un = je ne serais pas chez moi</h4>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <p class="text-sm text-blue-700 mb-3">📅 Sélectionnez les périodes où votre logement sera disponible</p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                                            <input type="date" class="input-field">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                                            <input type="date" class="input-field">
                                        </div>
                                    </div>
                                    <button type="button" class="btn-secondary mt-3" onclick="addDelayedDateRange()">➕ Ajouter une autre période</button>
                                </div>
                            </div>
                        </div>

                        <!-- Avec qui je voyage -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👥 Avec qui je voyage</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="selection-card" data-travel-with="alone">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👤</div>
                                        <div>
                                            <h4 class="font-semibold">Seul(e)</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="couple">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">💑</div>
                                        <div>
                                            <h4 class="font-semibold">En couple</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="colocation">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🏘️</div>
                                        <div>
                                            <h4 class="font-semibold">En colocation</h4>
                                            <p class="text-sm text-gray-600">Préciser le nombre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="family">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👪</div>
                                        <div>
                                            <h4 class="font-semibold">En famille</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="other">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">✨</div>
                                        <div>
                                            <h4 class="font-semibold">Autre</h4>
                                            <p class="text-sm text-gray-600">À préciser</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="colocation-details">
                                <input type="number" class="input-field" placeholder="Nombre de colocataires" min="1" max="10">
                            </div>
                            <div class="mt-4 hidden" id="other-details">
                                <textarea class="textarea-field" placeholder="Précisez avec qui vous voyagez..."></textarea>
                            </div>
                        </div>

                        <!-- Animaux -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🐾 Animaux</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">As-tu un animal ?</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="no" class="mr-2" required>
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="hidden" id="pet-details">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Type d'animal</label>
                                            <select class="input-field">
                                                <option value="">Sélectionner</option>
                                                <option value="dog">Chien</option>
                                                <option value="cat">Chat</option>
                                                <option value="other">Autre</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                            <textarea class="textarea-field" placeholder="Ex: petit chien calme, gros chat indépendant..."></textarea>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Voyages-tu avec ton animal ?</label>
                                            <div class="flex gap-4">
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="yes" class="mr-2">
                                                    <span>Oui</span>
                                                </label>
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="no" class="mr-2">
                                                    <span>Non</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Profil idéal swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">👤 Profil idéal de mon swapper (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez le type de personne avec qui vous aimeriez échanger</p>
                            
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700">Description libre</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showSwapperAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="ideal-swapper-description" class="textarea-field" placeholder="Ex: Personne calme et respectueuse, amateur de culture, jeune professionnel, famille avec enfants..."></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Tranche d'âge souhaitée</label>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="18-25">
                                            <span class="text-sm">18-25 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="26-35">
                                            <span class="text-sm">26-35 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="36-50">
                                            <span class="text-sm">36-50 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="50+">
                                            <span class="text-sm">50+ ans</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Flexibilité recherchée</label>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="dates-flexible">
                                            <span class="text-sm">🗓️ Flexible sur les dates</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="duration-flexible">
                                            <span class="text-sm">⏰ Flexible sur la durée</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="destination-flexible">
                                            <span class="text-sm">📍 Flexible sur la destination</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="exchange-type-flexible">
                                            <span class="text-sm">🔄 Flexible sur le type d'échange</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 3: Création de mon expérience -->
            <div class="step-card hidden" id="step-3">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 3</div>
                    <div class="emoji-large">✨</div>
                    <h2 class="text-2xl font-bold mb-2">Création de mon expérience</h2>
                    <p class="text-green-100">Créons votre annonce d'échange attractive</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="flex items-center mb-2">
                                <div class="text-2xl mr-3">💡</div>
                                <h4 class="font-semibold text-blue-800">Qu'est-ce qu'une expérience &SWAPP ?</h4>
                            </div>
                            <p class="text-sm text-blue-700">
                                Une expérience, c'est votre annonce d'échange ! Elle contient votre destination souhaitée, vos dates, 
                                un titre accrocheur et une description qui donne envie. Plus elle est détaillée et inspirante, 
                                plus vous aurez de chances de trouver le swapper parfait ! 🚀
                            </p>
                        </div>

                        <!-- Destination -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🌍 Où je veux partir</h3>
                            <div>
                                <label for="main-destination" class="block text-sm font-medium text-gray-700 mb-2 required">Ville principale souhaitée</label>
                                <div class="relative">
                                    <input type="text" id="main-destination" class="input-field pr-20" placeholder="Ex: Lisbonne, Tokyo, New York..." required>
                                    <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-2xl hover:scale-110 transition-transform" onclick="surpriseMe()" title="Surprends-moi !">
                                        🎲
                                    </button>
                                </div>
                                <div class="mt-2 flex flex-wrap gap-2">
                                    <button type="button" class="btn-skip text-xs" onclick="showAvailableCities()">
                                        📍 Voir les villes disponibles
                                    </button>
                                    <button type="button" class="btn-skip text-xs" onclick="showExperienceExamples()">
                                        ✨ Voir des exemples d'expériences
                                    </button>
                                </div>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Options flexibles (facultatif - sélection multiple possible)</h4>
                                <p class="text-sm text-gray-600 mb-4">💡 Ajouter des options flexibles augmente vos chances de match !</p>
                                
                                <!-- Option région -->
                                <div class="flexible-option mb-3" data-flexible-type="region">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="region">
                                        <div>
                                            <h5 class="font-semibold">🌍 Région / zone géographique</h5>
                                            <p class="text-sm text-gray-600">Ex: Sud de la France, Ouest canadien, à moins de 3h de vol de Washington</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="region-input">
                                        <input type="text" class="input-field" placeholder="Décrivez la région souhaitée...">
                                    </div>
                                </div>

                                <!-- Option villes multiples -->
                                <div class="flexible-option mb-3" data-flexible-type="cities">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="cities">
                                        <div>
                                            <h5 class="font-semibold">📍 Liste de 3 à 5 autres villes</h5>
                                            <p class="text-sm text-gray-600">Ex: Barcelone, Rome, Porto, Séville, Madrid</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="cities-input">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                            <input type="text" class="input-field" placeholder="Ville 1">
                                            <input type="text" class="input-field" placeholder="Ville 2">
                                            <input type="text" class="input-field" placeholder="Ville 3">
                                            <input type="text" class="input-field" placeholder="Ville 4 (optionnel)">
                                            <input type="text" class="input-field" placeholder="Ville 5 (optionnel)">
                                        </div>
                                    </div>
                                </div>

                                <!-- Option type de destination -->
                                <div class="flexible-option" data-flexible-type="destination-type">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="destination-type">
                                        <div>
                                            <h5 class="font-semibold">☀️ Type de destination</h5>
                                            <p class="text-sm text-gray-600">Ex: au soleil, en montagne, dans une capitale, ville culturelle</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="destination-type-input">
                                        <select class="input-field">
                                            <option value="">Choisir un type</option>
                                            <option value="sunny">Au soleil</option>
                                            <option value="mountain">En montagne</option>
                                            <option value="capital">Dans une capitale</option>
                                            <option value="cultural">Ville culturelle</option>
                                            <option value="seaside">Bord de mer</option>
                                            <option value="countryside">À la campagne</option>
                                            <option value="historic">Ville historique</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dates -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🗓️ Quand je veux partir</h3>
                            <div>
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Dates souhaitées</h4>
                                <div id="date-ranges">
                                    <div class="date-range">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                                                <input type="date" class="input-field date-start" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                                                <input type="date" class="input-field date-end" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary mt-3" onclick="addDateRange()">
                                    ➕ Ajouter une autre plage de dates
                                </button>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Période ou durée flexible (facultatif)</h4>
                                <p class="text-sm text-gray-600 mb-4">🪄 Indiquer une période souple augmente les chances de match</p>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Durée souhaitée</label>
                                        <select class="input-field" id="flexible-duration">
                                            <option value="">Sélectionner une durée</option>
                                            <option value="weekend">Un week-end</option>
                                            <option value="week">Une semaine</option>
                                            <option value="2weeks">Deux semaines</option>
                                            <option value="month">Un mois</option>
                                            <option value="2months">Deux mois</option>
                                            <option value="3months">Plus de 3 mois</option>
                                            <option value="flexible">Flexible</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Période générale</label>
                                        <input type="text" id="flexible-period" class="input-field" placeholder="Ex: été 2024, automne, décembre 2025...">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Titre et description -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">📝 Mon annonce</h3>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Titre de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showTitleAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <input type="text" id="experience-title" class="input-field" placeholder="Ex: Échange Paris ↔ Lisbonne - Découverte culturelle en couple" required>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Mentionnez votre ville, la destination et le type d'expérience</p>
                                </div>
                                
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Description de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showDescriptionAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="experience-description" class="textarea-field" placeholder="Décrivez votre projet d'échange, ce que vous recherchez, vos motivations, ce que vous pouvez offrir... Plus c'est détaillé et personnel, mieux c'est !" required style="min-height: 150px;"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Parlez de vos motivations, de votre quartier, de ce que vous aimez faire, de vos recommandations locales...</p>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-center">
                                <button type="button" class="btn-skip text-xs" onclick="showAnnouncementExamples()">
                                    📝 Voir des exemples d'annonces inspirantes
                                </button>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 4: Les infos sur moi -->
            <div class="step-card hidden" id="step-4">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 4</div>
                    <div class="emoji-large">👤</div>
                    <h2 class="text-2xl font-bold mb-2">Les infos sur moi</h2>
                    <p class="text-green-100">Finalisez votre profil personnel</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Profil utilisateur -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👤 Mes informations personnelles</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Prénom</label>
                                    <input type="text" id="first-name" class="input-field" placeholder="Marie" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nom</label>
                                    <input type="text" id="last-name" class="input-field" placeholder="Dupont" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Email</label>
                                    <input type="email" id="email" class="input-field" placeholder="marie@example.com" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Téléphone (WhatsApp)</label>
                                    <input type="tel" id="phone" class="input-field" placeholder="+33 6 12 34 56 78">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Âge</label>
                                    <input type="number" id="age" class="input-field" placeholder="28" min="18" max="99" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Société V.I.E (facultatif)</label>
                                    <input type="text" id="vie-company" class="input-field" placeholder="Ex: Airbus, Total, BNP Paribas...">
                                </div>
                            </div>
                        </div>

                        <!-- Style de séjour et motivations -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">💫 Mon style et mes motivations</h3>
                            
                            <!-- Pourquoi j'échange -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">💭 Pourquoi j'échange (2 choix max)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="change-air">
                                        <span class="text-sm">🌬️ Changer d'air / télétravailler ailleurs</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="culture">
                                        <span class="text-sm">🌍 Découvrir une autre culture</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="break">
                                        <span class="text-sm">😌 Faire une pause / un break</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="family">
                                        <span class="text-sm">👨‍👩‍👧‍👦 Rejoindre des proches</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="climate">
                                        <span class="text-sm">☀️ Profiter d'un climat différent</span>
                                    </label>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autre raison</label>
                                    <input type="text" id="other-reason" class="input-field" placeholder="Précisez votre motivation...">
                                </div>
                            </div>

                            <!-- Style de séjour -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">🌈 Mon style de séjour (1 choix max)</h4>
                                <div class="space-y-3">
                                    <div class="selection-card" data-stay-style="calm">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🧘</div>
                                            <div>
                                                <h5 class="font-semibold">Calme & reposant</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="dynamic">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🎉</div>
                                            <div>
                                                <h5 class="font-semibold">Dynamique & festif</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="immersive">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🏛️</div>
                                            <div>
                                                <h5 class="font-semibold">Immersif & local</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="work">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">💻</div>
                                            <div>
                                                <h5 class="font-semibold">Télétravail & routine</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="nature">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🌲</div>
                                            <div>
                                                <h5 class="font-semibold">Nature & extérieur</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ce qu'il faut savoir sur moi -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🔑 Ce qu'il faut savoir sur moi</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Fumeur</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Télétravail</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Photo de profil -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📸 Ma photo de profil</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">👤</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photo demandée dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter votre photo de profil après la création pour humaniser votre profil !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Une photo souriante et naturelle inspire confiance et augmente vos chances de match</p>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="completeProfile()">
                                🚀 Finaliser mon profil
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content">
            <div class="emoji-large">🎉</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Félicitations !</h3>
            <p class="text-gray-600 mb-4">✨ Votre profil &SWAPP a été créé avec succès !</p>
            <div id="photo-reminder" class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4 hidden">
                <p class="text-sm text-yellow-800">💡 <strong>Conseil :</strong> Pensez à ajouter des photos de votre logement et une photo de profil dans un second temps pour maximiser vos chances de match !</p>
            </div>
            <p class="text-sm text-gray-500 mb-6">Vous pouvez maintenant découvrir les expériences de la communauté.</p>
            <div class="flex flex-col space-y-3">
                <button class="btn-primary" onclick="window.open('https://andswapp.com', '_blank')">
                    📧 Suivre le projet
                </button>
                <button class="btn-secondary" onclick="editProfile()">
                    ✏️ Modifier mon profil
                </button>
                <button class="btn-skip mt-2" onclick="showFeedbackModal()">
                    💬 Donner mon avis sur le formulaire
                </button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="emoji-large">💬</div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">Votre avis nous intéresse !</h3>
            <p class="text-gray-600 mb-6">Aidez-nous à améliorer ce formulaire en partageant vos suggestions avec Maxime :</p>
            
            <div class="space-y-6">
                <!-- Contact WhatsApp/SMS -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-green-800 flex items-center">
                            📱 WhatsApp / SMS
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('+33647034827', this)" title="Copier le numéro">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-green-700 font-mono text-lg mb-3">+33 6 47 03 48 27</p>
                    <p class="text-sm text-green-600">💬 Contactez Maxime directement sur ce numéro</p>
                </div>

                <!-- Contact Email -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-blue-800 flex items-center">
                            📧 Email
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('maxime.barret@andswapp.com', this)" title="Copier l'email">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-blue-700 font-mono text-lg mb-3">maxime.barret@andswapp.com</p>
                    <a href="mailto:maxime.barret@andswapp.com?subject=Feedback%20formulaire%20&SWAPP&body=Salut%20Maxime%20!%0A%0AJ'ai%20testé%20le%20formulaire%20de%20création%20de%20profil%20&SWAPP%20et%20j'aimerais%20partager%20mon%20feedback%20:%0A%0A" 
                       class="btn-secondary w-full inline-block text-center">
                        📧 Envoyer un email
                    </a>
                </div>

                <!-- Suggestions d'amélioration -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">💡 Idées de feedback :</h4>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• Étapes trop longues ou trop courtes ?</li>
                        <li>• Champs manquants ou inutiles ?</li>
                        <li>• Interface confuse ou claire ?</li>
                        <li>• Suggestions d'amélioration ?</li>
                        <li>• Bugs ou problèmes techniques ?</li>
                    </ul>
                </div>
            </div>
            
            <div class="flex space-x-3 mt-6">
                <button class="btn-secondary flex-1" onclick="closeFeedbackModal()">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedTravelWith = null;
        let selectedExchangeStyle = null;
        let selectedStayStyle = null;
        let dateRangeCount = 1;
        let selectedCityIndex = -1;

        // Base de données des villes françaises principales avec régions et codes postaux
        const frenchCities = [
            { name: "Paris", region: "Île-de-France", postalCode: "75001", country: "FR" },
            { name: "Lyon", region: "Auvergne-Rhône-Alpes", postalCode: "69001", country: "FR" },
            { name: "Marseille", region: "Provence-Alpes-Côte d'Azur", postalCode: "13001", country: "FR" },
            { name: "Toulouse", region: "Occitanie", postalCode: "31000", country: "FR" },
            { name: "Nice", region: "Provence-Alpes-Côte d'Azur", postalCode: "06000", country: "FR" },
            { name: "Nantes", region: "Pays de la Loire", postalCode: "44000", country: "FR" },
            { name: "Montpellier", region: "Occitanie", postalCode: "34000", country: "FR" },
            { name: "Strasbourg", region: "Grand Est", postalCode: "67000", country: "FR" },
            { name: "Bordeaux", region: "Nouvelle-Aquitaine", postalCode: "33000", country: "FR" },
            { name: "Lille", region: "Hauts-de-France", postalCode: "59000", country: "FR" },
            { name: "Rennes", region: "Bretagne", postalCode: "35000", country: "FR" },
            { name: "Reims", region: "Grand Est", postalCode: "51100", country: "FR" },
            { name: "Saint-Étienne", region: "Auvergne-Rhône-Alpes", postalCode: "42000", country: "FR" },
            { name: "Toulon", region: "Provence-Alpes-Côte d'Azur", postalCode: "83000", country: "FR" },
            { name: "Le Havre", region: "Normandie", postalCode: "76600", country: "FR" },
            { name: "Grenoble", region: "Auvergne-Rhône-Alpes", postalCode: "38000", country: "FR" },
            { name: "Dijon", region: "Bourgogne-Franche-Comté", postalCode: "21000", country: "FR" },
            { name: "Angers", region: "Pays de la Loire", postalCode: "49000", country: "FR" },
            { name: "Nîmes", region: "Occitanie", postalCode: "30000", country: "FR" },
            { name: "Villeurbanne", region: "Auvergne-Rhône-Alpes", postalCode: "69100", country: "FR" },
            { name: "Clermont-Ferrand", region: "Auvergne-Rhône-Alpes", postalCode: "63000", country: "FR" },
            { name: "Le Mans", region: "Pays de la Loire", postalCode: "72000", country: "FR" },
            { name: "Aix-en-Provence", region: "Provence-Alpes-Côte d'Azur", postalCode: "13100", country: "FR" },
            { name: "Brest", region: "Bretagne", postalCode: "29200", country: "FR" },
            { name: "Tours", region: "Centre-Val de Loire", postalCode: "37000", country: "FR" },
            { name: "Amiens", region: "Hauts-de-France", postalCode: "80000", country: "FR" },
            { name: "Limoges", region: "Nouvelle-Aquitaine", postalCode: "87000", country: "FR" },
            { name: "Annecy", region: "Auvergne-Rhône-Alpes", postalCode: "74000", country: "FR" },
            { name: "Perpignan", region: "Occitanie", postalCode: "66000", country: "FR" },
            { name: "Besançon", region: "Bourgogne-Franche-Comté", postalCode: "25000", country: "FR" },
            { name: "Orléans", region: "Centre-Val de Loire", postalCode: "45000", country: "FR" },
            { name: "Metz", region: "Grand Est", postalCode: "57000", country: "FR" },
            { name: "Rouen", region: "Normandie", postalCode: "76000", country: "FR" },
            { name: "Mulhouse", region: "Grand Est", postalCode: "68100", country: "FR" },
            { name: "Caen", region: "Normandie", postalCode: "14000", country: "FR" },
            { name: "Nancy", region: "Grand Est", postalCode: "54000", country: "FR" }
        ];

        // Villes internationales populaires pour les échanges
        const internationalCities = [
            { name: "Barcelone", region: "Catalogne", postalCode: "08001", country: "ES" },
            { name: "Madrid", region: "Communauté de Madrid", postalCode: "28001", country: "ES" },
            { name: "Lisbonne", region: "Région de Lisbonne", postalCode: "1000", country: "PT" },
            { name: "Rome", region: "Latium", postalCode: "00100", country: "IT" },
            { name: "Milan", region: "Lombardie", postalCode: "20100", country: "IT" },
            { name: "Florence", region: "Toscane", postalCode: "50100", country: "IT" },
            { name: "Berlin", region: "Berlin", postalCode: "10115", country: "DE" },
            { name: "Munich", region: "Bavière", postalCode: "80331", country: "DE" },
            { name: "Amsterdam", region: "Hollande-Septentrionale", postalCode: "1012", country: "NL" },
            { name: "Bruxelles", region: "Région de Bruxelles-Capitale", postalCode: "1000", country: "BE" },
            { name: "Londres", region: "Angleterre", postalCode: "SW1A", country: "UK" },
            { name: "New York", region: "New York", postalCode: "10001", country: "US" },
            { name: "Los Angeles", region: "Californie", postalCode: "90210", country: "US" },
            { name: "Montréal", region: "Québec", postalCode: "H2X", country: "CA" },
            { name: "Toronto", region: "Ontario", postalCode: "M5H", country: "CA" }
        ];

        // Combine toutes les villes
        const allCities = [...frenchCities, ...internationalCities];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            setupEventListeners();
            setupCityAutocomplete();
        });

        function setupEventListeners() {
            // Selection cards
            document.addEventListener('click', function(e) {
                const card = e.target.closest('.selection-card');
                if (card) {
                    const group = card.getAttribute('data-travel-with') || 
                                 card.getAttribute('data-exchange-style') || 
                                 card.getAttribute('data-stay-style');
                    
                    if (card.getAttribute('data-travel-with')) {
                        document.querySelectorAll('[data-travel-with]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedTravelWith = card.getAttribute('data-travel-with');
                        
                        // Show/hide additional inputs
                        document.getElementById('colocation-details').classList.toggle('hidden', selectedTravelWith !== 'colocation');
                        document.getElementById('other-details').classList.toggle('hidden', selectedTravelWith !== 'other');
                    }
                    
                    if (card.getAttribute('data-exchange-style')) {
                        document.querySelectorAll('[data-exchange-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedExchangeStyle = card.getAttribute('data-exchange-style');
                        
                        // Show/hide delayed dates
                        document.getElementById('delayed-dates').classList.toggle('hidden', selectedExchangeStyle !== 'delayed' && selectedExchangeStyle !== 'both');
                    }
                    
                    if (card.getAttribute('data-stay-style')) {
                        document.querySelectorAll('[data-stay-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedStayStyle = card.getAttribute('data-stay-style');
                    }
                }
            });

            // Flexible options
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('flexible-checkbox')) {
                    const option = e.target.closest('.flexible-option');
                    const inputDiv = option.querySelector('div[id$="-input"]');
                    
                    if (e.target.checked) {
                        option.classList.add('selected');
                        inputDiv.classList.remove('hidden');
                    } else {
                        option.classList.remove('selected');
                        inputDiv.classList.add('hidden');
                    }
                }
            });

            // Pet details
            document.addEventListener('change', function(e) {
                if (e.target.name === 'has-pet') {
                    document.getElementById('pet-details').classList.toggle('hidden', e.target.value !== 'yes');
                }
            });

            // Photos seront demandées dans un second temps - pas de gestion d'upload ici

            // Reason checkboxes (max 2)
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('reason-checkbox')) {
                    const checked = document.querySelectorAll('.reason-checkbox:checked');
                    if (checked.length > 2) {
                        e.target.checked = false;
                        showNotification('Vous pouvez sélectionner maximum 2 raisons', 'error');
                    }
                }
            });
        }

        function setupCityAutocomplete() {
            const cityInput = document.getElementById('city');
            const suggestionsDiv = document.getElementById('city-suggestions');
            const regionInput = document.getElementById('region');
            const postalCodeInput = document.getElementById('postal-code');
            const countrySelect = document.getElementById('country');

            cityInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();
                selectedCityIndex = -1;

                if (query.length < 2) {
                    hideSuggestions();
                    return;
                }

                const matches = allCities.filter(city => 
                    city.name.toLowerCase().includes(query) ||
                    city.region.toLowerCase().includes(query)
                ).slice(0, 8); // Limite à 8 résultats

                if (matches.length > 0) {
                    showSuggestions(matches);
                } else {
                    hideSuggestions();
                }
            });

            cityInput.addEventListener('keydown', function(e) {
                const suggestions = suggestionsDiv.querySelectorAll('.city-suggestion');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    selectedCityIndex = Math.min(selectedCityIndex + 1, suggestions.length - 1);
                    updateHighlight(suggestions);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    selectedCityIndex = Math.max(selectedCityIndex - 1, -1);
                    updateHighlight(suggestions);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (selectedCityIndex >= 0 && suggestions[selectedCityIndex]) {
                        selectCity(suggestions[selectedCityIndex].dataset.cityIndex);
                    }
                } else if (e.key === 'Escape') {
                    hideSuggestions();
                }
            });

            // Fermer les suggestions en cliquant ailleurs
            document.addEventListener('click', function(e) {
                if (!cityInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                    hideSuggestions();
                }
            });

            function showSuggestions(cities) {
                suggestionsDiv.innerHTML = '';
                
                cities.forEach((city, index) => {
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.className = 'city-suggestion';
                    suggestionDiv.dataset.cityIndex = allCities.indexOf(city);
                    
                    const countryFlag = getCountryFlag(city.country);
                    
                    suggestionDiv.innerHTML = `
                        <div class="city-suggestion-name">${countryFlag} ${city.name}</div>
                        <div class="city-suggestion-details">${city.region} • ${city.postalCode}</div>
                    `;
                    
                    suggestionDiv.addEventListener('click', function() {
                        selectCity(this.dataset.cityIndex);
                    });
                    
                    suggestionsDiv.appendChild(suggestionDiv);
                });
                
                suggestionsDiv.classList.remove('hidden');
            }

            function hideSuggestions() {
                suggestionsDiv.classList.add('hidden');
                selectedCityIndex = -1;
            }

            function updateHighlight(suggestions) {
                suggestions.forEach((suggestion, index) => {
                    suggestion.classList.toggle('highlighted', index === selectedCityIndex);
                });
            }

            function selectCity(cityIndex) {
                const city = allCities[cityIndex];
                
                // Remplir automatiquement tous les champs
                cityInput.value = city.name;
                regionInput.value = city.region;
                postalCodeInput.value = city.postalCode;
                countrySelect.value = city.country;
                
                hideSuggestions();
                
                // Animation de confirmation
                cityInput.style.borderColor = '#10b981';
                setTimeout(() => {
                    cityInput.style.borderColor = '';
                }, 1000);
            }

            function getCountryFlag(countryCode) {
                const flags = {
                    'FR': '🇫🇷',
                    'ES': '🇪🇸', 
                    'IT': '🇮🇹',
                    'DE': '🇩🇪',
                    'PT': '🇵🇹',
                    'NL': '🇳🇱',
                    'BE': '🇧🇪',
                    'UK': '🇬🇧',
                    'US': '🇺🇸',
                    'CA': '🇨🇦'
                };
                return flags[countryCode] || '🌍';
            }
        }

        function addDateRange() {
            dateRangeCount++;
            const dateRangesDiv = document.getElementById('date-ranges');
            const newRange = document.createElement('div');
            newRange.className = 'date-range';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Plage de dates ${dateRangeCount}</span>
                    <button type="button" class="text-red-500 hover:text-red-700" onclick="removeDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                        <input type="date" class="input-field date-start">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                        <input type="date" class="input-field date-end">
                    </div>
                </div>
            `;
            dateRangesDiv.appendChild(newRange);
        }

        function addDelayedDateRange() {
            const delayedDatesDiv = document.getElementById('delayed-dates');
            const existingRanges = delayedDatesDiv.querySelectorAll('.bg-blue-50').length;
            
            const newRange = document.createElement('div');
            newRange.className = 'bg-blue-50 border border-blue-200 rounded-lg p-4 mt-3';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <p class="text-sm text-blue-700 font-medium">📅 Période ${existingRanges + 1}</p>
                    <button type="button" class="text-red-500 hover:text-red-700 text-sm" onclick="removeDelayedDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                        <input type="date" class="input-field">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                        <input type="date" class="input-field">
                    </div>
                </div>
            `;
            
            // Insert before the "Ajouter" button
            const addButton = delayedDatesDiv.querySelector('button');
            addButton.parentNode.insertBefore(newRange, addButton);
        }

        function removeDelayedDateRange(button) {
            button.closest('.bg-blue-50').remove();
        }

        function removeDateRange(button) {
            button.closest('.date-range').remove();
        }

        function nextStep() {
            if (validateCurrentStep()) {
                currentStep++;
                if (currentStep > 4) currentStep = 4;
                showStep(currentStep);
                updateProgress();
            }
        }

        function prevStep() {
            currentStep--;
            if (currentStep < 1) currentStep = 1;
            showStep(currentStep);
            updateProgress();
        }

        function showStep(step) {
            // Hide all steps
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`step-${i}`).classList.add('hidden');
            }
            
            // Show current step
            document.getElementById(`step-${step}`).classList.remove('hidden');
            
            // Update step indicator
            document.getElementById('current-step').textContent = step;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const progress = (currentStep / 4) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            // Update step dots
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    dot.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    dot.classList.add('active');
                }
            });
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const country = document.getElementById('country').value;
                    const region = document.getElementById('region').value;
                    const city = document.getElementById('city').value;
                    const postalCode = document.getElementById('postal-code').value;
                    const bedrooms = document.getElementById('bedrooms').value;
                    const sleepingSpots = document.getElementById('sleeping-spots').value;
                    const housingType = document.getElementById('housing-type').value;
                    
                    if (!country || !region || !city || !postalCode || !bedrooms || !sleepingSpots || !housingType) {
                        showNotification('Veuillez remplir tous les champs obligatoires.', 'error');
                        return false;
                    }
                    break;
                    
                case 2:
                    if (!selectedExchangeStyle) {
                        showNotification('Veuillez choisir votre style d\'échange.', 'error');
                        return false;
                    }
                    
                    if (!selectedTravelWith) {
                        showNotification('Veuillez indiquer avec qui vous voyagez.', 'error');
                        return false;
                    }
                    
                    const hasPet = document.querySelector('input[name="has-pet"]:checked');
                    if (!hasPet) {
                        showNotification('Veuillez indiquer si vous avez un animal.', 'error');
                        return false;
                    }
                    break;
                    
                case 3:
                    const mainDestination = document.getElementById('main-destination').value;
                    if (!mainDestination) {
                        showNotification('Veuillez indiquer votre destination principale.', 'error');
                        return false;
                    }
                    
                    const dateStarts = document.querySelectorAll('.date-start');
                    const dateEnds = document.querySelectorAll('.date-end');
                    let hasValidDate = false;
                    
                    for (let i = 0; i < dateStarts.length; i++) {
                        if (dateStarts[i].value && dateEnds[i].value) {
                            hasValidDate = true;
                            break;
                        }
                    }
                    
                    if (!hasValidDate) {
                        showNotification('Veuillez renseigner au moins une plage de dates.', 'error');
                        return false;
                    }
                    
                    const experienceTitle = document.getElementById('experience-title').value;
                    const experienceDescription = document.getElementById('experience-description').value;
                    
                    if (!experienceTitle || !experienceDescription) {
                        showNotification('Veuillez remplir le titre et la description de votre expérience.', 'error');
                        return false;
                    }
                    break;
                    
                case 4:
                    const firstName = document.getElementById('first-name').value;
                    const lastName = document.getElementById('last-name').value;
                    const email = document.getElementById('email').value;
                    const age = document.getElementById('age').value;
                    
                    if (!firstName || !lastName || !email || !age) {
                        showNotification('Veuillez remplir tous les champs obligatoires du profil.', 'error');
                        return false;
                    }
                    break;
            }
            return true;
        }

        function completeProfile() {
            if (validateCurrentStep()) {
                // Collect all form data
                const formData = collectAllFormData();
                
                // Send to Zapier
                sendToZapier(formData);
                
                // Toujours afficher le rappel photos car elles seront demandées plus tard
                document.getElementById('photo-reminder').classList.remove('hidden');
                
                showNotification('✨ Profil créé avec succès !', 'success');
                setTimeout(() => {
                    document.getElementById('success-modal').classList.add('show');
                }, 1000);
            }
        }

        function collectAllFormData() {
            const data = {
                // Timestamp
                timestamp: new Date().toISOString(),
                
                // Étape 1 - Appartement
                country: document.getElementById('country').value,
                region: document.getElementById('region').value,
                city: document.getElementById('city').value,
                postalCode: document.getElementById('postal-code').value,
                bedrooms: document.getElementById('bedrooms').value,
                sleepingSpots: document.getElementById('sleeping-spots').value,
                surface: document.getElementById('surface').value,
                housingType: document.getElementById('housing-type').value,
                
                // Équipements
                equipment: Array.from(document.querySelectorAll('.equipment-checkbox:checked')).map(cb => cb.value),
                otherEquipment: document.getElementById('other-equipment').value,
                
                // Obligations pour le swapper
                obligations: Array.from(document.querySelectorAll('.obligation-checkbox:checked')).map(cb => cb.value),
                otherObligations: document.getElementById('other-obligations').value,
                
                // Étape 2 - Style d'échange
                exchangeStyle: selectedExchangeStyle,
                travelWith: selectedTravelWith,
                
                // Animaux
                hasPet: document.querySelector('input[name="has-pet"]:checked')?.value,
                travelWithPet: document.querySelector('input[name="travel-with-pet"]:checked')?.value,
                
                // Profil swapper idéal
                idealSwapperDescription: document.getElementById('ideal-swapper-description').value,
                agePreferences: Array.from(document.querySelectorAll('.age-preference:checked')).map(cb => cb.value),
                flexibilityPreferences: Array.from(document.querySelectorAll('.flexibility-preference:checked')).map(cb => cb.value),
                
                // Étape 3 - Expérience
                mainDestination: document.getElementById('main-destination').value,
                flexibleDuration: document.getElementById('flexible-duration').value,
                flexiblePeriod: document.getElementById('flexible-period').value,
                experienceTitle: document.getElementById('experience-title').value,
                experienceDescription: document.getElementById('experience-description').value,
                
                // Dates
                dateRanges: Array.from(document.querySelectorAll('.date-range')).map(range => ({
                    start: range.querySelector('.date-start').value,
                    end: range.querySelector('.date-end').value
                })).filter(range => range.start && range.end),
                
                // Options flexibles
                flexibleOptions: {
                    region: document.querySelector('[data-flexible-type="region"] input:checked') ? 
                           document.querySelector('[data-flexible-type="region"] #region-input input').value : null,
                    cities: document.querySelector('[data-flexible-type="cities"] input:checked') ? 
                           Array.from(document.querySelectorAll('[data-flexible-type="cities"] #cities-input input')).map(i => i.value).filter(v => v) : null,
                    destinationType: document.querySelector('[data-flexible-type="destination-type"] input:checked') ? 
                                   document.querySelector('[data-flexible-type="destination-type"] select').value : null
                },
                
                // Étape 4 - Profil personnel
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                age: document.getElementById('age').value,
                vieCompany: document.getElementById('vie-company').value,
                
                // Motivations et style
                reasons: Array.from(document.querySelectorAll('.reason-checkbox:checked')).map(cb => cb.value),
                otherReason: document.getElementById('other-reason').value,
                stayStyle: selectedStayStyle,
                
                // Infos personnelles
                smoker: document.querySelector('input[name="smoker"]:checked')?.value,
                remoteWork: document.querySelector('input[name="remote-work"]:checked')?.value,
                
                // Photos (seront demandées dans un second temps)
                hasApartmentPhotos: false,
                hasProfilePhoto: false
            };
            
            return data;
        }

        function sendToZapier(data) {
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            console.log('🚀 ENVOI À ZAPIER - Début');
            console.log('📡 URL Zapier:', zapierUrl);
            console.log('📦 Données à envoyer:', data);
            
            // Affichage visuel pour l'utilisateur
            showNotification('📡 Envoi des données à Zapier...', 'info');
            
            fetch(zapierUrl, {
                method: 'POST',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 Réponse Zapier reçue');
                console.log('📊 Status:', response.status);
                console.log('📋 Status Text:', response.statusText);
                console.log('🔗 URL finale:', response.url);
                
                if (response.ok || response.status === 200) {
                    console.log('✅ SUCCÈS - Données envoyées à Zapier avec succès !');
                    showNotification('✅ Données envoyées à Zapier avec succès !', 'success');
                    
                    // Lire la réponse pour plus de détails
                    return response.text();
                } else {
                    console.error('❌ ERREUR - Status HTTP:', response.status);
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(responseText => {
                console.log('📄 Réponse Zapier complète:', responseText);
            })
            .catch(error => {
                console.error('❌ ERREUR RÉSEAU - Détails complètes:', error);
                console.error('🔍 Type d\'erreur:', error.name);
                console.error('💬 Message d\'erreur:', error.message);
                console.error('📚 Stack trace:', error.stack);
                
                // Fallback : essayer avec une méthode alternative
                console.log('🔄 Tentative de fallback...');
                tryZapierFallback(data);
            });
        }

        function tryZapierFallback(data) {
            console.log('🔄 FALLBACK - Tentative avec méthode alternative');
            
            // Essayer avec une requête plus simple
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            fetch(zapierUrl, {
                method: 'POST',
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 FALLBACK - Réponse reçue:', response.status);
                if (response.ok || response.status === 200) {
                    console.log('✅ FALLBACK SUCCÈS !');
                    showNotification('✅ Données envoyées avec succès (méthode alternative)', 'success');
                } else {
                    throw new Error(`Fallback failed: ${response.status}`);
                }
            })
            .catch(fallbackError => {
                console.error('❌ FALLBACK ÉCHOUÉ:', fallbackError);
                
                // Sauvegarder localement en dernier recours
                try {
                    localStorage.setItem('swapp_profile_backup', JSON.stringify(data));
                    console.log('💾 Données sauvegardées localement');
                } catch (storageError) {
                    console.error('❌ Impossible de sauvegarder localement:', storageError);
                }
            });
        }

        function showFeedbackModal() {
            document.getElementById('feedback-modal').classList.add('show');
        }

        function closeFeedbackModal() {
            document.getElementById('feedback-modal').classList.remove('show');
        }

        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(function() {
                // Visual feedback
                const originalText = button.textContent;
                button.textContent = '✅ Copié !';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
                
                showNotification(`📋 ${text} copié dans le presse-papier !`, 'success');
            }).catch(function(err) {
                console.error('Erreur de copie:', err);
                showNotification('❌ Impossible de copier automatiquement', 'error');
            });
        }

        function showNotification(message, type = 'info') {
            // Créer la notification
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
            
            // Styles selon le type
            const styles = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                warning: 'bg-yellow-500 text-white',
                info: 'bg-blue-500 text-white'
            };
            
            notification.className += ` ${styles[type] || styles.info}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animation d'entrée
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Animation de sortie
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Fonctions pour les boutons d'aide
        function surpriseMe() {
            // Modal interactif pour choisir le mood et la région
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="emoji-large">🎲</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Surprends-moi !</h3>
                    <p class="text-gray-600 mb-6">Dis-moi ton mood et je te trouve la destination parfaite !</p>
                    
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌈 Ton mood ?</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="mer" class="mr-2">
                                    <span>🏖️ Mer & soleil</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="montagne" class="mr-2">
                                    <span>🏔️ Montagne & nature</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="ville" class="mr-2">
                                    <span>🏙️ Ville & culture</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="aventure" class="mr-2">
                                    <span>✨ Aventure</span>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌍 Région du monde ?</h4>
                            <div class="space-y-2">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="europe" class="mr-2">
                                    <span>🇪🇺 Europe</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-nord" class="mr-2">
                                    <span>🇺🇸 Amérique du Nord</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-sud" class="mr-2">
                                    <span>🇧🇷 Amérique du Sud</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="asie-oceanie" class="mr-2">
                                    <span>🌏 Asie / Océanie / Afrique</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="surprise" class="mr-2">
                                    <span>🎲 Surprise totale !</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="generateSurpriseDestination(this)">🎲 Surprends-moi !</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function generateSurpriseDestination(button) {
            const modal = button.closest('.modal');
            const mood = modal.querySelector('input[name="mood"]:checked')?.value;
            const region = modal.querySelector('input[name="region"]:checked')?.value;
            
            if (!mood || !region) {
                showNotification('Choisis ton mood et ta région préférée !', 'warning');
                return;
            }
            
            const destinations = {
                europe: {
                    mer: ['Barcelone (Espagne)', 'Lisbonne (Portugal)', 'Tarragone (Espagne)'],
                    montagne: ['Ski (Norvège)', 'Berlin (Allemagne)', 'Copenhague (Danemark)'],
                    ville: ['Paris (France)', 'Madrid (Espagne)', 'Bruxelles (Belgique)', 'Luxembourg', 'Berlin (Allemagne)'],
                    aventure: ['Kilkenny (Irlande)', 'Opole (Pologne)', 'Ski (Norvège)']
                },
                'amerique-nord': {
                    mer: ['Miami (États-Unis)', 'Los Angeles (États-Unis)', 'Playa del Carmen (Mexique)'],
                    montagne: ['Seattle (États-Unis)', 'Montréal (Canada)', 'Buffalo (États-Unis)'],
                    ville: ['New York (États-Unis)', 'Chicago (États-Unis)', 'Toronto (Canada)', 'Mexico City (Mexique)'],
                    aventure: ['Little Rock (États-Unis)', 'Santa Rosa (États-Unis)', 'Merida (Mexique)']
                },
                'amerique-sud': {
                    mer: ['Rio de Janeiro (Brésil)', 'Santo Domingo (République Dominicaine)'],
                    montagne: ['Belo Horizonte (Brésil)', 'Itajubá (Brésil)'],
                    ville: ['São Paulo (Brésil)', 'Monterrey (Mexique)', 'Puebla (Mexique)'],
                    aventure: ['Ribeirão Preto (Brésil)', 'San Juan de la Maguana (République Dominicaine)']
                },
                'asie-oceanie': {
                    mer: ['Sydney (Australie)'],
                    montagne: ['Chandigarh (Inde)'],
                    ville: ['Singapour', 'Mumbai (Inde)', 'Accra (Ghana)'],
                    aventure: ['Libreville (Gabon)', 'Chandigarh (Inde)']
                }
            };
            
            let selectedDestinations = [];
            
            if (region === 'surprise') {
                // Mélange toutes les destinations
                Object.values(destinations).forEach(regionDests => {
                    Object.values(regionDests).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                });
            } else {
                selectedDestinations = destinations[region]?.[mood] || [];
                
                // Si pas de destinations pour ce mood dans cette région, prendre toutes les destinations de la région
                if (selectedDestinations.length === 0) {
                    Object.values(destinations[region] || {}).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                }
            }
            
            if (selectedDestinations.length === 0) {
                showNotification('Aucune destination trouvée pour cette combinaison !', 'error');
                return;
            }
            
            const randomDestination = selectedDestinations[Math.floor(Math.random() * selectedDestinations.length)];
            document.getElementById('main-destination').value = randomDestination;
            
            closeModal(button);
            showNotification(`🎲 Destination surprise : ${randomDestination} !`, 'success');
        }

        function showAvailableCities() {
            const citiesByRegion = {
                '🇺🇸 États-Unis / Amérique du Nord': [
                    'New York', 'Boston', 'Chicago', 'Los Angeles', 'Philadelphia', 
                    'Washington DC', 'Houston', 'Dallas', 'Miami', 'Seattle', 
                    'Buffalo', 'Dayton', 'Little Rock', 'Lakeland', 'Santa Rosa', 'Iowa City'
                ],
                '🇨🇦 Canada': [
                    'Montréal', 'Toronto', 'Thorold'
                ],
                '🇲🇽 Mexique / Amérique centrale': [
                    'Mexico City', 'San Luis Potosí', 'Monterrey', 'Puebla', 
                    'Playa del Carmen', 'Merida (Yucatán)'
                ],
                '🇧🇷 Brésil': [
                    'São Paulo', 'Rio de Janeiro', 'Belo Horizonte', 
                    'Ribeirão Preto', 'Taubaté', 'Itajubá (MG)'
                ],
                '🇩🇴 République Dominicaine / Caraïbes': [
                    'Santo Domingo', 'San Juan de la Maguana'
                ],
                '🇪🇺 Europe': [
                    'Paris', 'Bruxelles', 'Luxembourg', 'Copenhague', 'Madrid', 
                    'Barcelone', 'Tarragone', 'Lisbonne', 'Opole', 'Kilkenny (Irlande)', 
                    'Berlin', 'Ski (Norvège)'
                ],
                '🌏 Asie / Océanie / Afrique': [
                    'Singapour', 'Sydney', 'Mumbai', 'Chandigarh', 
                    'Libreville (Gabon)', 'Accra (Ghana)'
                ]
            };
            
            let modalContent = '<div class="space-y-6">';
            
            Object.entries(citiesByRegion).forEach(([region, cities]) => {
                modalContent += `
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">${region}</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                `;
                
                cities.forEach(city => {
                    modalContent += `
                        <button class="city-vignette bg-blue-50 hover:bg-blue-100 border border-blue-200 hover:border-blue-400 rounded-lg px-3 py-2 text-sm text-blue-800 hover:text-blue-900 transition-all duration-200 cursor-pointer text-left" 
                                onclick="selectDestinationCity('${city.replace(/'/g, "\\'")}')">
                            📍 ${city}
                        </button>
                    `;
                });
                
                modalContent += '</div></div>';
            });
            
            modalContent += '</div>';
            
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🌍 Villes disponibles sur &SWAPP</h3>
                    <p class="text-sm text-gray-600 mb-6">💡 Cliquez sur une ville pour la sélectionner comme destination</p>
                    ${modalContent}
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function showExperienceExamples() {
            const examples = [
                '✨ "Échange Paris ↔ Lisbonne - Découverte culturelle en couple"',
                '🏖️ "Swap Lyon ↔ Barcelone - Soleil et architecture catalane"',
                '🎨 "Échange Marseille ↔ Florence - Immersion artistique"',
                '💻 "Swap Bordeaux ↔ Berlin - Télétravail et vie nocturne"',
                '🌿 "Échange Nantes ↔ Amsterdam - Vélo et canaux"',
                '🍝 "Swap Nice ↔ Rome - Gastronomie méditerranéenne"',
                '🏛️ "Échange Toulouse ↔ Prague - Architecture et histoire"',
                '🎭 "Swap Lille ↔ Londres - Théâtre et musées"'
            ];
            
            showModal('✨ Exemples d\'expériences inspirantes', examples.join('<br><br>'));
        }

        // NOUVEAUX ASSISTANTS INTERACTIFS

        function showSwapperAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">👤</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Profil Swapper</h3>
                        <p class="text-gray-600">Créons ensemble la description de votre swapper idéal !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Type de personne -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Type de personne recherchée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="young-professional" class="swapper-input">
                                    <span class="text-sm">Jeune professionnel</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="couple" class="swapper-input">
                                    <span class="text-sm">Couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="family" class="swapper-input">
                                    <span class="text-sm">Famille</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="student" class="swapper-input">
                                    <span class="text-sm">Étudiant</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="retiree" class="swapper-input">
                                    <span class="text-sm">Retraité actif</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="any" class="swapper-input">
                                    <span class="text-sm">Peu importe</span>
                                </label>
                            </div>
                        </div>

                        <!-- Qualités importantes -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Qualités importantes (max 4)</h4>
                            <div class="flex flex-wrap gap-2">
                                <span class="quality-tag" data-quality="respectful">Respectueux</span>
                                <span class="quality-tag" data-quality="calm">Calme</span>
                                <span class="quality-tag" data-quality="communicative">Communicatif</span>
                                <span class="quality-tag" data-quality="clean">Soigneux</span>
                                <span class="quality-tag" data-quality="flexible">Flexible</span>
                                <span class="quality-tag" data-quality="cultural">Amateur de culture</span>
                                <span class="quality-tag" data-quality="social">Sociable</span>
                                <span class="quality-tag" data-quality="independent">Indépendant</span>
                                <span class="quality-tag" data-quality="experienced">Voyageur expérimenté</span>
                                <span class="quality-tag" data-quality="open-minded">Ouvert d'esprit</span>
                            </div>
                        </div>

                        <!-- Centres d'intérêt -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Centres d'intérêt partagés (optionnel)</h4>
                            <input type="text" id="swapper-interests" class="input-field" placeholder="Ex: art, cuisine, sport, musique, nature...">
                        </div>

                        <!-- Critères spéciaux -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔧 Critères spéciaux (optionnel)</h4>
                            <textarea id="swapper-special" class="textarea-field" placeholder="Ex: non-fumeur, avec enfants, télétravailleur..." style="min-height: 80px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="swapper-preview" class="text-sm text-gray-700 italic">
                                Sélectionnez vos préférences pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useSwapperDescription()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupSwapperAssistantListeners(modal);
        }

        function setupSwapperAssistantListeners(modal) {
            // Quality tags selection
            modal.addEventListener('click', function(e) {
                if (e.target.classList.contains('quality-tag')) {
                    const selectedQualities = modal.querySelectorAll('.quality-tag.selected');
                    
                    if (e.target.classList.contains('selected')) {
                        e.target.classList.remove('selected');
                    } else if (selectedQualities.length < 4) {
                        e.target.classList.add('selected');
                    } else {
                        showNotification('Maximum 4 qualités sélectionnables', 'warning');
                    }
                    
                    updateSwapperPreview(modal);
                }
            });

            // Input changes
            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('swapper-input')) {
                    updateSwapperPreview(modal);
                }
            });

            modal.addEventListener('input', function(e) {
                if (e.target.id === 'swapper-interests' || e.target.id === 'swapper-special') {
                    updateSwapperPreview(modal);
                }
            });
        }

        function updateSwapperPreview(modal) {
            const type = modal.querySelector('input[name="swapper-type"]:checked')?.value;
            const qualities = Array.from(modal.querySelectorAll('.quality-tag.selected')).map(tag => tag.dataset.quality);
            const interests = modal.querySelector('#swapper-interests').value;
            const special = modal.querySelector('#swapper-special').value;

            let description = '';

            // Type de personne
            const typeTexts = {
                'young-professional': 'Je recherche un jeune professionnel',
                'couple': 'Je recherche un couple',
                'family': 'Je recherche une famille',
                'student': 'Je recherche un étudiant',
                'retiree': 'Je recherche un retraité actif',
                'any': 'Je suis ouvert à différents profils'
            };

            if (type && type !== 'any') {
                description += typeTexts[type];
            }

            // Qualités
            if (qualities.length > 0) {
                const qualityTexts = {
                    'respectful': 'respectueux',
                    'calm': 'calme',
                    'communicative': 'communicatif',
                    'clean': 'soigneux',
                    'flexible': 'flexible',
                    'cultural': 'amateur de culture',
                    'social': 'sociable',
                    'independent': 'indépendant',
                    'experienced': 'voyageur expérimenté',
                    'open-minded': 'ouvert d\'esprit'
                };

                const qualityList = qualities.map(q => qualityTexts[q]).join(', ');
                
                if (description) {
                    description += ', ';
                } else {
                    description += 'Je recherche une personne ';
                }
                
                if (qualities.length === 1) {
                    description += qualityList;
                } else if (qualities.length === 2) {
                    description += qualityList.replace(', ', ' et ');
                } else {
                    const lastComma = qualityList.lastIndexOf(', ');
                    description += qualityList.substring(0, lastComma) + ' et ' + qualityList.substring(lastComma + 2);
                }
            }

            // Centres d'intérêt
            if (interests.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Idéalement avec des centres d'intérêt comme : ${interests.trim()}`;
            }

            // Critères spéciaux
            if (special.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Critères importants : ${special.trim()}`;
            }

            if (description && !description.endsWith('.')) {
                description += '.';
            }

            modal.querySelector('#swapper-preview').textContent = description || 'Sélectionnez vos préférences pour voir l\'aperçu...';
        }

        function useSwapperDescription() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#swapper-preview').textContent;
            
            if (description && description !== 'Sélectionnez vos préférences pour voir l\'aperçu...') {
                document.getElementById('ideal-swapper-description').value = description;
                showNotification('✅ Description du swapper ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez sélectionner au moins une préférence', 'warning');
            }
        }

        function showTitleAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">✍️</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Titre d'Expérience</h3>
                        <p class="text-gray-600">Créons un titre accrocheur pour votre annonce !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Votre ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">📍 Votre ville (d'où vous venez)</h4>
                            <input type="text" id="title-origin" class="input-field title-input" placeholder="Ex: Paris, Lyon, Marseille...">
                        </div>

                        <!-- Durée du séjour -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">⏰ Durée souhaitée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="weekend" class="title-input">
                                    <span class="text-sm">Un week-end</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-week" class="title-input">
                                    <span class="text-sm">1 semaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-weeks" class="title-input">
                                    <span class="text-sm">2 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="3-weeks" class="title-input">
                                    <span class="text-sm">3 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-month" class="title-input">
                                    <span class="text-sm">1 mois</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-months" class="title-input">
                                    <span class="text-sm">2 mois</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-duration" class="input-field title-input" placeholder="Ou précisez votre durée : ex: 10 jours, 6 semaines...">
                            </div>
                        </div>

                        <!-- Type d'expérience -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Type d'expérience</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="cultural" class="title-input">
                                    <span class="text-sm">Découverte culturelle</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="work" class="title-input">
                                    <span class="text-sm">Télétravail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="relax" class="title-input">
                                    <span class="text-sm">Détente & repos</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="adventure" class="title-input">
                                    <span class="text-sm">Aventure urbaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="gastronomy" class="title-input">
                                    <span class="text-sm">Gastronomie</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="art" class="title-input">
                                    <span class="text-sm">Art & musées</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-type" class="input-field title-input" placeholder="Ou décrivez votre propre type d'expérience...">
                            </div>
                        </div>

                        <!-- Avec qui -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Avec qui voyagez-vous ?</h4>
                            <div class="grid grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="solo" class="title-input">
                                    <span class="text-sm">Solo</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="couple" class="title-input">
                                    <span class="text-sm">En couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="family" class="title-input">
                                    <span class="text-sm">En famille</span>
                                </label>
                            </div>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre titre :</h4>
                            <div id="title-preview" class="text-sm text-gray-700 italic font-medium">
                                Remplissez les champs pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useTitleDescription()">✅ Utiliser ce titre</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupTitleAssistantListeners(modal);
        }

        function setupTitleAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });

            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });
        }

        function updateTitlePreview(modal) {
            const origin = modal.querySelector('#title-origin').value.trim();
            const duration = modal.querySelector('input[name="duration"]:checked')?.value;
            const customDuration = modal.querySelector('#title-custom-duration').value.trim();
            const experienceType = modal.querySelector('input[name="experience-type"]:checked')?.value;
            const customType = modal.querySelector('#title-custom-type').value.trim();
            const travelGroup = modal.querySelector('input[name="travel-group"]:checked')?.value;

            let title = '';

            // Durée
            let durationText = '';
            if (customDuration) {
                durationText = customDuration;
            } else if (duration) {
                const durationTexts = {
                    'weekend': 'Week-end',
                    '1-week': '1 semaine',
                    '2-weeks': '2 semaines', 
                    '3-weeks': '3 semaines',
                    '1-month': '1 mois',
                    '2-months': '2 mois'
                };
                durationText = durationTexts[duration];
            }

            // Type d'expérience
            let experienceText = '';
            if (customType) {
                experienceText = customType;
            } else if (experienceType) {
                const typeTexts = {
                    'cultural': 'de découverte culturelle',
                    'work': 'de télétravail',
                    'relax': 'de détente',
                    'adventure': 'd\'aventure urbaine',
                    'gastronomy': 'd\'exploration gastronomique',
                    'art': 'd\'immersion artistique'
                };
                experienceText = typeTexts[experienceType];
            }

            // Construction du titre
            if (durationText && experienceText) {
                title = `${durationText} ${experienceText}`;
            } else if (durationText) {
                title = `${durationText} d'échange`;
            } else if (experienceText) {
                title = `Séjour ${experienceText}`;
            }

            // Ajout de l'origine si spécifiée
            if (origin && title) {
                title += ` depuis ${origin}`;
            } else if (origin && !title) {
                title = `Échange depuis ${origin}`;
            }

            // Groupe de voyage
            if (travelGroup && travelGroup !== 'solo' && title) {
                const groupTexts = {
                    'couple': 'en couple',
                    'family': 'en famille'
                };
                title += ` ${groupTexts[travelGroup]}`;
            }

            modal.querySelector('#title-preview').textContent = title || 'Remplissez les champs pour voir l\'aperçu...';
        }

        function useTitleDescription() {
            const modal = document.querySelector('.assistant-modal');
            const title = modal.querySelector('#title-preview').textContent;
            
            if (title && title !== 'Remplissez les champs pour voir l\'aperçu...') {
                document.getElementById('experience-title').value = title;
                showNotification('✅ Titre d\'expérience ajouté !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins la durée ou le type d\'expérience', 'warning');
            }
        }

        function showDescriptionAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">📝</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Description d'Expérience</h3>
                        <p class="text-gray-600">Créons une description complète et attractive !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Qui êtes-vous -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👤 Qui êtes-vous ?</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-who" class="input-field desc-input" placeholder="Ex: Marie et Thomas, couple de trentenaires parisiens">
                                <input type="text" id="desc-profession" class="input-field desc-input" placeholder="Ex: développeur et architecte">
                                <input type="text" id="desc-passions" class="input-field desc-input" placeholder="Ex: passionnés d'architecture et de gastronomie">
                            </div>
                        </div>

                        <!-- Votre projet -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Votre projet de voyage</h4>
                            <div class="space-y-3">
                                <textarea id="desc-motivation" class="textarea-field desc-input" placeholder="Ex: Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí..." style="min-height: 80px;"></textarea>
                            </div>
                        </div>

                        <!-- Votre quartier/ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🏘️ Votre quartier/ville</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-location" class="input-field desc-input" placeholder="Ex: 11ème arrondissement, quartier branché">
                                <textarea id="desc-neighborhood" class="textarea-field desc-input" placeholder="Ex: avec de nombreux bars et restaurants, proche du métro..." style="min-height: 60px;"></textarea>
                            </div>
                        </div>

                        <!-- Ce que vous offrez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎁 Ce que vous offrez</h4>
                            <textarea id="desc-offer" class="textarea-field desc-input" placeholder="Ex: Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Ce que vous recherchez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔍 Ce que vous recherchez</h4>
                            <textarea id="desc-looking" class="textarea-field desc-input" placeholder="Ex: Nous recherchons un couple ou une personne seule, flexible sur les dates..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="description-preview" class="text-sm text-gray-700" style="max-height: 200px; overflow-y: auto;">
                                Remplissez les sections pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useDescriptionText()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupDescriptionAssistantListeners(modal);
        }

        function setupDescriptionAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('desc-input')) {
                    updateDescriptionPreview(modal);
                }
            });
        }

        function updateDescriptionPreview(modal) {
            const who = modal.querySelector('#desc-who').value.trim();
            const profession = modal.querySelector('#desc-profession').value.trim();
            const passions = modal.querySelector('#desc-passions').value.trim();
            const motivation = modal.querySelector('#desc-motivation').value.trim();
            const location = modal.querySelector('#desc-location').value.trim();
            const neighborhood = modal.querySelector('#desc-neighborhood').value.trim();
            const offer = modal.querySelector('#desc-offer').value.trim();
            const looking = modal.querySelector('#desc-looking').value.trim();

            let description = '';

            // Qui êtes-vous
            if (who || profession || passions) {
                description += 'Salut ! ';
                
                if (who) {
                    description += `Nous sommes ${who}`;
                    if (profession) description += `, ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (profession) {
                    description += `Je suis ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (passions) {
                    description += `Nous sommes ${passions}`;
                }
                
                description += '. ';
            }

            // Motivation
            if (motivation) {
                description += `${motivation} `;
                if (!motivation.endsWith('.')) description += '. ';
            }

            // Quartier/ville
            if (location || neighborhood) {
                if (location) {
                    description += `Notre logement se trouve ${location}`;
                    if (neighborhood) description += `, ${neighborhood}`;
                } else if (neighborhood) {
                    description += `Notre quartier : ${neighborhood}`;
                }
                description += '. ';
            }

            // Ce que vous offrez
            if (offer) {
                description += `${offer} `;
                if (!offer.endsWith('.')) description += '. ';
            }

            // Ce que vous recherchez
            if (looking) {
                description += `${looking}`;
                if (!looking.endsWith('.')) description += '.';
            }

            modal.querySelector('#description-preview').textContent = description || 'Remplissez les sections pour voir l\'aperçu...';
        }

        function useDescriptionText() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#description-preview').textContent;
            
            if (description && description !== 'Remplissez les sections pour voir l\'aperçu...') {
                document.getElementById('experience-description').value = description;
                showNotification('✅ Description d\'expérience ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins une section', 'warning');
            }
        }

        function showAnnouncementExamples() {
            const examples = [
                '<strong>🏖️ Exemple 1 - Échange Paris ↔ Barcelone</strong><br><br>' +
                '"Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens passionnés d\'architecture et de gastronomie. Nous rêvons de découvrir l\'effervescence barcelonaise, ses marchés colorés et l\'œuvre de Gaudí.<br><br>' +
                'Notre appartement se trouve dans le 11ème arrondissement, quartier branché avec de nombreux bars et restaurants. Nous adorons partager nos bonnes adresses !<br><br>' +
                'Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange d\'une semaine en avril ou mai 2024."',
                '',
                '<strong>💻 Exemple 2 - Échange Lyon ↔ Lisbonne</strong><br><br>' +
                '"Hello ! Je suis Alex, développeur en télétravail de 28 ans. Après 2 ans de remote, j\'ai envie de changer d\'air tout en gardant ma routine de travail. Lisbonne m\'attire pour son climat, ses couleurs et sa scène tech dynamique.<br><br>' +
                'Mon studio lyonnais est parfait pour le télétravail : fibre, bureau ergonomique, quartier calme près du Rhône. Je peux partager tous mes spots favoris pour le sport et les sorties !<br><br>' +
                'Je cherche quelqu\'un dans le même état d\'esprit, qui télétravaille et veut découvrir Lyon. Flexible sur la durée (2 semaines à 2 mois)."',
                '',
                '<strong>🎨 Exemple 3 - Échange Marseille ↔ Florence</strong><br><br>' +
                '"Ciao ! Nous sommes une famille de 4 (parents + 2 ados) passionnée d\'art et d\'histoire. Florence est un rêve pour nous : les Offices, le Ponte Vecchio, l\'artisanat local...<br><br>' +
                'Notre maison marseillaise offre une vue mer, proche des calanques et du centre-ville. Les enfants connaissent tous les bons plans jeunes de la ville !<br><br>' +
                'Nous recherchons une famille ou un couple, pour 10-15 jours cet été. Nous sommes très soigneux et respectueux."'
            ];
            
            showModal('📝 Exemples d\'annonces inspirantes', examples.join('<br><br>'));
        }

        function showModal(title, content) {
            // Créer le modal
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">${title}</h3>
                    <div class="text-sm text-gray-700 leading-relaxed">${content}</div>
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function editProfile() {
            // Fermer le modal de succès
            document.getElementById('success-modal').classList.remove('show');
            
            // Retourner à l'étape 1
            currentStep = 1;
            showStep(currentStep);
            updateProgress();
            
            showNotification('✏️ Vous pouvez maintenant modifier votre profil', 'info');
        }

        function testZapier() {
            console.log('🧪 DÉBUT DU TEST ZAPIER COMPLET');
            showNotification('🧪 Lancement du test Zapier avec TOUS les champs (nouveaux inclus)...', 'info');
            
            // Données de test COMPLÈTES avec TOUS les champs, y compris les nouveaux
            const testData = {
                // === MÉTADONNÉES ===
                timestamp: new Date().toISOString(),
                createdAt: new Date().toISOString(),
                profileComplete: true,
                source: "web_form_test_complet",
                formVersion: "v2.2",
                profileScore: 98,
                
                // === ÉTAPE 1 - APPARTEMENT ===
                // Localisation
                country: "FR",
                region: "Île-de-France", 
                city: "Paris",
                postalCode: "75011",
                locationFull: "Paris, 75011, Île-de-France, France",
                
                // Caractéristiques logement
                bedrooms: "2",
                sleepingSpots: "4", 
                surface: "65",
                housingType: "apartment",
                housingDescription: "Appartement lumineux avec balcon, quartier République, proche métro",
                
                // Équipements (booléens individuels + liste)
                equipment: ["wifi", "workspace", "kitchen", "washing-machine", "balcony", "pets-accepted"],
                hasWifi: true,
                hasWorkspace: true,
                hasKitchen: true,
                hasWashingMachine: true,
                hasBalcony: true,
                hasParking: false,
                petsAccepted: true,
                otherEquipment: "Climatisation, lave-vaisselle, piano",
                equipmentCount: 6,
                
                // Obligations pour le swapper (NOUVEAUX CHAMPS - sans nettoyage)
                obligations: ["pet-care", "plant-care"],
                obligationPetCare: true,
                obligationPlantCare: true,
                obligationMailCollection: false,
                otherObligations: "Nourrir le chat 2x/jour (matin et soir), arroser les orchidées le dimanche uniquement",
                obligationCount: 2,
                
                // === ÉTAPE 2 - STYLE D'ÉCHANGE ===
                // Style d'échange
                exchangeStyle: "both",
                delayedDate1Start: "2024-07-15",
                delayedDate1End: "2024-07-30",
                delayedDate2Start: "2024-09-01", 
                delayedDate2End: "2024-09-15",
                delayedDate3Start: "2024-12-20",
                delayedDate3End: "2024-12-31",
                delayedDateRangeCount: 3,
                
                // Voyage
                travelWith: "couple",
                colocataireCount: null,
                otherTravelDetails: null,
                
                // Animaux
                hasPet: "yes",
                petType: "dog",
                petDescription: "Golden Retriever de 3 ans, très calme et sociable",
                travelWithPet: "no",
                
                // Profil swapper idéal (NOUVEAUX CHAMPS ASSISTANTS)
                idealSwapperDescription: "Je recherche un couple respectueux, calme, communicatif et soigneux. Idéalement avec des centres d'intérêt comme : art, cuisine, voyages, architecture. Critères importants : non-fumeur, soigneux, expérience en échange de logements.",
                agePreferences: ["26-35", "36-50"],
                agePreference18_25: false,
                agePreference26_35: true,
                agePreference36_50: true,
                agePreference50Plus: false,
                flexibilityPreferences: ["dates-flexible", "duration-flexible", "destination-flexible"],
                flexibilityDates: true,
                flexibilityDuration: true,
                flexibilityDestination: true,
                flexibilityExchangeType: false,
                
                // === ÉTAPE 3 - EXPÉRIENCE ===
                // Destination
                mainDestination: "Barcelone (Espagne)",
                destinationSummary: "Barcelone + alternatives Sud Espagne/Portugal + type soleil",
                
                // Options flexibles (NOUVEAUX CHAMPS)
                flexibleOptions: {
                    region: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                    cities: ["Madrid", "Séville", "Porto", "Lisbonne", "Valence"],
                    destinationType: "sunny"
                },
                flexibleRegion: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                flexibleCity1: "Madrid",
                flexibleCity2: "Séville", 
                flexibleCity3: "Porto",
                flexibleCity4: "Lisbonne",
                flexibleCity5: "Valence",
                flexibleDestinationType: "sunny",
                hasFlexibleOptions: true,
                flexibleOptionsCount: 3,
                
                // Dates de voyage
                dateRanges: [
                    { start: "2024-06-15", end: "2024-06-29" },
                    { start: "2024-07-20", end: "2024-08-03" },
                    { start: "2024-09-10", end: "2024-09-24" }
                ],
                travelDate1Start: "2024-06-15",
                travelDate1End: "2024-06-29",
                travelDate2Start: "2024-07-20",
                travelDate2End: "2024-08-03",
                travelDate3Start: "2024-09-10",
                travelDate3End: "2024-09-24",
                flexibleDuration: "2weeks",
                flexiblePeriod: "été 2024 ou début automne",
                dateRangeCount: 3,
                
                // Expérience (NOUVEAUX CHAMPS ASSISTANTS)
                experienceTitle: "2 semaines de découverte culturelle depuis Paris - Échange Paris ↔ Barcelone en couple",
                experienceDescription: "Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens, développeur et architecte, passionnés d'architecture et de gastronomie. Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí. Notre appartement se trouve 11ème arrondissement, quartier branché avec de nombreux bars et restaurants, proche du métro République. Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground. Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024.",
                experienceType: "cultural",
                generatedWithAssistant: true,
                
                // === ÉTAPE 4 - PROFIL PERSONNEL ===
                // Profil personnel
                firstName: "Marie",
                lastName: "Dupont",
                fullName: "Marie Dupont",
                email: "marie.dupont.test@example.com",
                phone: "+33 6 12 34 56 78",
                age: "29",
                vieCompany: "Airbus",
                
                // Motivations (NOUVEAUX CHAMPS)
                reasons: ["change-air", "culture"],
                reasonChangeAir: true,
                reasonCulture: true,
                reasonBreak: false,
                reasonFamily: false,
                reasonClimate: false,
                otherReason: "Améliorer notre espagnol et découvrir l'architecture catalane en immersion",
                motivationCount: 2,
                
                // Style et infos
                stayStyle: "immersive",
                smoker: "no",
                remoteWork: "yes",
                
                // === PHOTOS (seront demandées plus tard) ===
                hasApartmentPhotos: false,
                apartmentPhotosCount: 0,
                hasProfilePhoto: false,
                photosRequestedLater: true,
                
                // === NOUVEAUX CHAMPS ASSISTANTS ===
                // Assistant Swapper utilisé
                swapperAssistantUsed: true,
                swapperType: "couple",
                swapperQualities: ["respectful", "calm", "communicative", "clean"],
                swapperInterests: "art, cuisine, voyages, architecture",
                swapperSpecialCriteria: "non-fumeur, soigneux, expérience en échange de logements",
                
                // Assistant Titre utilisé
                titleAssistantUsed: true,
                titleOrigin: "Paris",
                titleDuration: "2-weeks",
                titleExperienceType: "cultural",
                titleTravelGroup: "couple",
                
                // Assistant Description utilisé
                descriptionAssistantUsed: true,
                descriptionWho: "Marie et Thomas, couple de trentenaires parisiens",
                descriptionProfession: "développeur et architecte",
                descriptionPassions: "passionnés d'architecture et de gastronomie",
                descriptionMotivation: "Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí",
                descriptionLocation: "11ème arrondissement, quartier branché",
                descriptionNeighborhood: "avec de nombreux bars et restaurants, proche du métro République",
                descriptionOffer: "Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground",
                descriptionLooking: "Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024",
                
                // === STATISTIQUES ET QUALITÉ ===
                formCompletionTime: "12 minutes",
                assistantsUsedCount: 3,
                fieldsCompletedCount: 45,
                optionalFieldsCompletedCount: 12,
                qualityScore: 98,
                readinessScore: 95,
                
                // === CHAMPS TECHNIQUES ===
                userAgent: navigator.userAgent,
                screenResolution: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                
                // === VALIDATION ===
                allRequiredFieldsCompleted: true,
                validationErrors: [],
                validationWarnings: ["Photos seront demandées dans un second temps"],
                
                // === POUR ZAPIER/NOTION ===
                notionPageTitle: "Marie Dupont - Paris ↔ Barcelone - Couple Culture",
                notionTags: ["Paris", "Barcelone", "Couple", "Culture", "Télétravail", "Été 2024"],
                zapierProcessed: false,
                zapierTimestamp: null
            };
            
            console.log('📦 DONNÉES DE TEST ULTRA-COMPLÈTES générées:', testData);
            console.log('📊 Nombre total de champs:', Object.keys(testData).length);
            console.log('🆕 Nouveaux champs inclus: obligations sans nettoyage, assistants IA, options flexibles, métadonnées');
            
            // Envoyer à Zapier
            sendToZapier(testData);
        }

        function selectDestinationCity(cityName) {
            // Remplir le champ destination principale
            document.getElementById('main-destination').value = cityName;
            
            // Animation de confirmation
            const destinationInput = document.getElementById('main-destination');
            destinationInput.style.borderColor = '#10b981';
            destinationInput.style.backgroundColor = '#f0fdf4';
            
            setTimeout(() => {
                destinationInput.style.borderColor = '';
                destinationInput.style.backgroundColor = '';
            }, 2000);
            
            // Fermer le modal
            const modal = document.querySelector('.modal.show');
            if (modal) {
                closeModal(modal.querySelector('button'));
            }
            

        }

        function closeModal(button) {
            const modal = button.closest('.modal');
            modal.classList.remove('show');
            setTimeout(() => {
                if (modal.parentNode) {
                    modal.parentNode.removeChild(modal);
                }
            }, 300);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ba10e946173b1',t:'MTc2MTY2NzA0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer mon profil &SWAPP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #f8fafc 100%);
            min-height: 100%;
        }
        
        html, body {
            height: 100%;
        }
        
        :root {
            --green-dark: #2E5941;
            --green-light: #A5C1AA;
            --yellow: #FFCC00;
            --yellow-hover: #e6b800;
        }
        
        .form-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .step-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(46, 89, 65, 0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .step-header {
            background: linear-gradient(135deg, var(--green-dark) 0%, #3a6b4f 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .step-content {
            padding: 2rem;
        }
        
        .selection-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .selection-card:hover {
            border-color: #d1d5db;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .selection-card.selected {
            border-color: var(--green-dark);
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
            box-shadow: 0 8px 25px rgba(46, 89, 65, 0.12);
            transform: translateY(-2px);
        }
        
        .selection-card.selected::after {
            content: '✓';
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--green-dark);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .input-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .textarea-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
            min-height: 120px;
            resize: vertical;
        }
        
        .textarea-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .btn-primary {
            background: var(--yellow);
            color: var(--green-dark);
            border: none;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.3);
            font-size: 16px;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: var(--yellow-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: white;
            color: var(--green-dark);
            border: 2px solid var(--green-light);
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-secondary:hover {
            border-color: var(--green-dark);
            background: #f0f9f2;
            transform: translateY(-1px);
        }
        
        .btn-skip {
            background: #f8fafc;
            color: #64748b;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-skip:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        
        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--yellow) 0%, #ffd700 100%);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e5e7eb;
            margin: 0 6px;
            transition: all 0.3s ease;
        }
        
        .step-dot.active {
            background: var(--yellow);
            transform: scale(1.2);
        }
        
        .step-dot.completed {
            background: var(--green-dark);
        }
        
        .required::after {
            content: ' *';
            color: #ef4444;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }
        
        .modal.show .modal-content {
            transform: scale(1);
        }
        
        .emoji-large {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .date-range {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option {
            background: #f0f9ff;
            border: 2px solid #bae6fd;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option.selected {
            border-color: var(--green-dark);
            background: #f0fdf4;
        }
        
        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .priority-1 {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .priority-2 {
            background: #fef3c7;
            color: #d97706;
        }
        
        .priority-3 {
            background: #f0f9ff;
            color: #2563eb;
        }

        .copy-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 0.5rem;
        }
        
        .copy-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }
        
        .copy-button.copied {
            background: #dcfce7;
            border-color: #16a34a;
            color: #16a34a;
        }

        .city-vignette {
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .city-vignette:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        
        .city-vignette:active {
            transform: translateY(0);
        }

        .assistant-modal .modal-content {
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            text-align: left;
        }

        .assistant-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .assistant-preview {
            background: #f0fdf4;
            border: 2px solid #bbf7d0;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 100px;
        }

        .quality-tag {
            display: inline-block;
            background: #e0f2fe;
            border: 1px solid #0891b2;
            border-radius: 20px;
            padding: 0.25rem 0.75rem;
            margin: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quality-tag.selected {
            background: var(--green-dark);
            color: white;
            border-color: var(--green-dark);
        }

        .quality-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .city-suggestion {
            padding: 0.75rem;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s ease;
        }

        .city-suggestion:hover {
            background-color: #f8fafc;
        }

        .city-suggestion:last-child {
            border-bottom: none;
        }

        .city-suggestion.highlighted {
            background-color: #f0f9ff;
            border-left: 3px solid var(--green-dark);
        }

        .city-suggestion-name {
            font-weight: 600;
            color: var(--green-dark);
        }

        .city-suggestion-details {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .form-container {
                padding: 1rem;
            }
            
            .step-card {
                border-radius: 16px;
            }
            
            .step-content {
                padding: 1.5rem;
            }

            .assistant-modal .modal-content {
                max-width: 95%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="min-h-full">
        <!-- Header -->
        <div class="bg-white border-b border-gray-100 sticky top-0 z-40">
            <div class="form-container py-4 px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="text-2xl font-bold text-green-800">&SWAPP</div>
                        <div class="ml-4 text-gray-600">
                            <span class="text-sm">✨ Création de profil</span>
                        </div>
                    </div>
                    <div class="text-sm text-gray-500">
                        Étape <span id="current-step">1</span> sur 4
                    </div>
                </div>
            </div>
        </div>

        <div class="form-container py-8 px-4">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                </div>
                <div class="step-indicator mt-4">
                    <div class="step-dot active" data-step="1"></div>
                    <div class="step-dot" data-step="2"></div>
                    <div class="step-dot" data-step="3"></div>
                    <div class="step-dot" data-step="4"></div>
                </div>
            </div>

            <!-- Étape 1: Info sur mon appartement -->
            <div class="step-card" id="step-1">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 1</div>
                    <div class="emoji-large">🏡</div>
                    <h2 class="text-2xl font-bold mb-2">Info sur mon appartement</h2>
                    <p class="text-green-100">Présentez votre logement aux futurs swappers</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <!-- Localisation -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📍 Localisation</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="country" class="block text-sm font-medium text-gray-700 mb-2 required">Pays</label>
                                    <select id="country" class="input-field" required>
                                        <option value="">Sélectionner un pays</option>
                                        <option value="FR">France</option>
                                        <option value="ES">Espagne</option>
                                        <option value="IT">Italie</option>
                                        <option value="DE">Allemagne</option>
                                        <option value="UK">Royaume-Uni</option>
                                        <option value="US">États-Unis</option>
                                        <option value="CA">Canada</option>
                                        <option value="PT">Portugal</option>
                                        <option value="BE">Belgique</option>
                                        <option value="CH">Suisse</option>
                                        <option value="NL">Pays-Bas</option>
                                        <option value="other">Autre</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="region" class="block text-sm font-medium text-gray-700 mb-2 required">Région / État / Département</label>
                                    <input type="text" id="region" class="input-field" placeholder="Ex: Île-de-France, Californie, Toscane..." required>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="city" class="block text-sm font-medium text-gray-700 mb-2 required">Ville</label>
                                        <div class="relative">
                                            <input type="text" id="city" class="input-field" placeholder="Ex: Paris, Lyon, Marseille..." required autocomplete="off">
                                            <div id="city-suggestions" class="absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg hidden max-h-60 overflow-y-auto"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="postal-code" class="block text-sm font-medium text-gray-700 mb-2 required">Code postal</label>
                                        <input type="text" id="postal-code" class="input-field" placeholder="Ex: 75001" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Caractéristiques -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🏘️ Caractéristiques</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de chambres</label>
                                    <select id="bedrooms" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="0">Studio</option>
                                        <option value="1">1 chambre</option>
                                        <option value="2">2 chambres</option>
                                        <option value="3">3 chambres</option>
                                        <option value="4">4 chambres</option>
                                        <option value="5+">5+ chambres</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de couchages</label>
                                    <select id="sleeping-spots" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="1">1 personne</option>
                                        <option value="2">2 personnes</option>
                                        <option value="4">4 personnes</option>
                                        <option value="6">6 personnes</option>
                                        <option value="8+">8+ personnes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Superficie (m²)</label>
                                    <input type="number" id="surface" class="input-field" placeholder="Ex: 65">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Type de logement</label>
                                    <select id="housing-type" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="apartment">Appartement</option>
                                        <option value="house">Maison</option>
                                        <option value="room">Chambre</option>
                                        <option value="shared">Colocation complète</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Équipements -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">⚙️ Équipements essentiels</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="wifi">
                                    <span class="text-sm">📶 Wifi</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="workspace">
                                    <span class="text-sm">💻 Espace de travail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="kitchen">
                                    <span class="text-sm">🍳 Cuisine équipée</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="washing-machine">
                                    <span class="text-sm">🧺 Machine à laver</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="balcony">
                                    <span class="text-sm">🌿 Balcon / terrasse</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="parking">
                                    <span class="text-sm">🚗 Parking</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="pets-accepted">
                                    <span class="text-sm">🐾 Animaux acceptés</span>
                                </label>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Autre équipement</label>
                                <input type="text" id="other-equipment" class="input-field" placeholder="Ex: piscine, jardin, climatisation...">
                            </div>
                        </div>

                        <!-- Obligations pour le swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📋 Obligations pour la personne qui vient chez moi (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez ce que vous attendez de votre swapper pendant son séjour</p>
                            
                            <div class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="pet-care">
                                        <span class="text-sm">🐾 Garder mon animal</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="plant-care">
                                        <span class="text-sm">🌱 Arroser mes plantes</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="mail-collection">
                                        <span class="text-sm">📬 Relever le courrier</span>
                                    </label>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autres obligations ou instructions</label>
                                    <textarea id="other-obligations" class="textarea-field" placeholder="Ex: nourrir le chat 2x/jour, arroser les orchidées le dimanche, ne pas utiliser la machine à laver après 22h..." style="min-height: 80px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Photos -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📷 Photos de mon logement</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">📸</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photos demandées dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter vos photos après la création du profil pour optimiser vos chances de match !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Préparez 5-8 photos de qualité de votre logement (salon, chambre, cuisine, salle de bain, extérieur si applicable)</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between">
                            <div></div>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 2: Mon style d'échange et avec qui je veux échanger -->
            <div class="step-card hidden" id="step-2">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 2</div>
                    <div class="emoji-large">🔄</div>
                    <h2 class="text-2xl font-bold mb-2">Mon style d'échange et avec qui je veux échanger</h2>
                    <p class="text-green-100">Définissez vos préférences d'échange</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Style d'échange -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🔁 Mon style d'échange</h3>
                            <div class="space-y-4">
                                <div class="selection-card" data-exchange-style="reciprocal">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🔄</div>
                                        <div>
                                            <h4 class="font-semibold">Échange réciproque</h4>
                                            <p class="text-sm text-gray-600">Chacun séjourne chez l'autre aux mêmes dates</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="delayed">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⏳</div>
                                        <div>
                                            <h4 class="font-semibold">Échange décalé (non simultané)</h4>
                                            <p class="text-sm text-gray-600">Tu accueilles pendant ton absence, et séjournes plus tard chez l'autre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="both">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⚖️</div>
                                        <div>
                                            <h4 class="font-semibold">Ouvert aux deux</h4>
                                            <p class="text-sm text-gray-600">Flexible selon les opportunités</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="delayed-dates">
                                <h4 class="font-semibold text-gray-700 mb-2">Dates où mon logement sera libre pour accueillir quelqu'un = je ne serais pas chez moi</h4>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <p class="text-sm text-blue-700 mb-3">📅 Sélectionnez les périodes où votre logement sera disponible</p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                                            <input type="date" class="input-field">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                                            <input type="date" class="input-field">
                                        </div>
                                    </div>
                                    <button type="button" class="btn-secondary mt-3" onclick="addDelayedDateRange()">➕ Ajouter une autre période</button>
                                </div>
                            </div>
                        </div>

                        <!-- Avec qui je voyage -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👥 Avec qui je voyage</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="selection-card" data-travel-with="alone">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👤</div>
                                        <div>
                                            <h4 class="font-semibold">Seul(e)</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="couple">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">💑</div>
                                        <div>
                                            <h4 class="font-semibold">En couple</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="colocation">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🏘️</div>
                                        <div>
                                            <h4 class="font-semibold">En colocation</h4>
                                            <p class="text-sm text-gray-600">Préciser le nombre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="family">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👪</div>
                                        <div>
                                            <h4 class="font-semibold">En famille</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="other">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">✨</div>
                                        <div>
                                            <h4 class="font-semibold">Autre</h4>
                                            <p class="text-sm text-gray-600">À préciser</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="colocation-details">
                                <input type="number" class="input-field" placeholder="Nombre de colocataires" min="1" max="10">
                            </div>
                            <div class="mt-4 hidden" id="other-details">
                                <textarea class="textarea-field" placeholder="Précisez avec qui vous voyagez..."></textarea>
                            </div>
                        </div>

                        <!-- Animaux -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🐾 Animaux</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">As-tu un animal ?</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="no" class="mr-2" required>
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="hidden" id="pet-details">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Type d'animal</label>
                                            <select class="input-field">
                                                <option value="">Sélectionner</option>
                                                <option value="dog">Chien</option>
                                                <option value="cat">Chat</option>
                                                <option value="other">Autre</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                            <textarea class="textarea-field" placeholder="Ex: petit chien calme, gros chat indépendant..."></textarea>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Voyages-tu avec ton animal ?</label>
                                            <div class="flex gap-4">
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="yes" class="mr-2">
                                                    <span>Oui</span>
                                                </label>
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="no" class="mr-2">
                                                    <span>Non</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Profil idéal swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">👤 Profil idéal de mon swapper (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez le type de personne avec qui vous aimeriez échanger</p>
                            
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700">Description libre</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showSwapperAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="ideal-swapper-description" class="textarea-field" placeholder="Ex: Personne calme et respectueuse, amateur de culture, jeune professionnel, famille avec enfants..."></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Tranche d'âge souhaitée</label>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="18-25">
                                            <span class="text-sm">18-25 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="26-35">
                                            <span class="text-sm">26-35 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="36-50">
                                            <span class="text-sm">36-50 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="50+">
                                            <span class="text-sm">50+ ans</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Flexibilité recherchée</label>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="dates-flexible">
                                            <span class="text-sm">🗓️ Flexible sur les dates</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="duration-flexible">
                                            <span class="text-sm">⏰ Flexible sur la durée</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="destination-flexible">
                                            <span class="text-sm">📍 Flexible sur la destination</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="exchange-type-flexible">
                                            <span class="text-sm">🔄 Flexible sur le type d'échange</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 3: Création de mon expérience -->
            <div class="step-card hidden" id="step-3">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 3</div>
                    <div class="emoji-large">✨</div>
                    <h2 class="text-2xl font-bold mb-2">Création de mon expérience</h2>
                    <p class="text-green-100">Créons votre annonce d'échange attractive</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="flex items-center mb-2">
                                <div class="text-2xl mr-3">💡</div>
                                <h4 class="font-semibold text-blue-800">Qu'est-ce qu'une expérience &SWAPP ?</h4>
                            </div>
                            <p class="text-sm text-blue-700">
                                Une expérience, c'est votre annonce d'échange ! Elle contient votre destination souhaitée, vos dates, 
                                un titre accrocheur et une description qui donne envie. Plus elle est détaillée et inspirante, 
                                plus vous aurez de chances de trouver le swapper parfait ! 🚀
                            </p>
                        </div>

                        <!-- Destination -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🌍 Où je veux partir</h3>
                            <div>
                                <label for="main-destination" class="block text-sm font-medium text-gray-700 mb-2 required">Ville principale souhaitée</label>
                                <div class="relative">
                                    <input type="text" id="main-destination" class="input-field pr-20" placeholder="Ex: Lisbonne, Tokyo, New York..." required>
                                    <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-2xl hover:scale-110 transition-transform" onclick="surpriseMe()" title="Surprends-moi !">
                                        🎲
                                    </button>
                                </div>
                                <div class="mt-2 flex flex-wrap gap-2">
                                    <button type="button" class="btn-skip text-xs" onclick="showAvailableCities()">
                                        📍 Voir les villes disponibles
                                    </button>
                                    <button type="button" class="btn-skip text-xs" onclick="showExperienceExamples()">
                                        ✨ Voir des exemples d'expériences
                                    </button>
                                </div>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Options flexibles (facultatif - sélection multiple possible)</h4>
                                <p class="text-sm text-gray-600 mb-4">💡 Ajouter des options flexibles augmente vos chances de match !</p>
                                
                                <!-- Option région -->
                                <div class="flexible-option mb-3" data-flexible-type="region">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="region">
                                        <div>
                                            <h5 class="font-semibold">🌍 Région / zone géographique</h5>
                                            <p class="text-sm text-gray-600">Ex: Sud de la France, Ouest canadien, à moins de 3h de vol de Washington</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="region-input">
                                        <input type="text" class="input-field" placeholder="Décrivez la région souhaitée...">
                                    </div>
                                </div>

                                <!-- Option villes multiples -->
                                <div class="flexible-option mb-3" data-flexible-type="cities">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="cities">
                                        <div>
                                            <h5 class="font-semibold">📍 Liste de 3 à 5 autres villes</h5>
                                            <p class="text-sm text-gray-600">Ex: Barcelone, Rome, Porto, Séville, Madrid</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="cities-input">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                            <input type="text" class="input-field" placeholder="Ville 1">
                                            <input type="text" class="input-field" placeholder="Ville 2">
                                            <input type="text" class="input-field" placeholder="Ville 3">
                                            <input type="text" class="input-field" placeholder="Ville 4 (optionnel)">
                                            <input type="text" class="input-field" placeholder="Ville 5 (optionnel)">
                                        </div>
                                    </div>
                                </div>

                                <!-- Option type de destination -->
                                <div class="flexible-option" data-flexible-type="destination-type">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="destination-type">
                                        <div>
                                            <h5 class="font-semibold">☀️ Type de destination</h5>
                                            <p class="text-sm text-gray-600">Ex: au soleil, en montagne, dans une capitale, ville culturelle</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="destination-type-input">
                                        <select class="input-field">
                                            <option value="">Choisir un type</option>
                                            <option value="sunny">Au soleil</option>
                                            <option value="mountain">En montagne</option>
                                            <option value="capital">Dans une capitale</option>
                                            <option value="cultural">Ville culturelle</option>
                                            <option value="seaside">Bord de mer</option>
                                            <option value="countryside">À la campagne</option>
                                            <option value="historic">Ville historique</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dates -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🗓️ Quand je veux partir</h3>
                            <div>
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Dates souhaitées</h4>
                                <div id="date-ranges">
                                    <div class="date-range">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                                                <input type="date" class="input-field date-start" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                                                <input type="date" class="input-field date-end" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary mt-3" onclick="addDateRange()">
                                    ➕ Ajouter une autre plage de dates
                                </button>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Période ou durée flexible (facultatif)</h4>
                                <p class="text-sm text-gray-600 mb-4">🪄 Indiquer une période souple augmente les chances de match</p>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Durée souhaitée</label>
                                        <select class="input-field" id="flexible-duration">
                                            <option value="">Sélectionner une durée</option>
                                            <option value="weekend">Un week-end</option>
                                            <option value="week">Une semaine</option>
                                            <option value="2weeks">Deux semaines</option>
                                            <option value="month">Un mois</option>
                                            <option value="2months">Deux mois</option>
                                            <option value="3months">Plus de 3 mois</option>
                                            <option value="flexible">Flexible</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Période générale</label>
                                        <input type="text" id="flexible-period" class="input-field" placeholder="Ex: été 2024, automne, décembre 2025...">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Titre et description -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">📝 Mon annonce</h3>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Titre de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showTitleAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <input type="text" id="experience-title" class="input-field" placeholder="Ex: Échange Paris ↔ Lisbonne - Découverte culturelle en couple" required>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Mentionnez votre ville, la destination et le type d'expérience</p>
                                </div>
                                
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Description de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showDescriptionAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="experience-description" class="textarea-field" placeholder="Décrivez votre projet d'échange, ce que vous recherchez, vos motivations, ce que vous pouvez offrir... Plus c'est détaillé et personnel, mieux c'est !" required style="min-height: 150px;"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Parlez de vos motivations, de votre quartier, de ce que vous aimez faire, de vos recommandations locales...</p>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-center">
                                <button type="button" class="btn-skip text-xs" onclick="showAnnouncementExamples()">
                                    📝 Voir des exemples d'annonces inspirantes
                                </button>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 4: Les infos sur moi -->
            <div class="step-card hidden" id="step-4">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 4</div>
                    <div class="emoji-large">👤</div>
                    <h2 class="text-2xl font-bold mb-2">Les infos sur moi</h2>
                    <p class="text-green-100">Finalisez votre profil personnel</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Profil utilisateur -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👤 Mes informations personnelles</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Prénom</label>
                                    <input type="text" id="first-name" class="input-field" placeholder="Marie" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nom</label>
                                    <input type="text" id="last-name" class="input-field" placeholder="Dupont" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Email</label>
                                    <input type="email" id="email" class="input-field" placeholder="marie@example.com" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Téléphone (WhatsApp)</label>
                                    <input type="tel" id="phone" class="input-field" placeholder="+33 6 12 34 56 78">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Âge</label>
                                    <input type="number" id="age" class="input-field" placeholder="28" min="18" max="99" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Société V.I.E (facultatif)</label>
                                    <input type="text" id="vie-company" class="input-field" placeholder="Ex: Airbus, Total, BNP Paribas...">
                                </div>
                            </div>
                        </div>

                        <!-- Style de séjour et motivations -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">💫 Mon style et mes motivations</h3>
                            
                            <!-- Pourquoi j'échange -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">💭 Pourquoi j'échange (2 choix max)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="change-air">
                                        <span class="text-sm">🌬️ Changer d'air / télétravailler ailleurs</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="culture">
                                        <span class="text-sm">🌍 Découvrir une autre culture</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="break">
                                        <span class="text-sm">😌 Faire une pause / un break</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="family">
                                        <span class="text-sm">👨‍👩‍👧‍👦 Rejoindre des proches</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="climate">
                                        <span class="text-sm">☀️ Profiter d'un climat différent</span>
                                    </label>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autre raison</label>
                                    <input type="text" id="other-reason" class="input-field" placeholder="Précisez votre motivation...">
                                </div>
                            </div>

                            <!-- Style de séjour -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">🌈 Mon style de séjour (1 choix max)</h4>
                                <div class="space-y-3">
                                    <div class="selection-card" data-stay-style="calm">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🧘</div>
                                            <div>
                                                <h5 class="font-semibold">Calme & reposant</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="dynamic">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🎉</div>
                                            <div>
                                                <h5 class="font-semibold">Dynamique & festif</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="immersive">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🏛️</div>
                                            <div>
                                                <h5 class="font-semibold">Immersif & local</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="work">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">💻</div>
                                            <div>
                                                <h5 class="font-semibold">Télétravail & routine</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="nature">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🌲</div>
                                            <div>
                                                <h5 class="font-semibold">Nature & extérieur</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ce qu'il faut savoir sur moi -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🔑 Ce qu'il faut savoir sur moi</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Fumeur</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Télétravail</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Photo de profil -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📸 Ma photo de profil</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">👤</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photo demandée dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter votre photo de profil après la création pour humaniser votre profil !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Une photo souriante et naturelle inspire confiance et augmente vos chances de match</p>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="completeProfile()">
                                🚀 Finaliser mon profil
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content">
            <div class="emoji-large">🎉</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Félicitations !</h3>
            <p class="text-gray-600 mb-4">✨ Votre profil &SWAPP a été créé avec succès !</p>
            <div id="photo-reminder" class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4 hidden">
                <p class="text-sm text-yellow-800">💡 <strong>Conseil :</strong> Pensez à ajouter des photos de votre logement et une photo de profil dans un second temps pour maximiser vos chances de match !</p>
            </div>
            <p class="text-sm text-gray-500 mb-6">Vous pouvez maintenant découvrir les expériences de la communauté.</p>
            <div class="flex flex-col space-y-3">
                <button class="btn-primary" onclick="window.open('https://andswapp.com', '_blank')">
                    📧 Suivre le projet
                </button>
                <button class="btn-secondary" onclick="editProfile()">
                    ✏️ Modifier mon profil
                </button>
                <button class="btn-skip mt-2" onclick="showFeedbackModal()">
                    💬 Donner mon avis sur le formulaire
                </button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="emoji-large">💬</div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">Votre avis nous intéresse !</h3>
            <p class="text-gray-600 mb-6">Aidez-nous à améliorer ce formulaire en partageant vos suggestions avec Maxime :</p>
            
            <div class="space-y-6">
                <!-- Contact WhatsApp/SMS -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-green-800 flex items-center">
                            📱 WhatsApp / SMS
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('+33647034827', this)" title="Copier le numéro">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-green-700 font-mono text-lg mb-3">+33 6 47 03 48 27</p>
                    <p class="text-sm text-green-600">💬 Contactez Maxime directement sur ce numéro</p>
                </div>

                <!-- Contact Email -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-blue-800 flex items-center">
                            📧 Email
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('maxime.barret@andswapp.com', this)" title="Copier l'email">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-blue-700 font-mono text-lg mb-3">maxime.barret@andswapp.com</p>
                    <a href="mailto:maxime.barret@andswapp.com?subject=Feedback%20formulaire%20&SWAPP&body=Salut%20Maxime%20!%0A%0AJ'ai%20testé%20le%20formulaire%20de%20création%20de%20profil%20&SWAPP%20et%20j'aimerais%20partager%20mon%20feedback%20:%0A%0A" 
                       class="btn-secondary w-full inline-block text-center">
                        📧 Envoyer un email
                    </a>
                </div>

                <!-- Suggestions d'amélioration -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">💡 Idées de feedback :</h4>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• Étapes trop longues ou trop courtes ?</li>
                        <li>• Champs manquants ou inutiles ?</li>
                        <li>• Interface confuse ou claire ?</li>
                        <li>• Suggestions d'amélioration ?</li>
                        <li>• Bugs ou problèmes techniques ?</li>
                    </ul>
                </div>
            </div>
            
            <div class="flex space-x-3 mt-6">
                <button class="btn-secondary flex-1" onclick="closeFeedbackModal()">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedTravelWith = null;
        let selectedExchangeStyle = null;
        let selectedStayStyle = null;
        let dateRangeCount = 1;
        let selectedCityIndex = -1;

        // Base de données des villes françaises principales avec régions et codes postaux
        const frenchCities = [
            { name: "Paris", region: "Île-de-France", postalCode: "75001", country: "FR" },
            { name: "Lyon", region: "Auvergne-Rhône-Alpes", postalCode: "69001", country: "FR" },
            { name: "Marseille", region: "Provence-Alpes-Côte d'Azur", postalCode: "13001", country: "FR" },
            { name: "Toulouse", region: "Occitanie", postalCode: "31000", country: "FR" },
            { name: "Nice", region: "Provence-Alpes-Côte d'Azur", postalCode: "06000", country: "FR" },
            { name: "Nantes", region: "Pays de la Loire", postalCode: "44000", country: "FR" },
            { name: "Montpellier", region: "Occitanie", postalCode: "34000", country: "FR" },
            { name: "Strasbourg", region: "Grand Est", postalCode: "67000", country: "FR" },
            { name: "Bordeaux", region: "Nouvelle-Aquitaine", postalCode: "33000", country: "FR" },
            { name: "Lille", region: "Hauts-de-France", postalCode: "59000", country: "FR" },
            { name: "Rennes", region: "Bretagne", postalCode: "35000", country: "FR" },
            { name: "Reims", region: "Grand Est", postalCode: "51100", country: "FR" },
            { name: "Saint-Étienne", region: "Auvergne-Rhône-Alpes", postalCode: "42000", country: "FR" },
            { name: "Toulon", region: "Provence-Alpes-Côte d'Azur", postalCode: "83000", country: "FR" },
            { name: "Le Havre", region: "Normandie", postalCode: "76600", country: "FR" },
            { name: "Grenoble", region: "Auvergne-Rhône-Alpes", postalCode: "38000", country: "FR" },
            { name: "Dijon", region: "Bourgogne-Franche-Comté", postalCode: "21000", country: "FR" },
            { name: "Angers", region: "Pays de la Loire", postalCode: "49000", country: "FR" },
            { name: "Nîmes", region: "Occitanie", postalCode: "30000", country: "FR" },
            { name: "Villeurbanne", region: "Auvergne-Rhône-Alpes", postalCode: "69100", country: "FR" },
            { name: "Clermont-Ferrand", region: "Auvergne-Rhône-Alpes", postalCode: "63000", country: "FR" },
            { name: "Le Mans", region: "Pays de la Loire", postalCode: "72000", country: "FR" },
            { name: "Aix-en-Provence", region: "Provence-Alpes-Côte d'Azur", postalCode: "13100", country: "FR" },
            { name: "Brest", region: "Bretagne", postalCode: "29200", country: "FR" },
            { name: "Tours", region: "Centre-Val de Loire", postalCode: "37000", country: "FR" },
            { name: "Amiens", region: "Hauts-de-France", postalCode: "80000", country: "FR" },
            { name: "Limoges", region: "Nouvelle-Aquitaine", postalCode: "87000", country: "FR" },
            { name: "Annecy", region: "Auvergne-Rhône-Alpes", postalCode: "74000", country: "FR" },
            { name: "Perpignan", region: "Occitanie", postalCode: "66000", country: "FR" },
            { name: "Besançon", region: "Bourgogne-Franche-Comté", postalCode: "25000", country: "FR" },
            { name: "Orléans", region: "Centre-Val de Loire", postalCode: "45000", country: "FR" },
            { name: "Metz", region: "Grand Est", postalCode: "57000", country: "FR" },
            { name: "Rouen", region: "Normandie", postalCode: "76000", country: "FR" },
            { name: "Mulhouse", region: "Grand Est", postalCode: "68100", country: "FR" },
            { name: "Caen", region: "Normandie", postalCode: "14000", country: "FR" },
            { name: "Nancy", region: "Grand Est", postalCode: "54000", country: "FR" }
        ];

        // Villes internationales populaires pour les échanges
        const internationalCities = [
            { name: "Barcelone", region: "Catalogne", postalCode: "08001", country: "ES" },
            { name: "Madrid", region: "Communauté de Madrid", postalCode: "28001", country: "ES" },
            { name: "Lisbonne", region: "Région de Lisbonne", postalCode: "1000", country: "PT" },
            { name: "Rome", region: "Latium", postalCode: "00100", country: "IT" },
            { name: "Milan", region: "Lombardie", postalCode: "20100", country: "IT" },
            { name: "Florence", region: "Toscane", postalCode: "50100", country: "IT" },
            { name: "Berlin", region: "Berlin", postalCode: "10115", country: "DE" },
            { name: "Munich", region: "Bavière", postalCode: "80331", country: "DE" },
            { name: "Amsterdam", region: "Hollande-Septentrionale", postalCode: "1012", country: "NL" },
            { name: "Bruxelles", region: "Région de Bruxelles-Capitale", postalCode: "1000", country: "BE" },
            { name: "Londres", region: "Angleterre", postalCode: "SW1A", country: "UK" },
            { name: "New York", region: "New York", postalCode: "10001", country: "US" },
            { name: "Los Angeles", region: "Californie", postalCode: "90210", country: "US" },
            { name: "Montréal", region: "Québec", postalCode: "H2X", country: "CA" },
            { name: "Toronto", region: "Ontario", postalCode: "M5H", country: "CA" }
        ];

        // Combine toutes les villes
        const allCities = [...frenchCities, ...internationalCities];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            setupEventListeners();
            setupCityAutocomplete();
        });

        function setupEventListeners() {
            // Selection cards
            document.addEventListener('click', function(e) {
                const card = e.target.closest('.selection-card');
                if (card) {
                    const group = card.getAttribute('data-travel-with') || 
                                 card.getAttribute('data-exchange-style') || 
                                 card.getAttribute('data-stay-style');
                    
                    if (card.getAttribute('data-travel-with')) {
                        document.querySelectorAll('[data-travel-with]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedTravelWith = card.getAttribute('data-travel-with');
                        
                        // Show/hide additional inputs
                        document.getElementById('colocation-details').classList.toggle('hidden', selectedTravelWith !== 'colocation');
                        document.getElementById('other-details').classList.toggle('hidden', selectedTravelWith !== 'other');
                    }
                    
                    if (card.getAttribute('data-exchange-style')) {
                        document.querySelectorAll('[data-exchange-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedExchangeStyle = card.getAttribute('data-exchange-style');
                        
                        // Show/hide delayed dates
                        document.getElementById('delayed-dates').classList.toggle('hidden', selectedExchangeStyle !== 'delayed' && selectedExchangeStyle !== 'both');
                    }
                    
                    if (card.getAttribute('data-stay-style')) {
                        document.querySelectorAll('[data-stay-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedStayStyle = card.getAttribute('data-stay-style');
                    }
                }
            });

            // Flexible options
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('flexible-checkbox')) {
                    const option = e.target.closest('.flexible-option');
                    const inputDiv = option.querySelector('div[id$="-input"]');
                    
                    if (e.target.checked) {
                        option.classList.add('selected');
                        inputDiv.classList.remove('hidden');
                    } else {
                        option.classList.remove('selected');
                        inputDiv.classList.add('hidden');
                    }
                }
            });

            // Pet details
            document.addEventListener('change', function(e) {
                if (e.target.name === 'has-pet') {
                    document.getElementById('pet-details').classList.toggle('hidden', e.target.value !== 'yes');
                }
            });

            // Photos seront demandées dans un second temps - pas de gestion d'upload ici

            // Reason checkboxes (max 2)
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('reason-checkbox')) {
                    const checked = document.querySelectorAll('.reason-checkbox:checked');
                    if (checked.length > 2) {
                        e.target.checked = false;
                        showNotification('Vous pouvez sélectionner maximum 2 raisons', 'error');
                    }
                }
            });
        }

        function setupCityAutocomplete() {
            const cityInput = document.getElementById('city');
            const suggestionsDiv = document.getElementById('city-suggestions');
            const regionInput = document.getElementById('region');
            const postalCodeInput = document.getElementById('postal-code');
            const countrySelect = document.getElementById('country');

            cityInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();
                selectedCityIndex = -1;

                if (query.length < 2) {
                    hideSuggestions();
                    return;
                }

                const matches = allCities.filter(city => 
                    city.name.toLowerCase().includes(query) ||
                    city.region.toLowerCase().includes(query)
                ).slice(0, 8); // Limite à 8 résultats

                if (matches.length > 0) {
                    showSuggestions(matches);
                } else {
                    hideSuggestions();
                }
            });

            cityInput.addEventListener('keydown', function(e) {
                const suggestions = suggestionsDiv.querySelectorAll('.city-suggestion');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    selectedCityIndex = Math.min(selectedCityIndex + 1, suggestions.length - 1);
                    updateHighlight(suggestions);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    selectedCityIndex = Math.max(selectedCityIndex - 1, -1);
                    updateHighlight(suggestions);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (selectedCityIndex >= 0 && suggestions[selectedCityIndex]) {
                        selectCity(suggestions[selectedCityIndex].dataset.cityIndex);
                    }
                } else if (e.key === 'Escape') {
                    hideSuggestions();
                }
            });

            // Fermer les suggestions en cliquant ailleurs
            document.addEventListener('click', function(e) {
                if (!cityInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                    hideSuggestions();
                }
            });

            function showSuggestions(cities) {
                suggestionsDiv.innerHTML = '';
                
                cities.forEach((city, index) => {
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.className = 'city-suggestion';
                    suggestionDiv.dataset.cityIndex = allCities.indexOf(city);
                    
                    const countryFlag = getCountryFlag(city.country);
                    
                    suggestionDiv.innerHTML = `
                        <div class="city-suggestion-name">${countryFlag} ${city.name}</div>
                        <div class="city-suggestion-details">${city.region} • ${city.postalCode}</div>
                    `;
                    
                    suggestionDiv.addEventListener('click', function() {
                        selectCity(this.dataset.cityIndex);
                    });
                    
                    suggestionsDiv.appendChild(suggestionDiv);
                });
                
                suggestionsDiv.classList.remove('hidden');
            }

            function hideSuggestions() {
                suggestionsDiv.classList.add('hidden');
                selectedCityIndex = -1;
            }

            function updateHighlight(suggestions) {
                suggestions.forEach((suggestion, index) => {
                    suggestion.classList.toggle('highlighted', index === selectedCityIndex);
                });
            }

            function selectCity(cityIndex) {
                const city = allCities[cityIndex];
                
                // Remplir automatiquement tous les champs
                cityInput.value = city.name;
                regionInput.value = city.region;
                postalCodeInput.value = city.postalCode;
                countrySelect.value = city.country;
                
                hideSuggestions();
                
                // Animation de confirmation
                cityInput.style.borderColor = '#10b981';
                setTimeout(() => {
                    cityInput.style.borderColor = '';
                }, 1000);
            }

            function getCountryFlag(countryCode) {
                const flags = {
                    'FR': '🇫🇷',
                    'ES': '🇪🇸', 
                    'IT': '🇮🇹',
                    'DE': '🇩🇪',
                    'PT': '🇵🇹',
                    'NL': '🇳🇱',
                    'BE': '🇧🇪',
                    'UK': '🇬🇧',
                    'US': '🇺🇸',
                    'CA': '🇨🇦'
                };
                return flags[countryCode] || '🌍';
            }
        }

        function addDateRange() {
            dateRangeCount++;
            const dateRangesDiv = document.getElementById('date-ranges');
            const newRange = document.createElement('div');
            newRange.className = 'date-range';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Plage de dates ${dateRangeCount}</span>
                    <button type="button" class="text-red-500 hover:text-red-700" onclick="removeDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                        <input type="date" class="input-field date-start">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                        <input type="date" class="input-field date-end">
                    </div>
                </div>
            `;
            dateRangesDiv.appendChild(newRange);
        }

        function addDelayedDateRange() {
            const delayedDatesDiv = document.getElementById('delayed-dates');
            const existingRanges = delayedDatesDiv.querySelectorAll('.bg-blue-50').length;
            
            const newRange = document.createElement('div');
            newRange.className = 'bg-blue-50 border border-blue-200 rounded-lg p-4 mt-3';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <p class="text-sm text-blue-700 font-medium">📅 Période ${existingRanges + 1}</p>
                    <button type="button" class="text-red-500 hover:text-red-700 text-sm" onclick="removeDelayedDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                        <input type="date" class="input-field">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                        <input type="date" class="input-field">
                    </div>
                </div>
            `;
            
            // Insert before the "Ajouter" button
            const addButton = delayedDatesDiv.querySelector('button');
            addButton.parentNode.insertBefore(newRange, addButton);
        }

        function removeDelayedDateRange(button) {
            button.closest('.bg-blue-50').remove();
        }

        function removeDateRange(button) {
            button.closest('.date-range').remove();
        }

        function nextStep() {
            if (validateCurrentStep()) {
                currentStep++;
                if (currentStep > 4) currentStep = 4;
                showStep(currentStep);
                updateProgress();
            }
        }

        function prevStep() {
            currentStep--;
            if (currentStep < 1) currentStep = 1;
            showStep(currentStep);
            updateProgress();
        }

        function showStep(step) {
            // Hide all steps
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`step-${i}`).classList.add('hidden');
            }
            
            // Show current step
            document.getElementById(`step-${step}`).classList.remove('hidden');
            
            // Update step indicator
            document.getElementById('current-step').textContent = step;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const progress = (currentStep / 4) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            // Update step dots
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    dot.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    dot.classList.add('active');
                }
            });
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const country = document.getElementById('country').value;
                    const region = document.getElementById('region').value;
                    const city = document.getElementById('city').value;
                    const postalCode = document.getElementById('postal-code').value;
                    const bedrooms = document.getElementById('bedrooms').value;
                    const sleepingSpots = document.getElementById('sleeping-spots').value;
                    const housingType = document.getElementById('housing-type').value;
                    
                    if (!country || !region || !city || !postalCode || !bedrooms || !sleepingSpots || !housingType) {
                        showNotification('Veuillez remplir tous les champs obligatoires.', 'error');
                        return false;
                    }
                    break;
                    
                case 2:
                    if (!selectedExchangeStyle) {
                        showNotification('Veuillez choisir votre style d\'échange.', 'error');
                        return false;
                    }
                    
                    if (!selectedTravelWith) {
                        showNotification('Veuillez indiquer avec qui vous voyagez.', 'error');
                        return false;
                    }
                    
                    const hasPet = document.querySelector('input[name="has-pet"]:checked');
                    if (!hasPet) {
                        showNotification('Veuillez indiquer si vous avez un animal.', 'error');
                        return false;
                    }
                    break;
                    
                case 3:
                    const mainDestination = document.getElementById('main-destination').value;
                    if (!mainDestination) {
                        showNotification('Veuillez indiquer votre destination principale.', 'error');
                        return false;
                    }
                    
                    const dateStarts = document.querySelectorAll('.date-start');
                    const dateEnds = document.querySelectorAll('.date-end');
                    let hasValidDate = false;
                    
                    for (let i = 0; i < dateStarts.length; i++) {
                        if (dateStarts[i].value && dateEnds[i].value) {
                            hasValidDate = true;
                            break;
                        }
                    }
                    
                    if (!hasValidDate) {
                        showNotification('Veuillez renseigner au moins une plage de dates.', 'error');
                        return false;
                    }
                    
                    const experienceTitle = document.getElementById('experience-title').value;
                    const experienceDescription = document.getElementById('experience-description').value;
                    
                    if (!experienceTitle || !experienceDescription) {
                        showNotification('Veuillez remplir le titre et la description de votre expérience.', 'error');
                        return false;
                    }
                    break;
                    
                case 4:
                    const firstName = document.getElementById('first-name').value;
                    const lastName = document.getElementById('last-name').value;
                    const email = document.getElementById('email').value;
                    const age = document.getElementById('age').value;
                    
                    if (!firstName || !lastName || !email || !age) {
                        showNotification('Veuillez remplir tous les champs obligatoires du profil.', 'error');
                        return false;
                    }
                    break;
            }
            return true;
        }

        function completeProfile() {
            if (validateCurrentStep()) {
                // Collect all form data
                const formData = collectAllFormData();
                
                // Send to Zapier
                sendToZapier(formData);
                
                // Toujours afficher le rappel photos car elles seront demandées plus tard
                document.getElementById('photo-reminder').classList.remove('hidden');
                
                showNotification('✨ Profil créé avec succès !', 'success');
                setTimeout(() => {
                    document.getElementById('success-modal').classList.add('show');
                }, 1000);
            }
        }

        function collectAllFormData() {
            const data = {
                // Timestamp
                timestamp: new Date().toISOString(),
                
                // Étape 1 - Appartement
                country: document.getElementById('country').value,
                region: document.getElementById('region').value,
                city: document.getElementById('city').value,
                postalCode: document.getElementById('postal-code').value,
                bedrooms: document.getElementById('bedrooms').value,
                sleepingSpots: document.getElementById('sleeping-spots').value,
                surface: document.getElementById('surface').value,
                housingType: document.getElementById('housing-type').value,
                
                // Équipements
                equipment: Array.from(document.querySelectorAll('.equipment-checkbox:checked')).map(cb => cb.value),
                otherEquipment: document.getElementById('other-equipment').value,
                
                // Obligations pour le swapper
                obligations: Array.from(document.querySelectorAll('.obligation-checkbox:checked')).map(cb => cb.value),
                otherObligations: document.getElementById('other-obligations').value,
                
                // Étape 2 - Style d'échange
                exchangeStyle: selectedExchangeStyle,
                travelWith: selectedTravelWith,
                
                // Animaux
                hasPet: document.querySelector('input[name="has-pet"]:checked')?.value,
                travelWithPet: document.querySelector('input[name="travel-with-pet"]:checked')?.value,
                
                // Profil swapper idéal
                idealSwapperDescription: document.getElementById('ideal-swapper-description').value,
                agePreferences: Array.from(document.querySelectorAll('.age-preference:checked')).map(cb => cb.value),
                flexibilityPreferences: Array.from(document.querySelectorAll('.flexibility-preference:checked')).map(cb => cb.value),
                
                // Étape 3 - Expérience
                mainDestination: document.getElementById('main-destination').value,
                flexibleDuration: document.getElementById('flexible-duration').value,
                flexiblePeriod: document.getElementById('flexible-period').value,
                experienceTitle: document.getElementById('experience-title').value,
                experienceDescription: document.getElementById('experience-description').value,
                
                // Dates
                dateRanges: Array.from(document.querySelectorAll('.date-range')).map(range => ({
                    start: range.querySelector('.date-start').value,
                    end: range.querySelector('.date-end').value
                })).filter(range => range.start && range.end),
                
                // Options flexibles
                flexibleOptions: {
                    region: document.querySelector('[data-flexible-type="region"] input:checked') ? 
                           document.querySelector('[data-flexible-type="region"] #region-input input').value : null,
                    cities: document.querySelector('[data-flexible-type="cities"] input:checked') ? 
                           Array.from(document.querySelectorAll('[data-flexible-type="cities"] #cities-input input')).map(i => i.value).filter(v => v) : null,
                    destinationType: document.querySelector('[data-flexible-type="destination-type"] input:checked') ? 
                                   document.querySelector('[data-flexible-type="destination-type"] select').value : null
                },
                
                // Étape 4 - Profil personnel
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                age: document.getElementById('age').value,
                vieCompany: document.getElementById('vie-company').value,
                
                // Motivations et style
                reasons: Array.from(document.querySelectorAll('.reason-checkbox:checked')).map(cb => cb.value),
                otherReason: document.getElementById('other-reason').value,
                stayStyle: selectedStayStyle,
                
                // Infos personnelles
                smoker: document.querySelector('input[name="smoker"]:checked')?.value,
                remoteWork: document.querySelector('input[name="remote-work"]:checked')?.value,
                
                // Photos (seront demandées dans un second temps)
                hasApartmentPhotos: false,
                hasProfilePhoto: false
            };
            
            return data;
        }

        function sendToZapier(data) {
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            console.log('🚀 ENVOI À ZAPIER - Début');
            console.log('📡 URL Zapier:', zapierUrl);
            console.log('📦 Données à envoyer:', data);
            
            // Affichage visuel pour l'utilisateur
            showNotification('📡 Envoi des données à Zapier...', 'info');
            
            fetch(zapierUrl, {
                method: 'POST',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 Réponse Zapier reçue');
                console.log('📊 Status:', response.status);
                console.log('📋 Status Text:', response.statusText);
                console.log('🔗 URL finale:', response.url);
                
                if (response.ok || response.status === 200) {
                    console.log('✅ SUCCÈS - Données envoyées à Zapier avec succès !');
                    showNotification('✅ Données envoyées à Zapier avec succès !', 'success');
                    
                    // Lire la réponse pour plus de détails
                    return response.text();
                } else {
                    console.error('❌ ERREUR - Status HTTP:', response.status);
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(responseText => {
                console.log('📄 Réponse Zapier complète:', responseText);
            })
            .catch(error => {
                console.error('❌ ERREUR RÉSEAU - Détails complètes:', error);
                console.error('🔍 Type d\'erreur:', error.name);
                console.error('💬 Message d\'erreur:', error.message);
                console.error('📚 Stack trace:', error.stack);
                
                // Fallback : essayer avec une méthode alternative
                console.log('🔄 Tentative de fallback...');
                tryZapierFallback(data);
            });
        }

        function tryZapierFallback(data) {
            console.log('🔄 FALLBACK - Tentative avec méthode alternative');
            
            // Essayer avec une requête plus simple
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            fetch(zapierUrl, {
                method: 'POST',
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 FALLBACK - Réponse reçue:', response.status);
                if (response.ok || response.status === 200) {
                    console.log('✅ FALLBACK SUCCÈS !');
                    showNotification('✅ Données envoyées avec succès (méthode alternative)', 'success');
                } else {
                    throw new Error(`Fallback failed: ${response.status}`);
                }
            })
            .catch(fallbackError => {
                console.error('❌ FALLBACK ÉCHOUÉ:', fallbackError);
                
                // Sauvegarder localement en dernier recours
                try {
                    localStorage.setItem('swapp_profile_backup', JSON.stringify(data));
                    console.log('💾 Données sauvegardées localement');
                } catch (storageError) {
                    console.error('❌ Impossible de sauvegarder localement:', storageError);
                }
            });
        }

        function showFeedbackModal() {
            document.getElementById('feedback-modal').classList.add('show');
        }

        function closeFeedbackModal() {
            document.getElementById('feedback-modal').classList.remove('show');
        }

        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(function() {
                // Visual feedback
                const originalText = button.textContent;
                button.textContent = '✅ Copié !';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
                
                showNotification(`📋 ${text} copié dans le presse-papier !`, 'success');
            }).catch(function(err) {
                console.error('Erreur de copie:', err);
                showNotification('❌ Impossible de copier automatiquement', 'error');
            });
        }

        function showNotification(message, type = 'info') {
            // Créer la notification
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
            
            // Styles selon le type
            const styles = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                warning: 'bg-yellow-500 text-white',
                info: 'bg-blue-500 text-white'
            };
            
            notification.className += ` ${styles[type] || styles.info}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animation d'entrée
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Animation de sortie
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Fonctions pour les boutons d'aide
        function surpriseMe() {
            // Modal interactif pour choisir le mood et la région
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="emoji-large">🎲</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Surprends-moi !</h3>
                    <p class="text-gray-600 mb-6">Dis-moi ton mood et je te trouve la destination parfaite !</p>
                    
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌈 Ton mood ?</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="mer" class="mr-2">
                                    <span>🏖️ Mer & soleil</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="montagne" class="mr-2">
                                    <span>🏔️ Montagne & nature</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="ville" class="mr-2">
                                    <span>🏙️ Ville & culture</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="aventure" class="mr-2">
                                    <span>✨ Aventure</span>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌍 Région du monde ?</h4>
                            <div class="space-y-2">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="europe" class="mr-2">
                                    <span>🇪🇺 Europe</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-nord" class="mr-2">
                                    <span>🇺🇸 Amérique du Nord</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-sud" class="mr-2">
                                    <span>🇧🇷 Amérique du Sud</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="asie-oceanie" class="mr-2">
                                    <span>🌏 Asie / Océanie / Afrique</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="surprise" class="mr-2">
                                    <span>🎲 Surprise totale !</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="generateSurpriseDestination(this)">🎲 Surprends-moi !</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function generateSurpriseDestination(button) {
            const modal = button.closest('.modal');
            const mood = modal.querySelector('input[name="mood"]:checked')?.value;
            const region = modal.querySelector('input[name="region"]:checked')?.value;
            
            if (!mood || !region) {
                showNotification('Choisis ton mood et ta région préférée !', 'warning');
                return;
            }
            
            const destinations = {
                europe: {
                    mer: ['Barcelone (Espagne)', 'Lisbonne (Portugal)', 'Tarragone (Espagne)'],
                    montagne: ['Ski (Norvège)', 'Berlin (Allemagne)', 'Copenhague (Danemark)'],
                    ville: ['Paris (France)', 'Madrid (Espagne)', 'Bruxelles (Belgique)', 'Luxembourg', 'Berlin (Allemagne)'],
                    aventure: ['Kilkenny (Irlande)', 'Opole (Pologne)', 'Ski (Norvège)']
                },
                'amerique-nord': {
                    mer: ['Miami (États-Unis)', 'Los Angeles (États-Unis)', 'Playa del Carmen (Mexique)'],
                    montagne: ['Seattle (États-Unis)', 'Montréal (Canada)', 'Buffalo (États-Unis)'],
                    ville: ['New York (États-Unis)', 'Chicago (États-Unis)', 'Toronto (Canada)', 'Mexico City (Mexique)'],
                    aventure: ['Little Rock (États-Unis)', 'Santa Rosa (États-Unis)', 'Merida (Mexique)']
                },
                'amerique-sud': {
                    mer: ['Rio de Janeiro (Brésil)', 'Santo Domingo (République Dominicaine)'],
                    montagne: ['Belo Horizonte (Brésil)', 'Itajubá (Brésil)'],
                    ville: ['São Paulo (Brésil)', 'Monterrey (Mexique)', 'Puebla (Mexique)'],
                    aventure: ['Ribeirão Preto (Brésil)', 'San Juan de la Maguana (République Dominicaine)']
                },
                'asie-oceanie': {
                    mer: ['Sydney (Australie)'],
                    montagne: ['Chandigarh (Inde)'],
                    ville: ['Singapour', 'Mumbai (Inde)', 'Accra (Ghana)'],
                    aventure: ['Libreville (Gabon)', 'Chandigarh (Inde)']
                }
            };
            
            let selectedDestinations = [];
            
            if (region === 'surprise') {
                // Mélange toutes les destinations
                Object.values(destinations).forEach(regionDests => {
                    Object.values(regionDests).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                });
            } else {
                selectedDestinations = destinations[region]?.[mood] || [];
                
                // Si pas de destinations pour ce mood dans cette région, prendre toutes les destinations de la région
                if (selectedDestinations.length === 0) {
                    Object.values(destinations[region] || {}).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                }
            }
            
            if (selectedDestinations.length === 0) {
                showNotification('Aucune destination trouvée pour cette combinaison !', 'error');
                return;
            }
            
            const randomDestination = selectedDestinations[Math.floor(Math.random() * selectedDestinations.length)];
            document.getElementById('main-destination').value = randomDestination;
            
            closeModal(button);
            showNotification(`🎲 Destination surprise : ${randomDestination} !`, 'success');
        }

        function showAvailableCities() {
            const citiesByRegion = {
                '🇺🇸 États-Unis / Amérique du Nord': [
                    'New York', 'Boston', 'Chicago', 'Los Angeles', 'Philadelphia', 
                    'Washington DC', 'Houston', 'Dallas', 'Miami', 'Seattle', 
                    'Buffalo', 'Dayton', 'Little Rock', 'Lakeland', 'Santa Rosa', 'Iowa City'
                ],
                '🇨🇦 Canada': [
                    'Montréal', 'Toronto', 'Thorold'
                ],
                '🇲🇽 Mexique / Amérique centrale': [
                    'Mexico City', 'San Luis Potosí', 'Monterrey', 'Puebla', 
                    'Playa del Carmen', 'Merida (Yucatán)'
                ],
                '🇧🇷 Brésil': [
                    'São Paulo', 'Rio de Janeiro', 'Belo Horizonte', 
                    'Ribeirão Preto', 'Taubaté', 'Itajubá (MG)'
                ],
                '🇩🇴 République Dominicaine / Caraïbes': [
                    'Santo Domingo', 'San Juan de la Maguana'
                ],
                '🇪🇺 Europe': [
                    'Paris', 'Bruxelles', 'Luxembourg', 'Copenhague', 'Madrid', 
                    'Barcelone', 'Tarragone', 'Lisbonne', 'Opole', 'Kilkenny (Irlande)', 
                    'Berlin', 'Ski (Norvège)'
                ],
                '🌏 Asie / Océanie / Afrique': [
                    'Singapour', 'Sydney', 'Mumbai', 'Chandigarh', 
                    'Libreville (Gabon)', 'Accra (Ghana)'
                ]
            };
            
            let modalContent = '<div class="space-y-6">';
            
            Object.entries(citiesByRegion).forEach(([region, cities]) => {
                modalContent += `
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">${region}</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                `;
                
                cities.forEach(city => {
                    modalContent += `
                        <button class="city-vignette bg-blue-50 hover:bg-blue-100 border border-blue-200 hover:border-blue-400 rounded-lg px-3 py-2 text-sm text-blue-800 hover:text-blue-900 transition-all duration-200 cursor-pointer text-left" 
                                onclick="selectDestinationCity('${city.replace(/'/g, "\\'")}')">
                            📍 ${city}
                        </button>
                    `;
                });
                
                modalContent += '</div></div>';
            });
            
            modalContent += '</div>';
            
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🌍 Villes disponibles sur &SWAPP</h3>
                    <p class="text-sm text-gray-600 mb-6">💡 Cliquez sur une ville pour la sélectionner comme destination</p>
                    ${modalContent}
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function showExperienceExamples() {
            const examples = [
                '✨ "Échange Paris ↔ Lisbonne - Découverte culturelle en couple"',
                '🏖️ "Swap Lyon ↔ Barcelone - Soleil et architecture catalane"',
                '🎨 "Échange Marseille ↔ Florence - Immersion artistique"',
                '💻 "Swap Bordeaux ↔ Berlin - Télétravail et vie nocturne"',
                '🌿 "Échange Nantes ↔ Amsterdam - Vélo et canaux"',
                '🍝 "Swap Nice ↔ Rome - Gastronomie méditerranéenne"',
                '🏛️ "Échange Toulouse ↔ Prague - Architecture et histoire"',
                '🎭 "Swap Lille ↔ Londres - Théâtre et musées"'
            ];
            
            showModal('✨ Exemples d\'expériences inspirantes', examples.join('<br><br>'));
        }

        // NOUVEAUX ASSISTANTS INTERACTIFS

        function showSwapperAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">👤</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Profil Swapper</h3>
                        <p class="text-gray-600">Créons ensemble la description de votre swapper idéal !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Type de personne -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Type de personne recherchée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="young-professional" class="swapper-input">
                                    <span class="text-sm">Jeune professionnel</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="couple" class="swapper-input">
                                    <span class="text-sm">Couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="family" class="swapper-input">
                                    <span class="text-sm">Famille</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="student" class="swapper-input">
                                    <span class="text-sm">Étudiant</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="retiree" class="swapper-input">
                                    <span class="text-sm">Retraité actif</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="any" class="swapper-input">
                                    <span class="text-sm">Peu importe</span>
                                </label>
                            </div>
                        </div>

                        <!-- Qualités importantes -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Qualités importantes (max 4)</h4>
                            <div class="flex flex-wrap gap-2">
                                <span class="quality-tag" data-quality="respectful">Respectueux</span>
                                <span class="quality-tag" data-quality="calm">Calme</span>
                                <span class="quality-tag" data-quality="communicative">Communicatif</span>
                                <span class="quality-tag" data-quality="clean">Soigneux</span>
                                <span class="quality-tag" data-quality="flexible">Flexible</span>
                                <span class="quality-tag" data-quality="cultural">Amateur de culture</span>
                                <span class="quality-tag" data-quality="social">Sociable</span>
                                <span class="quality-tag" data-quality="independent">Indépendant</span>
                                <span class="quality-tag" data-quality="experienced">Voyageur expérimenté</span>
                                <span class="quality-tag" data-quality="open-minded">Ouvert d'esprit</span>
                            </div>
                        </div>

                        <!-- Centres d'intérêt -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Centres d'intérêt partagés (optionnel)</h4>
                            <input type="text" id="swapper-interests" class="input-field" placeholder="Ex: art, cuisine, sport, musique, nature...">
                        </div>

                        <!-- Critères spéciaux -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔧 Critères spéciaux (optionnel)</h4>
                            <textarea id="swapper-special" class="textarea-field" placeholder="Ex: non-fumeur, avec enfants, télétravailleur..." style="min-height: 80px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="swapper-preview" class="text-sm text-gray-700 italic">
                                Sélectionnez vos préférences pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useSwapperDescription()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupSwapperAssistantListeners(modal);
        }

        function setupSwapperAssistantListeners(modal) {
            // Quality tags selection
            modal.addEventListener('click', function(e) {
                if (e.target.classList.contains('quality-tag')) {
                    const selectedQualities = modal.querySelectorAll('.quality-tag.selected');
                    
                    if (e.target.classList.contains('selected')) {
                        e.target.classList.remove('selected');
                    } else if (selectedQualities.length < 4) {
                        e.target.classList.add('selected');
                    } else {
                        showNotification('Maximum 4 qualités sélectionnables', 'warning');
                    }
                    
                    updateSwapperPreview(modal);
                }
            });

            // Input changes
            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('swapper-input')) {
                    updateSwapperPreview(modal);
                }
            });

            modal.addEventListener('input', function(e) {
                if (e.target.id === 'swapper-interests' || e.target.id === 'swapper-special') {
                    updateSwapperPreview(modal);
                }
            });
        }

        function updateSwapperPreview(modal) {
            const type = modal.querySelector('input[name="swapper-type"]:checked')?.value;
            const qualities = Array.from(modal.querySelectorAll('.quality-tag.selected')).map(tag => tag.dataset.quality);
            const interests = modal.querySelector('#swapper-interests').value;
            const special = modal.querySelector('#swapper-special').value;

            let description = '';

            // Type de personne
            const typeTexts = {
                'young-professional': 'Je recherche un jeune professionnel',
                'couple': 'Je recherche un couple',
                'family': 'Je recherche une famille',
                'student': 'Je recherche un étudiant',
                'retiree': 'Je recherche un retraité actif',
                'any': 'Je suis ouvert à différents profils'
            };

            if (type && type !== 'any') {
                description += typeTexts[type];
            }

            // Qualités
            if (qualities.length > 0) {
                const qualityTexts = {
                    'respectful': 'respectueux',
                    'calm': 'calme',
                    'communicative': 'communicatif',
                    'clean': 'soigneux',
                    'flexible': 'flexible',
                    'cultural': 'amateur de culture',
                    'social': 'sociable',
                    'independent': 'indépendant',
                    'experienced': 'voyageur expérimenté',
                    'open-minded': 'ouvert d\'esprit'
                };

                const qualityList = qualities.map(q => qualityTexts[q]).join(', ');
                
                if (description) {
                    description += ', ';
                } else {
                    description += 'Je recherche une personne ';
                }
                
                if (qualities.length === 1) {
                    description += qualityList;
                } else if (qualities.length === 2) {
                    description += qualityList.replace(', ', ' et ');
                } else {
                    const lastComma = qualityList.lastIndexOf(', ');
                    description += qualityList.substring(0, lastComma) + ' et ' + qualityList.substring(lastComma + 2);
                }
            }

            // Centres d'intérêt
            if (interests.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Idéalement avec des centres d'intérêt comme : ${interests.trim()}`;
            }

            // Critères spéciaux
            if (special.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Critères importants : ${special.trim()}`;
            }

            if (description && !description.endsWith('.')) {
                description += '.';
            }

            modal.querySelector('#swapper-preview').textContent = description || 'Sélectionnez vos préférences pour voir l\'aperçu...';
        }

        function useSwapperDescription() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#swapper-preview').textContent;
            
            if (description && description !== 'Sélectionnez vos préférences pour voir l\'aperçu...') {
                document.getElementById('ideal-swapper-description').value = description;
                showNotification('✅ Description du swapper ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez sélectionner au moins une préférence', 'warning');
            }
        }

        function showTitleAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">✍️</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Titre d'Expérience</h3>
                        <p class="text-gray-600">Créons un titre accrocheur pour votre annonce !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Votre ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">📍 Votre ville (d'où vous venez)</h4>
                            <input type="text" id="title-origin" class="input-field title-input" placeholder="Ex: Paris, Lyon, Marseille...">
                        </div>

                        <!-- Durée du séjour -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">⏰ Durée souhaitée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="weekend" class="title-input">
                                    <span class="text-sm">Un week-end</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-week" class="title-input">
                                    <span class="text-sm">1 semaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-weeks" class="title-input">
                                    <span class="text-sm">2 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="3-weeks" class="title-input">
                                    <span class="text-sm">3 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-month" class="title-input">
                                    <span class="text-sm">1 mois</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-months" class="title-input">
                                    <span class="text-sm">2 mois</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-duration" class="input-field title-input" placeholder="Ou précisez votre durée : ex: 10 jours, 6 semaines...">
                            </div>
                        </div>

                        <!-- Type d'expérience -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Type d'expérience</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="cultural" class="title-input">
                                    <span class="text-sm">Découverte culturelle</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="work" class="title-input">
                                    <span class="text-sm">Télétravail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="relax" class="title-input">
                                    <span class="text-sm">Détente & repos</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="adventure" class="title-input">
                                    <span class="text-sm">Aventure urbaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="gastronomy" class="title-input">
                                    <span class="text-sm">Gastronomie</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="art" class="title-input">
                                    <span class="text-sm">Art & musées</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-type" class="input-field title-input" placeholder="Ou décrivez votre propre type d'expérience...">
                            </div>
                        </div>

                        <!-- Avec qui -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Avec qui voyagez-vous ?</h4>
                            <div class="grid grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="solo" class="title-input">
                                    <span class="text-sm">Solo</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="couple" class="title-input">
                                    <span class="text-sm">En couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="family" class="title-input">
                                    <span class="text-sm">En famille</span>
                                </label>
                            </div>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre titre :</h4>
                            <div id="title-preview" class="text-sm text-gray-700 italic font-medium">
                                Remplissez les champs pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useTitleDescription()">✅ Utiliser ce titre</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupTitleAssistantListeners(modal);
        }

        function setupTitleAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });

            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });
        }

        function updateTitlePreview(modal) {
            const origin = modal.querySelector('#title-origin').value.trim();
            const duration = modal.querySelector('input[name="duration"]:checked')?.value;
            const customDuration = modal.querySelector('#title-custom-duration').value.trim();
            const experienceType = modal.querySelector('input[name="experience-type"]:checked')?.value;
            const customType = modal.querySelector('#title-custom-type').value.trim();
            const travelGroup = modal.querySelector('input[name="travel-group"]:checked')?.value;

            let title = '';

            // Durée
            let durationText = '';
            if (customDuration) {
                durationText = customDuration;
            } else if (duration) {
                const durationTexts = {
                    'weekend': 'Week-end',
                    '1-week': '1 semaine',
                    '2-weeks': '2 semaines', 
                    '3-weeks': '3 semaines',
                    '1-month': '1 mois',
                    '2-months': '2 mois'
                };
                durationText = durationTexts[duration];
            }

            // Type d'expérience
            let experienceText = '';
            if (customType) {
                experienceText = customType;
            } else if (experienceType) {
                const typeTexts = {
                    'cultural': 'de découverte culturelle',
                    'work': 'de télétravail',
                    'relax': 'de détente',
                    'adventure': 'd\'aventure urbaine',
                    'gastronomy': 'd\'exploration gastronomique',
                    'art': 'd\'immersion artistique'
                };
                experienceText = typeTexts[experienceType];
            }

            // Construction du titre
            if (durationText && experienceText) {
                title = `${durationText} ${experienceText}`;
            } else if (durationText) {
                title = `${durationText} d'échange`;
            } else if (experienceText) {
                title = `Séjour ${experienceText}`;
            }

            // Ajout de l'origine si spécifiée
            if (origin && title) {
                title += ` depuis ${origin}`;
            } else if (origin && !title) {
                title = `Échange depuis ${origin}`;
            }

            // Groupe de voyage
            if (travelGroup && travelGroup !== 'solo' && title) {
                const groupTexts = {
                    'couple': 'en couple',
                    'family': 'en famille'
                };
                title += ` ${groupTexts[travelGroup]}`;
            }

            modal.querySelector('#title-preview').textContent = title || 'Remplissez les champs pour voir l\'aperçu...';
        }

        function useTitleDescription() {
            const modal = document.querySelector('.assistant-modal');
            const title = modal.querySelector('#title-preview').textContent;
            
            if (title && title !== 'Remplissez les champs pour voir l\'aperçu...') {
                document.getElementById('experience-title').value = title;
                showNotification('✅ Titre d\'expérience ajouté !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins la durée ou le type d\'expérience', 'warning');
            }
        }

        function showDescriptionAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">📝</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Description d'Expérience</h3>
                        <p class="text-gray-600">Créons une description complète et attractive !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Qui êtes-vous -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👤 Qui êtes-vous ?</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-who" class="input-field desc-input" placeholder="Ex: Marie et Thomas, couple de trentenaires parisiens">
                                <input type="text" id="desc-profession" class="input-field desc-input" placeholder="Ex: développeur et architecte">
                                <input type="text" id="desc-passions" class="input-field desc-input" placeholder="Ex: passionnés d'architecture et de gastronomie">
                            </div>
                        </div>

                        <!-- Votre projet -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Votre projet de voyage</h4>
                            <div class="space-y-3">
                                <textarea id="desc-motivation" class="textarea-field desc-input" placeholder="Ex: Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí..." style="min-height: 80px;"></textarea>
                            </div>
                        </div>

                        <!-- Votre quartier/ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🏘️ Votre quartier/ville</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-location" class="input-field desc-input" placeholder="Ex: 11ème arrondissement, quartier branché">
                                <textarea id="desc-neighborhood" class="textarea-field desc-input" placeholder="Ex: avec de nombreux bars et restaurants, proche du métro..." style="min-height: 60px;"></textarea>
                            </div>
                        </div>

                        <!-- Ce que vous offrez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎁 Ce que vous offrez</h4>
                            <textarea id="desc-offer" class="textarea-field desc-input" placeholder="Ex: Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Ce que vous recherchez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔍 Ce que vous recherchez</h4>
                            <textarea id="desc-looking" class="textarea-field desc-input" placeholder="Ex: Nous recherchons un couple ou une personne seule, flexible sur les dates..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="description-preview" class="text-sm text-gray-700" style="max-height: 200px; overflow-y: auto;">
                                Remplissez les sections pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useDescriptionText()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupDescriptionAssistantListeners(modal);
        }

        function setupDescriptionAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('desc-input')) {
                    updateDescriptionPreview(modal);
                }
            });
        }

        function updateDescriptionPreview(modal) {
            const who = modal.querySelector('#desc-who').value.trim();
            const profession = modal.querySelector('#desc-profession').value.trim();
            const passions = modal.querySelector('#desc-passions').value.trim();
            const motivation = modal.querySelector('#desc-motivation').value.trim();
            const location = modal.querySelector('#desc-location').value.trim();
            const neighborhood = modal.querySelector('#desc-neighborhood').value.trim();
            const offer = modal.querySelector('#desc-offer').value.trim();
            const looking = modal.querySelector('#desc-looking').value.trim();

            let description = '';

            // Qui êtes-vous
            if (who || profession || passions) {
                description += 'Salut ! ';
                
                if (who) {
                    description += `Nous sommes ${who}`;
                    if (profession) description += `, ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (profession) {
                    description += `Je suis ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (passions) {
                    description += `Nous sommes ${passions}`;
                }
                
                description += '. ';
            }

            // Motivation
            if (motivation) {
                description += `${motivation} `;
                if (!motivation.endsWith('.')) description += '. ';
            }

            // Quartier/ville
            if (location || neighborhood) {
                if (location) {
                    description += `Notre logement se trouve ${location}`;
                    if (neighborhood) description += `, ${neighborhood}`;
                } else if (neighborhood) {
                    description += `Notre quartier : ${neighborhood}`;
                }
                description += '. ';
            }

            // Ce que vous offrez
            if (offer) {
                description += `${offer} `;
                if (!offer.endsWith('.')) description += '. ';
            }

            // Ce que vous recherchez
            if (looking) {
                description += `${looking}`;
                if (!looking.endsWith('.')) description += '.';
            }

            modal.querySelector('#description-preview').textContent = description || 'Remplissez les sections pour voir l\'aperçu...';
        }

        function useDescriptionText() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#description-preview').textContent;
            
            if (description && description !== 'Remplissez les sections pour voir l\'aperçu...') {
                document.getElementById('experience-description').value = description;
                showNotification('✅ Description d\'expérience ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins une section', 'warning');
            }
        }

        function showAnnouncementExamples() {
            const examples = [
                '<strong>🏖️ Exemple 1 - Échange Paris ↔ Barcelone</strong><br><br>' +
                '"Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens passionnés d\'architecture et de gastronomie. Nous rêvons de découvrir l\'effervescence barcelonaise, ses marchés colorés et l\'œuvre de Gaudí.<br><br>' +
                'Notre appartement se trouve dans le 11ème arrondissement, quartier branché avec de nombreux bars et restaurants. Nous adorons partager nos bonnes adresses !<br><br>' +
                'Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange d\'une semaine en avril ou mai 2024."',
                '',
                '<strong>💻 Exemple 2 - Échange Lyon ↔ Lisbonne</strong><br><br>' +
                '"Hello ! Je suis Alex, développeur en télétravail de 28 ans. Après 2 ans de remote, j\'ai envie de changer d\'air tout en gardant ma routine de travail. Lisbonne m\'attire pour son climat, ses couleurs et sa scène tech dynamique.<br><br>' +
                'Mon studio lyonnais est parfait pour le télétravail : fibre, bureau ergonomique, quartier calme près du Rhône. Je peux partager tous mes spots favoris pour le sport et les sorties !<br><br>' +
                'Je cherche quelqu\'un dans le même état d\'esprit, qui télétravaille et veut découvrir Lyon. Flexible sur la durée (2 semaines à 2 mois)."',
                '',
                '<strong>🎨 Exemple 3 - Échange Marseille ↔ Florence</strong><br><br>' +
                '"Ciao ! Nous sommes une famille de 4 (parents + 2 ados) passionnée d\'art et d\'histoire. Florence est un rêve pour nous : les Offices, le Ponte Vecchio, l\'artisanat local...<br><br>' +
                'Notre maison marseillaise offre une vue mer, proche des calanques et du centre-ville. Les enfants connaissent tous les bons plans jeunes de la ville !<br><br>' +
                'Nous recherchons une famille ou un couple, pour 10-15 jours cet été. Nous sommes très soigneux et respectueux."'
            ];
            
            showModal('📝 Exemples d\'annonces inspirantes', examples.join('<br><br>'));
        }

        function showModal(title, content) {
            // Créer le modal
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">${title}</h3>
                    <div class="text-sm text-gray-700 leading-relaxed">${content}</div>
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function editProfile() {
            // Fermer le modal de succès
            document.getElementById('success-modal').classList.remove('show');
            
            // Retourner à l'étape 1
            currentStep = 1;
            showStep(currentStep);
            updateProgress();
            
            showNotification('✏️ Vous pouvez maintenant modifier votre profil', 'info');
        }

        function testZapier() {
            console.log('🧪 DÉBUT DU TEST ZAPIER COMPLET');
            showNotification('🧪 Lancement du test Zapier avec TOUS les champs (nouveaux inclus)...', 'info');
            
            // Données de test COMPLÈTES avec TOUS les champs, y compris les nouveaux
            const testData = {
                // === MÉTADONNÉES ===
                timestamp: new Date().toISOString(),
                createdAt: new Date().toISOString(),
                profileComplete: true,
                source: "web_form_test_complet",
                formVersion: "v2.2",
                profileScore: 98,
                
                // === ÉTAPE 1 - APPARTEMENT ===
                // Localisation
                country: "FR",
                region: "Île-de-France", 
                city: "Paris",
                postalCode: "75011",
                locationFull: "Paris, 75011, Île-de-France, France",
                
                // Caractéristiques logement
                bedrooms: "2",
                sleepingSpots: "4", 
                surface: "65",
                housingType: "apartment",
                housingDescription: "Appartement lumineux avec balcon, quartier République, proche métro",
                
                // Équipements (booléens individuels + liste)
                equipment: ["wifi", "workspace", "kitchen", "washing-machine", "balcony", "pets-accepted"],
                hasWifi: true,
                hasWorkspace: true,
                hasKitchen: true,
                hasWashingMachine: true,
                hasBalcony: true,
                hasParking: false,
                petsAccepted: true,
                otherEquipment: "Climatisation, lave-vaisselle, piano",
                equipmentCount: 6,
                
                // Obligations pour le swapper (NOUVEAUX CHAMPS - sans nettoyage)
                obligations: ["pet-care", "plant-care"],
                obligationPetCare: true,
                obligationPlantCare: true,
                obligationMailCollection: false,
                otherObligations: "Nourrir le chat 2x/jour (matin et soir), arroser les orchidées le dimanche uniquement",
                obligationCount: 2,
                
                // === ÉTAPE 2 - STYLE D'ÉCHANGE ===
                // Style d'échange
                exchangeStyle: "both",
                delayedDate1Start: "2024-07-15",
                delayedDate1End: "2024-07-30",
                delayedDate2Start: "2024-09-01", 
                delayedDate2End: "2024-09-15",
                delayedDate3Start: "2024-12-20",
                delayedDate3End: "2024-12-31",
                delayedDateRangeCount: 3,
                
                // Voyage
                travelWith: "couple",
                colocataireCount: null,
                otherTravelDetails: null,
                
                // Animaux
                hasPet: "yes",
                petType: "dog",
                petDescription: "Golden Retriever de 3 ans, très calme et sociable",
                travelWithPet: "no",
                
                // Profil swapper idéal (NOUVEAUX CHAMPS ASSISTANTS)
                idealSwapperDescription: "Je recherche un couple respectueux, calme, communicatif et soigneux. Idéalement avec des centres d'intérêt comme : art, cuisine, voyages, architecture. Critères importants : non-fumeur, soigneux, expérience en échange de logements.",
                agePreferences: ["26-35", "36-50"],
                agePreference18_25: false,
                agePreference26_35: true,
                agePreference36_50: true,
                agePreference50Plus: false,
                flexibilityPreferences: ["dates-flexible", "duration-flexible", "destination-flexible"],
                flexibilityDates: true,
                flexibilityDuration: true,
                flexibilityDestination: true,
                flexibilityExchangeType: false,
                
                // === ÉTAPE 3 - EXPÉRIENCE ===
                // Destination
                mainDestination: "Barcelone (Espagne)",
                destinationSummary: "Barcelone + alternatives Sud Espagne/Portugal + type soleil",
                
                // Options flexibles (NOUVEAUX CHAMPS)
                flexibleOptions: {
                    region: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                    cities: ["Madrid", "Séville", "Porto", "Lisbonne", "Valence"],
                    destinationType: "sunny"
                },
                flexibleRegion: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                flexibleCity1: "Madrid",
                flexibleCity2: "Séville", 
                flexibleCity3: "Porto",
                flexibleCity4: "Lisbonne",
                flexibleCity5: "Valence",
                flexibleDestinationType: "sunny",
                hasFlexibleOptions: true,
                flexibleOptionsCount: 3,
                
                // Dates de voyage
                dateRanges: [
                    { start: "2024-06-15", end: "2024-06-29" },
                    { start: "2024-07-20", end: "2024-08-03" },
                    { start: "2024-09-10", end: "2024-09-24" }
                ],
                travelDate1Start: "2024-06-15",
                travelDate1End: "2024-06-29",
                travelDate2Start: "2024-07-20",
                travelDate2End: "2024-08-03",
                travelDate3Start: "2024-09-10",
                travelDate3End: "2024-09-24",
                flexibleDuration: "2weeks",
                flexiblePeriod: "été 2024 ou début automne",
                dateRangeCount: 3,
                
                // Expérience (NOUVEAUX CHAMPS ASSISTANTS)
                experienceTitle: "2 semaines de découverte culturelle depuis Paris - Échange Paris ↔ Barcelone en couple",
                experienceDescription: "Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens, développeur et architecte, passionnés d'architecture et de gastronomie. Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí. Notre appartement se trouve 11ème arrondissement, quartier branché avec de nombreux bars et restaurants, proche du métro République. Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground. Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024.",
                experienceType: "cultural",
                generatedWithAssistant: true,
                
                // === ÉTAPE 4 - PROFIL PERSONNEL ===
                // Profil personnel
                firstName: "Marie",
                lastName: "Dupont",
                fullName: "Marie Dupont",
                email: "marie.dupont.test@example.com",
                phone: "+33 6 12 34 56 78",
                age: "29",
                vieCompany: "Airbus",
                
                // Motivations (NOUVEAUX CHAMPS)
                reasons: ["change-air", "culture"],
                reasonChangeAir: true,
                reasonCulture: true,
                reasonBreak: false,
                reasonFamily: false,
                reasonClimate: false,
                otherReason: "Améliorer notre espagnol et découvrir l'architecture catalane en immersion",
                motivationCount: 2,
                
                // Style et infos
                stayStyle: "immersive",
                smoker: "no",
                remoteWork: "yes",
                
                // === PHOTOS (seront demandées plus tard) ===
                hasApartmentPhotos: false,
                apartmentPhotosCount: 0,
                hasProfilePhoto: false,
                photosRequestedLater: true,
                
                // === NOUVEAUX CHAMPS ASSISTANTS ===
                // Assistant Swapper utilisé
                swapperAssistantUsed: true,
                swapperType: "couple",
                swapperQualities: ["respectful", "calm", "communicative", "clean"],
                swapperInterests: "art, cuisine, voyages, architecture",
                swapperSpecialCriteria: "non-fumeur, soigneux, expérience en échange de logements",
                
                // Assistant Titre utilisé
                titleAssistantUsed: true,
                titleOrigin: "Paris",
                titleDuration: "2-weeks",
                titleExperienceType: "cultural",
                titleTravelGroup: "couple",
                
                // Assistant Description utilisé
                descriptionAssistantUsed: true,
                descriptionWho: "Marie et Thomas, couple de trentenaires parisiens",
                descriptionProfession: "développeur et architecte",
                descriptionPassions: "passionnés d'architecture et de gastronomie",
                descriptionMotivation: "Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí",
                descriptionLocation: "11ème arrondissement, quartier branché",
                descriptionNeighborhood: "avec de nombreux bars et restaurants, proche du métro République",
                descriptionOffer: "Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground",
                descriptionLooking: "Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024",
                
                // === STATISTIQUES ET QUALITÉ ===
                formCompletionTime: "12 minutes",
                assistantsUsedCount: 3,
                fieldsCompletedCount: 45,
                optionalFieldsCompletedCount: 12,
                qualityScore: 98,
                readinessScore: 95,
                
                // === CHAMPS TECHNIQUES ===
                userAgent: navigator.userAgent,
                screenResolution: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                
                // === VALIDATION ===
                allRequiredFieldsCompleted: true,
                validationErrors: [],
                validationWarnings: ["Photos seront demandées dans un second temps"],
                
                // === POUR ZAPIER/NOTION ===
                notionPageTitle: "Marie Dupont - Paris ↔ Barcelone - Couple Culture",
                notionTags: ["Paris", "Barcelone", "Couple", "Culture", "Télétravail", "Été 2024"],
                zapierProcessed: false,
                zapierTimestamp: null
            };
            
            console.log('📦 DONNÉES DE TEST ULTRA-COMPLÈTES générées:', testData);
            console.log('📊 Nombre total de champs:', Object.keys(testData).length);
            console.log('🆕 Nouveaux champs inclus: obligations sans nettoyage, assistants IA, options flexibles, métadonnées');
            
            // Envoyer à Zapier
            sendToZapier(testData);<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer mon profil &SWAPP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #f8fafc 100%);
            min-height: 100%;
        }
        
        html, body {
            height: 100%;
        }
        
        :root {
            --green-dark: #2E5941;
            --green-light: #A5C1AA;
            --yellow: #FFCC00;
            --yellow-hover: #e6b800;
        }
        
        .form-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .step-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(46, 89, 65, 0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .step-header {
            background: linear-gradient(135deg, var(--green-dark) 0%, #3a6b4f 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .step-content {
            padding: 2rem;
        }
        
        .selection-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .selection-card:hover {
            border-color: #d1d5db;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .selection-card.selected {
            border-color: var(--green-dark);
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
            box-shadow: 0 8px 25px rgba(46, 89, 65, 0.12);
            transform: translateY(-2px);
        }
        
        .selection-card.selected::after {
            content: '✓';
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--green-dark);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .input-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .textarea-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
            min-height: 120px;
            resize: vertical;
        }
        
        .textarea-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .btn-primary {
            background: var(--yellow);
            color: var(--green-dark);
            border: none;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.3);
            font-size: 16px;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: var(--yellow-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: white;
            color: var(--green-dark);
            border: 2px solid var(--green-light);
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-secondary:hover {
            border-color: var(--green-dark);
            background: #f0f9f2;
            transform: translateY(-1px);
        }
        
        .btn-skip {
            background: #f8fafc;
            color: #64748b;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-skip:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        
        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--yellow) 0%, #ffd700 100%);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e5e7eb;
            margin: 0 6px;
            transition: all 0.3s ease;
        }
        
        .step-dot.active {
            background: var(--yellow);
            transform: scale(1.2);
        }
        
        .step-dot.completed {
            background: var(--green-dark);
        }
        
        .required::after {
            content: ' *';
            color: #ef4444;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }
        
        .modal.show .modal-content {
            transform: scale(1);
        }
        
        .emoji-large {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .date-range {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option {
            background: #f0f9ff;
            border: 2px solid #bae6fd;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option.selected {
            border-color: var(--green-dark);
            background: #f0fdf4;
        }
        
        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .priority-1 {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .priority-2 {
            background: #fef3c7;
            color: #d97706;
        }
        
        .priority-3 {
            background: #f0f9ff;
            color: #2563eb;
        }

        .copy-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 0.5rem;
        }
        
        .copy-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }
        
        .copy-button.copied {
            background: #dcfce7;
            border-color: #16a34a;
            color: #16a34a;
        }

        .city-vignette {
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .city-vignette:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        
        .city-vignette:active {
            transform: translateY(0);
        }

        .assistant-modal .modal-content {
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            text-align: left;
        }

        .assistant-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .assistant-preview {
            background: #f0fdf4;
            border: 2px solid #bbf7d0;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 100px;
        }

        .quality-tag {
            display: inline-block;
            background: #e0f2fe;
            border: 1px solid #0891b2;
            border-radius: 20px;
            padding: 0.25rem 0.75rem;
            margin: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quality-tag.selected {
            background: var(--green-dark);
            color: white;
            border-color: var(--green-dark);
        }

        .quality-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .city-suggestion {
            padding: 0.75rem;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s ease;
        }

        .city-suggestion:hover {
            background-color: #f8fafc;
        }

        .city-suggestion:last-child {
            border-bottom: none;
        }

        .city-suggestion.highlighted {
            background-color: #f0f9ff;
            border-left: 3px solid var(--green-dark);
        }

        .city-suggestion-name {
            font-weight: 600;
            color: var(--green-dark);
        }

        .city-suggestion-details {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .form-container {
                padding: 1rem;
            }
            
            .step-card {
                border-radius: 16px;
            }
            
            .step-content {
                padding: 1.5rem;
            }

            .assistant-modal .modal-content {
                max-width: 95%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="min-h-full">
        <!-- Header -->
        <div class="bg-white border-b border-gray-100 sticky top-0 z-40">
            <div class="form-container py-4 px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="text-2xl font-bold text-green-800">&SWAPP</div>
                        <div class="ml-4 text-gray-600">
                            <span class="text-sm">✨ Création de profil</span>
                        </div>
                    </div>
                    <div class="text-sm text-gray-500">
                        Étape <span id="current-step">1</span> sur 4
                    </div>
                </div>
            </div>
        </div>

        <div class="form-container py-8 px-4">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                </div>
                <div class="step-indicator mt-4">
                    <div class="step-dot active" data-step="1"></div>
                    <div class="step-dot" data-step="2"></div>
                    <div class="step-dot" data-step="3"></div>
                    <div class="step-dot" data-step="4"></div>
                </div>
            </div>

            <!-- Étape 1: Info sur mon appartement -->
            <div class="step-card" id="step-1">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 1</div>
                    <div class="emoji-large">🏡</div>
                    <h2 class="text-2xl font-bold mb-2">Info sur mon appartement</h2>
                    <p class="text-green-100">Présentez votre logement aux futurs swappers</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <!-- Localisation -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📍 Localisation</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="country" class="block text-sm font-medium text-gray-700 mb-2 required">Pays</label>
                                    <select id="country" class="input-field" required>
                                        <option value="">Sélectionner un pays</option>
                                        <option value="FR">France</option>
                                        <option value="ES">Espagne</option>
                                        <option value="IT">Italie</option>
                                        <option value="DE">Allemagne</option>
                                        <option value="UK">Royaume-Uni</option>
                                        <option value="US">États-Unis</option>
                                        <option value="CA">Canada</option>
                                        <option value="PT">Portugal</option>
                                        <option value="BE">Belgique</option>
                                        <option value="CH">Suisse</option>
                                        <option value="NL">Pays-Bas</option>
                                        <option value="other">Autre</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="region" class="block text-sm font-medium text-gray-700 mb-2 required">Région / État / Département</label>
                                    <input type="text" id="region" class="input-field" placeholder="Ex: Île-de-France, Californie, Toscane..." required>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="city" class="block text-sm font-medium text-gray-700 mb-2 required">Ville</label>
                                        <div class="relative">
                                            <input type="text" id="city" class="input-field" placeholder="Ex: Paris, Lyon, Marseille..." required autocomplete="off">
                                            <div id="city-suggestions" class="absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg hidden max-h-60 overflow-y-auto"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="postal-code" class="block text-sm font-medium text-gray-700 mb-2 required">Code postal</label>
                                        <input type="text" id="postal-code" class="input-field" placeholder="Ex: 75001" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Caractéristiques -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🏘️ Caractéristiques</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de chambres</label>
                                    <select id="bedrooms" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="0">Studio</option>
                                        <option value="1">1 chambre</option>
                                        <option value="2">2 chambres</option>
                                        <option value="3">3 chambres</option>
                                        <option value="4">4 chambres</option>
                                        <option value="5+">5+ chambres</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de couchages</label>
                                    <select id="sleeping-spots" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="1">1 personne</option>
                                        <option value="2">2 personnes</option>
                                        <option value="4">4 personnes</option>
                                        <option value="6">6 personnes</option>
                                        <option value="8+">8+ personnes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Superficie (m²)</label>
                                    <input type="number" id="surface" class="input-field" placeholder="Ex: 65">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Type de logement</label>
                                    <select id="housing-type" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="apartment">Appartement</option>
                                        <option value="house">Maison</option>
                                        <option value="room">Chambre</option>
                                        <option value="shared">Colocation complète</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Équipements -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">⚙️ Équipements essentiels</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="wifi">
                                    <span class="text-sm">📶 Wifi</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="workspace">
                                    <span class="text-sm">💻 Espace de travail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="kitchen">
                                    <span class="text-sm">🍳 Cuisine équipée</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="washing-machine">
                                    <span class="text-sm">🧺 Machine à laver</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="balcony">
                                    <span class="text-sm">🌿 Balcon / terrasse</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="parking">
                                    <span class="text-sm">🚗 Parking</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="pets-accepted">
                                    <span class="text-sm">🐾 Animaux acceptés</span>
                                </label>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Autre équipement</label>
                                <input type="text" id="other-equipment" class="input-field" placeholder="Ex: piscine, jardin, climatisation...">
                            </div>
                        </div>

                        <!-- Obligations pour le swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📋 Obligations pour la personne qui vient chez moi (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez ce que vous attendez de votre swapper pendant son séjour</p>
                            
                            <div class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="pet-care">
                                        <span class="text-sm">🐾 Garder mon animal</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="plant-care">
                                        <span class="text-sm">🌱 Arroser mes plantes</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="mail-collection">
                                        <span class="text-sm">📬 Relever le courrier</span>
                                    </label>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autres obligations ou instructions</label>
                                    <textarea id="other-obligations" class="textarea-field" placeholder="Ex: nourrir le chat 2x/jour, arroser les orchidées le dimanche, ne pas utiliser la machine à laver après 22h..." style="min-height: 80px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Photos -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📷 Photos de mon logement</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">📸</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photos demandées dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter vos photos après la création du profil pour optimiser vos chances de match !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Préparez 5-8 photos de qualité de votre logement (salon, chambre, cuisine, salle de bain, extérieur si applicable)</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between">
                            <div></div>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 2: Mon style d'échange et avec qui je veux échanger -->
            <div class="step-card hidden" id="step-2">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 2</div>
                    <div class="emoji-large">🔄</div>
                    <h2 class="text-2xl font-bold mb-2">Mon style d'échange et avec qui je veux échanger</h2>
                    <p class="text-green-100">Définissez vos préférences d'échange</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Style d'échange -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🔁 Mon style d'échange</h3>
                            <div class="space-y-4">
                                <div class="selection-card" data-exchange-style="reciprocal">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🔄</div>
                                        <div>
                                            <h4 class="font-semibold">Échange réciproque</h4>
                                            <p class="text-sm text-gray-600">Chacun séjourne chez l'autre aux mêmes dates</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="delayed">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⏳</div>
                                        <div>
                                            <h4 class="font-semibold">Échange décalé (non simultané)</h4>
                                            <p class="text-sm text-gray-600">Tu accueilles pendant ton absence, et séjournes plus tard chez l'autre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="both">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⚖️</div>
                                        <div>
                                            <h4 class="font-semibold">Ouvert aux deux</h4>
                                            <p class="text-sm text-gray-600">Flexible selon les opportunités</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="delayed-dates">
                                <h4 class="font-semibold text-gray-700 mb-2">Dates où mon logement sera libre pour accueillir quelqu'un = je ne serais pas chez moi</h4>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <p class="text-sm text-blue-700 mb-3">📅 Sélectionnez les périodes où votre logement sera disponible</p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                                            <input type="date" class="input-field">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                                            <input type="date" class="input-field">
                                        </div>
                                    </div>
                                    <button type="button" class="btn-secondary mt-3" onclick="addDelayedDateRange()">➕ Ajouter une autre période</button>
                                </div>
                            </div>
                        </div>

                        <!-- Avec qui je voyage -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👥 Avec qui je voyage</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="selection-card" data-travel-with="alone">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👤</div>
                                        <div>
                                            <h4 class="font-semibold">Seul(e)</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="couple">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">💑</div>
                                        <div>
                                            <h4 class="font-semibold">En couple</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="colocation">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🏘️</div>
                                        <div>
                                            <h4 class="font-semibold">En colocation</h4>
                                            <p class="text-sm text-gray-600">Préciser le nombre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="family">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👪</div>
                                        <div>
                                            <h4 class="font-semibold">En famille</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="other">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">✨</div>
                                        <div>
                                            <h4 class="font-semibold">Autre</h4>
                                            <p class="text-sm text-gray-600">À préciser</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="colocation-details">
                                <input type="number" class="input-field" placeholder="Nombre de colocataires" min="1" max="10">
                            </div>
                            <div class="mt-4 hidden" id="other-details">
                                <textarea class="textarea-field" placeholder="Précisez avec qui vous voyagez..."></textarea>
                            </div>
                        </div>

                        <!-- Animaux -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🐾 Animaux</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">As-tu un animal ?</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="no" class="mr-2" required>
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="hidden" id="pet-details">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Type d'animal</label>
                                            <select class="input-field">
                                                <option value="">Sélectionner</option>
                                                <option value="dog">Chien</option>
                                                <option value="cat">Chat</option>
                                                <option value="other">Autre</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                            <textarea class="textarea-field" placeholder="Ex: petit chien calme, gros chat indépendant..."></textarea>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Voyages-tu avec ton animal ?</label>
                                            <div class="flex gap-4">
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="yes" class="mr-2">
                                                    <span>Oui</span>
                                                </label>
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="no" class="mr-2">
                                                    <span>Non</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Profil idéal swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">👤 Profil idéal de mon swapper (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez le type de personne avec qui vous aimeriez échanger</p>
                            
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700">Description libre</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showSwapperAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="ideal-swapper-description" class="textarea-field" placeholder="Ex: Personne calme et respectueuse, amateur de culture, jeune professionnel, famille avec enfants..."></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Tranche d'âge souhaitée</label>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="18-25">
                                            <span class="text-sm">18-25 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="26-35">
                                            <span class="text-sm">26-35 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="36-50">
                                            <span class="text-sm">36-50 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="50+">
                                            <span class="text-sm">50+ ans</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Flexibilité recherchée</label>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="dates-flexible">
                                            <span class="text-sm">🗓️ Flexible sur les dates</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="duration-flexible">
                                            <span class="text-sm">⏰ Flexible sur la durée</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="destination-flexible">
                                            <span class="text-sm">📍 Flexible sur la destination</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="exchange-type-flexible">
                                            <span class="text-sm">🔄 Flexible sur le type d'échange</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 3: Création de mon expérience -->
            <div class="step-card hidden" id="step-3">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 3</div>
                    <div class="emoji-large">✨</div>
                    <h2 class="text-2xl font-bold mb-2">Création de mon expérience</h2>
                    <p class="text-green-100">Créons votre annonce d'échange attractive</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="flex items-center mb-2">
                                <div class="text-2xl mr-3">💡</div>
                                <h4 class="font-semibold text-blue-800">Qu'est-ce qu'une expérience &SWAPP ?</h4>
                            </div>
                            <p class="text-sm text-blue-700">
                                Une expérience, c'est votre annonce d'échange ! Elle contient votre destination souhaitée, vos dates, 
                                un titre accrocheur et une description qui donne envie. Plus elle est détaillée et inspirante, 
                                plus vous aurez de chances de trouver le swapper parfait ! 🚀
                            </p>
                        </div>

                        <!-- Destination -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🌍 Où je veux partir</h3>
                            <div>
                                <label for="main-destination" class="block text-sm font-medium text-gray-700 mb-2 required">Ville principale souhaitée</label>
                                <div class="relative">
                                    <input type="text" id="main-destination" class="input-field pr-20" placeholder="Ex: Lisbonne, Tokyo, New York..." required>
                                    <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-2xl hover:scale-110 transition-transform" onclick="surpriseMe()" title="Surprends-moi !">
                                        🎲
                                    </button>
                                </div>
                                <div class="mt-2 flex flex-wrap gap-2">
                                    <button type="button" class="btn-skip text-xs" onclick="showAvailableCities()">
                                        📍 Voir les villes disponibles
                                    </button>
                                    <button type="button" class="btn-skip text-xs" onclick="showExperienceExamples()">
                                        ✨ Voir des exemples d'expériences
                                    </button>
                                </div>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Options flexibles (facultatif - sélection multiple possible)</h4>
                                <p class="text-sm text-gray-600 mb-4">💡 Ajouter des options flexibles augmente vos chances de match !</p>
                                
                                <!-- Option région -->
                                <div class="flexible-option mb-3" data-flexible-type="region">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="region">
                                        <div>
                                            <h5 class="font-semibold">🌍 Région / zone géographique</h5>
                                            <p class="text-sm text-gray-600">Ex: Sud de la France, Ouest canadien, à moins de 3h de vol de Washington</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="region-input">
                                        <input type="text" class="input-field" placeholder="Décrivez la région souhaitée...">
                                    </div>
                                </div>

                                <!-- Option villes multiples -->
                                <div class="flexible-option mb-3" data-flexible-type="cities">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="cities">
                                        <div>
                                            <h5 class="font-semibold">📍 Liste de 3 à 5 autres villes</h5>
                                            <p class="text-sm text-gray-600">Ex: Barcelone, Rome, Porto, Séville, Madrid</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="cities-input">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                            <input type="text" class="input-field" placeholder="Ville 1">
                                            <input type="text" class="input-field" placeholder="Ville 2">
                                            <input type="text" class="input-field" placeholder="Ville 3">
                                            <input type="text" class="input-field" placeholder="Ville 4 (optionnel)">
                                            <input type="text" class="input-field" placeholder="Ville 5 (optionnel)">
                                        </div>
                                    </div>
                                </div>

                                <!-- Option type de destination -->
                                <div class="flexible-option" data-flexible-type="destination-type">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="destination-type">
                                        <div>
                                            <h5 class="font-semibold">☀️ Type de destination</h5>
                                            <p class="text-sm text-gray-600">Ex: au soleil, en montagne, dans une capitale, ville culturelle</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="destination-type-input">
                                        <select class="input-field">
                                            <option value="">Choisir un type</option>
                                            <option value="sunny">Au soleil</option>
                                            <option value="mountain">En montagne</option>
                                            <option value="capital">Dans une capitale</option>
                                            <option value="cultural">Ville culturelle</option>
                                            <option value="seaside">Bord de mer</option>
                                            <option value="countryside">À la campagne</option>
                                            <option value="historic">Ville historique</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dates -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🗓️ Quand je veux partir</h3>
                            <div>
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Dates souhaitées</h4>
                                <div id="date-ranges">
                                    <div class="date-range">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                                                <input type="date" class="input-field date-start" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                                                <input type="date" class="input-field date-end" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary mt-3" onclick="addDateRange()">
                                    ➕ Ajouter une autre plage de dates
                                </button>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Période ou durée flexible (facultatif)</h4>
                                <p class="text-sm text-gray-600 mb-4">🪄 Indiquer une période souple augmente les chances de match</p>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Durée souhaitée</label>
                                        <select class="input-field" id="flexible-duration">
                                            <option value="">Sélectionner une durée</option>
                                            <option value="weekend">Un week-end</option>
                                            <option value="week">Une semaine</option>
                                            <option value="2weeks">Deux semaines</option>
                                            <option value="month">Un mois</option>
                                            <option value="2months">Deux mois</option>
                                            <option value="3months">Plus de 3 mois</option>
                                            <option value="flexible">Flexible</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Période générale</label>
                                        <input type="text" id="flexible-period" class="input-field" placeholder="Ex: été 2024, automne, décembre 2025...">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Titre et description -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">📝 Mon annonce</h3>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Titre de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showTitleAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <input type="text" id="experience-title" class="input-field" placeholder="Ex: Échange Paris ↔ Lisbonne - Découverte culturelle en couple" required>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Mentionnez votre ville, la destination et le type d'expérience</p>
                                </div>
                                
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Description de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showDescriptionAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="experience-description" class="textarea-field" placeholder="Décrivez votre projet d'échange, ce que vous recherchez, vos motivations, ce que vous pouvez offrir... Plus c'est détaillé et personnel, mieux c'est !" required style="min-height: 150px;"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Parlez de vos motivations, de votre quartier, de ce que vous aimez faire, de vos recommandations locales...</p>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-center">
                                <button type="button" class="btn-skip text-xs" onclick="showAnnouncementExamples()">
                                    📝 Voir des exemples d'annonces inspirantes
                                </button>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 4: Les infos sur moi -->
            <div class="step-card hidden" id="step-4">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 4</div>
                    <div class="emoji-large">👤</div>
                    <h2 class="text-2xl font-bold mb-2">Les infos sur moi</h2>
                    <p class="text-green-100">Finalisez votre profil personnel</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Profil utilisateur -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👤 Mes informations personnelles</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Prénom</label>
                                    <input type="text" id="first-name" class="input-field" placeholder="Marie" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nom</label>
                                    <input type="text" id="last-name" class="input-field" placeholder="Dupont" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Email</label>
                                    <input type="email" id="email" class="input-field" placeholder="marie@example.com" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Téléphone (WhatsApp)</label>
                                    <input type="tel" id="phone" class="input-field" placeholder="+33 6 12 34 56 78">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Âge</label>
                                    <input type="number" id="age" class="input-field" placeholder="28" min="18" max="99" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Société V.I.E (facultatif)</label>
                                    <input type="text" id="vie-company" class="input-field" placeholder="Ex: Airbus, Total, BNP Paribas...">
                                </div>
                            </div>
                        </div>

                        <!-- Style de séjour et motivations -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">💫 Mon style et mes motivations</h3>
                            
                            <!-- Pourquoi j'échange -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">💭 Pourquoi j'échange (2 choix max)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="change-air">
                                        <span class="text-sm">🌬️ Changer d'air / télétravailler ailleurs</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="culture">
                                        <span class="text-sm">🌍 Découvrir une autre culture</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="break">
                                        <span class="text-sm">😌 Faire une pause / un break</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="family">
                                        <span class="text-sm">👨‍👩‍👧‍👦 Rejoindre des proches</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="climate">
                                        <span class="text-sm">☀️ Profiter d'un climat différent</span>
                                    </label>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autre raison</label>
                                    <input type="text" id="other-reason" class="input-field" placeholder="Précisez votre motivation...">
                                </div>
                            </div>

                            <!-- Style de séjour -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">🌈 Mon style de séjour (1 choix max)</h4>
                                <div class="space-y-3">
                                    <div class="selection-card" data-stay-style="calm">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🧘</div>
                                            <div>
                                                <h5 class="font-semibold">Calme & reposant</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="dynamic">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🎉</div>
                                            <div>
                                                <h5 class="font-semibold">Dynamique & festif</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="immersive">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🏛️</div>
                                            <div>
                                                <h5 class="font-semibold">Immersif & local</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="work">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">💻</div>
                                            <div>
                                                <h5 class="font-semibold">Télétravail & routine</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="nature">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🌲</div>
                                            <div>
                                                <h5 class="font-semibold">Nature & extérieur</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ce qu'il faut savoir sur moi -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🔑 Ce qu'il faut savoir sur moi</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Fumeur</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Télétravail</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Photo de profil -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📸 Ma photo de profil</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">👤</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photo demandée dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter votre photo de profil après la création pour humaniser votre profil !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Une photo souriante et naturelle inspire confiance et augmente vos chances de match</p>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="completeProfile()">
                                🚀 Finaliser mon profil
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content">
            <div class="emoji-large">🎉</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Félicitations !</h3>
            <p class="text-gray-600 mb-4">✨ Votre profil &SWAPP a été créé avec succès !</p>
            <div id="photo-reminder" class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4 hidden">
                <p class="text-sm text-yellow-800">💡 <strong>Conseil :</strong> Pensez à ajouter des photos de votre logement et une photo de profil dans un second temps pour maximiser vos chances de match !</p>
            </div>
            <p class="text-sm text-gray-500 mb-6">Vous pouvez maintenant découvrir les expériences de la communauté.</p>
            <div class="flex flex-col space-y-3">
                <button class="btn-primary" onclick="window.open('https://andswapp.com', '_blank')">
                    📧 Suivre le projet
                </button>
                <button class="btn-secondary" onclick="editProfile()">
                    ✏️ Modifier mon profil
                </button>
                <button class="btn-skip mt-2" onclick="showFeedbackModal()">
                    💬 Donner mon avis sur le formulaire
                </button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="emoji-large">💬</div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">Votre avis nous intéresse !</h3>
            <p class="text-gray-600 mb-6">Aidez-nous à améliorer ce formulaire en partageant vos suggestions avec Maxime :</p>
            
            <div class="space-y-6">
                <!-- Contact WhatsApp/SMS -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-green-800 flex items-center">
                            📱 WhatsApp / SMS
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('+33647034827', this)" title="Copier le numéro">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-green-700 font-mono text-lg mb-3">+33 6 47 03 48 27</p>
                    <p class="text-sm text-green-600">💬 Contactez Maxime directement sur ce numéro</p>
                </div>

                <!-- Contact Email -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-blue-800 flex items-center">
                            📧 Email
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('maxime.barret@andswapp.com', this)" title="Copier l'email">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-blue-700 font-mono text-lg mb-3">maxime.barret@andswapp.com</p>
                    <a href="mailto:maxime.barret@andswapp.com?subject=Feedback%20formulaire%20&SWAPP&body=Salut%20Maxime%20!%0A%0AJ'ai%20testé%20le%20formulaire%20de%20création%20de%20profil%20&SWAPP%20et%20j'aimerais%20partager%20mon%20feedback%20:%0A%0A" 
                       class="btn-secondary w-full inline-block text-center">
                        📧 Envoyer un email
                    </a>
                </div>

                <!-- Suggestions d'amélioration -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">💡 Idées de feedback :</h4>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• Étapes trop longues ou trop courtes ?</li>
                        <li>• Champs manquants ou inutiles ?</li>
                        <li>• Interface confuse ou claire ?</li>
                        <li>• Suggestions d'amélioration ?</li>
                        <li>• Bugs ou problèmes techniques ?</li>
                    </ul>
                </div>
            </div>
            
            <div class="flex space-x-3 mt-6">
                <button class="btn-secondary flex-1" onclick="closeFeedbackModal()">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedTravelWith = null;
        let selectedExchangeStyle = null;
        let selectedStayStyle = null;
        let dateRangeCount = 1;
        let selectedCityIndex = -1;

        // Base de données des villes françaises principales avec régions et codes postaux
        const frenchCities = [
            { name: "Paris", region: "Île-de-France", postalCode: "75001", country: "FR" },
            { name: "Lyon", region: "Auvergne-Rhône-Alpes", postalCode: "69001", country: "FR" },
            { name: "Marseille", region: "Provence-Alpes-Côte d'Azur", postalCode: "13001", country: "FR" },
            { name: "Toulouse", region: "Occitanie", postalCode: "31000", country: "FR" },
            { name: "Nice", region: "Provence-Alpes-Côte d'Azur", postalCode: "06000", country: "FR" },
            { name: "Nantes", region: "Pays de la Loire", postalCode: "44000", country: "FR" },
            { name: "Montpellier", region: "Occitanie", postalCode: "34000", country: "FR" },
            { name: "Strasbourg", region: "Grand Est", postalCode: "67000", country: "FR" },
            { name: "Bordeaux", region: "Nouvelle-Aquitaine", postalCode: "33000", country: "FR" },
            { name: "Lille", region: "Hauts-de-France", postalCode: "59000", country: "FR" },
            { name: "Rennes", region: "Bretagne", postalCode: "35000", country: "FR" },
            { name: "Reims", region: "Grand Est", postalCode: "51100", country: "FR" },
            { name: "Saint-Étienne", region: "Auvergne-Rhône-Alpes", postalCode: "42000", country: "FR" },
            { name: "Toulon", region: "Provence-Alpes-Côte d'Azur", postalCode: "83000", country: "FR" },
            { name: "Le Havre", region: "Normandie", postalCode: "76600", country: "FR" },
            { name: "Grenoble", region: "Auvergne-Rhône-Alpes", postalCode: "38000", country: "FR" },
            { name: "Dijon", region: "Bourgogne-Franche-Comté", postalCode: "21000", country: "FR" },
            { name: "Angers", region: "Pays de la Loire", postalCode: "49000", country: "FR" },
            { name: "Nîmes", region: "Occitanie", postalCode: "30000", country: "FR" },
            { name: "Villeurbanne", region: "Auvergne-Rhône-Alpes", postalCode: "69100", country: "FR" },
            { name: "Clermont-Ferrand", region: "Auvergne-Rhône-Alpes", postalCode: "63000", country: "FR" },
            { name: "Le Mans", region: "Pays de la Loire", postalCode: "72000", country: "FR" },
            { name: "Aix-en-Provence", region: "Provence-Alpes-Côte d'Azur", postalCode: "13100", country: "FR" },
            { name: "Brest", region: "Bretagne", postalCode: "29200", country: "FR" },
            { name: "Tours", region: "Centre-Val de Loire", postalCode: "37000", country: "FR" },
            { name: "Amiens", region: "Hauts-de-France", postalCode: "80000", country: "FR" },
            { name: "Limoges", region: "Nouvelle-Aquitaine", postalCode: "87000", country: "FR" },
            { name: "Annecy", region: "Auvergne-Rhône-Alpes", postalCode: "74000", country: "FR" },
            { name: "Perpignan", region: "Occitanie", postalCode: "66000", country: "FR" },
            { name: "Besançon", region: "Bourgogne-Franche-Comté", postalCode: "25000", country: "FR" },
            { name: "Orléans", region: "Centre-Val de Loire", postalCode: "45000", country: "FR" },
            { name: "Metz", region: "Grand Est", postalCode: "57000", country: "FR" },
            { name: "Rouen", region: "Normandie", postalCode: "76000", country: "FR" },
            { name: "Mulhouse", region: "Grand Est", postalCode: "68100", country: "FR" },
            { name: "Caen", region: "Normandie", postalCode: "14000", country: "FR" },
            { name: "Nancy", region: "Grand Est", postalCode: "54000", country: "FR" }
        ];

        // Villes internationales populaires pour les échanges
        const internationalCities = [
            { name: "Barcelone", region: "Catalogne", postalCode: "08001", country: "ES" },
            { name: "Madrid", region: "Communauté de Madrid", postalCode: "28001", country: "ES" },
            { name: "Lisbonne", region: "Région de Lisbonne", postalCode: "1000", country: "PT" },
            { name: "Rome", region: "Latium", postalCode: "00100", country: "IT" },
            { name: "Milan", region: "Lombardie", postalCode: "20100", country: "IT" },
            { name: "Florence", region: "Toscane", postalCode: "50100", country: "IT" },
            { name: "Berlin", region: "Berlin", postalCode: "10115", country: "DE" },
            { name: "Munich", region: "Bavière", postalCode: "80331", country: "DE" },
            { name: "Amsterdam", region: "Hollande-Septentrionale", postalCode: "1012", country: "NL" },
            { name: "Bruxelles", region: "Région de Bruxelles-Capitale", postalCode: "1000", country: "BE" },
            { name: "Londres", region: "Angleterre", postalCode: "SW1A", country: "UK" },
            { name: "New York", region: "New York", postalCode: "10001", country: "US" },
            { name: "Los Angeles", region: "Californie", postalCode: "90210", country: "US" },
            { name: "Montréal", region: "Québec", postalCode: "H2X", country: "CA" },
            { name: "Toronto", region: "Ontario", postalCode: "M5H", country: "CA" }
        ];

        // Combine toutes les villes
        const allCities = [...frenchCities, ...internationalCities];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            setupEventListeners();
            setupCityAutocomplete();
        });

        function setupEventListeners() {
            // Selection cards
            document.addEventListener('click', function(e) {
                const card = e.target.closest('.selection-card');
                if (card) {
                    const group = card.getAttribute('data-travel-with') || 
                                 card.getAttribute('data-exchange-style') || 
                                 card.getAttribute('data-stay-style');
                    
                    if (card.getAttribute('data-travel-with')) {
                        document.querySelectorAll('[data-travel-with]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedTravelWith = card.getAttribute('data-travel-with');
                        
                        // Show/hide additional inputs
                        document.getElementById('colocation-details').classList.toggle('hidden', selectedTravelWith !== 'colocation');
                        document.getElementById('other-details').classList.toggle('hidden', selectedTravelWith !== 'other');
                    }
                    
                    if (card.getAttribute('data-exchange-style')) {
                        document.querySelectorAll('[data-exchange-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedExchangeStyle = card.getAttribute('data-exchange-style');
                        
                        // Show/hide delayed dates
                        document.getElementById('delayed-dates').classList.toggle('hidden', selectedExchangeStyle !== 'delayed' && selectedExchangeStyle !== 'both');
                    }
                    
                    if (card.getAttribute('data-stay-style')) {
                        document.querySelectorAll('[data-stay-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedStayStyle = card.getAttribute('data-stay-style');
                    }
                }
            });

            // Flexible options
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('flexible-checkbox')) {
                    const option = e.target.closest('.flexible-option');
                    const inputDiv = option.querySelector('div[id$="-input"]');
                    
                    if (e.target.checked) {
                        option.classList.add('selected');
                        inputDiv.classList.remove('hidden');
                    } else {
                        option.classList.remove('selected');
                        inputDiv.classList.add('hidden');
                    }
                }
            });

            // Pet details
            document.addEventListener('change', function(e) {
                if (e.target.name === 'has-pet') {
                    document.getElementById('pet-details').classList.toggle('hidden', e.target.value !== 'yes');
                }
            });

            // Photos seront demandées dans un second temps - pas de gestion d'upload ici

            // Reason checkboxes (max 2)
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('reason-checkbox')) {
                    const checked = document.querySelectorAll('.reason-checkbox:checked');
                    if (checked.length > 2) {
                        e.target.checked = false;
                        showNotification('Vous pouvez sélectionner maximum 2 raisons', 'error');
                    }
                }
            });
        }

        function setupCityAutocomplete() {
            const cityInput = document.getElementById('city');
            const suggestionsDiv = document.getElementById('city-suggestions');
            const regionInput = document.getElementById('region');
            const postalCodeInput = document.getElementById('postal-code');
            const countrySelect = document.getElementById('country');

            cityInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();
                selectedCityIndex = -1;

                if (query.length < 2) {
                    hideSuggestions();
                    return;
                }

                const matches = allCities.filter(city => 
                    city.name.toLowerCase().includes(query) ||
                    city.region.toLowerCase().includes(query)
                ).slice(0, 8); // Limite à 8 résultats

                if (matches.length > 0) {
                    showSuggestions(matches);
                } else {
                    hideSuggestions();
                }
            });

            cityInput.addEventListener('keydown', function(e) {
                const suggestions = suggestionsDiv.querySelectorAll('.city-suggestion');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    selectedCityIndex = Math.min(selectedCityIndex + 1, suggestions.length - 1);
                    updateHighlight(suggestions);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    selectedCityIndex = Math.max(selectedCityIndex - 1, -1);
                    updateHighlight(suggestions);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (selectedCityIndex >= 0 && suggestions[selectedCityIndex]) {
                        selectCity(suggestions[selectedCityIndex].dataset.cityIndex);
                    }
                } else if (e.key === 'Escape') {
                    hideSuggestions();
                }
            });

            // Fermer les suggestions en cliquant ailleurs
            document.addEventListener('click', function(e) {
                if (!cityInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                    hideSuggestions();
                }
            });

            function showSuggestions(cities) {
                suggestionsDiv.innerHTML = '';
                
                cities.forEach((city, index) => {
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.className = 'city-suggestion';
                    suggestionDiv.dataset.cityIndex = allCities.indexOf(city);
                    
                    const countryFlag = getCountryFlag(city.country);
                    
                    suggestionDiv.innerHTML = `
                        <div class="city-suggestion-name">${countryFlag} ${city.name}</div>
                        <div class="city-suggestion-details">${city.region} • ${city.postalCode}</div>
                    `;
                    
                    suggestionDiv.addEventListener('click', function() {
                        selectCity(this.dataset.cityIndex);
                    });
                    
                    suggestionsDiv.appendChild(suggestionDiv);
                });
                
                suggestionsDiv.classList.remove('hidden');
            }

            function hideSuggestions() {
                suggestionsDiv.classList.add('hidden');
                selectedCityIndex = -1;
            }

            function updateHighlight(suggestions) {
                suggestions.forEach((suggestion, index) => {
                    suggestion.classList.toggle('highlighted', index === selectedCityIndex);
                });
            }

            function selectCity(cityIndex) {
                const city = allCities[cityIndex];
                
                // Remplir automatiquement tous les champs
                cityInput.value = city.name;
                regionInput.value = city.region;
                postalCodeInput.value = city.postalCode;
                countrySelect.value = city.country;
                
                hideSuggestions();
                
                // Animation de confirmation
                cityInput.style.borderColor = '#10b981';
                setTimeout(() => {
                    cityInput.style.borderColor = '';
                }, 1000);
            }

            function getCountryFlag(countryCode) {
                const flags = {
                    'FR': '🇫🇷',
                    'ES': '🇪🇸', 
                    'IT': '🇮🇹',
                    'DE': '🇩🇪',
                    'PT': '🇵🇹',
                    'NL': '🇳🇱',
                    'BE': '🇧🇪',
                    'UK': '🇬🇧',
                    'US': '🇺🇸',
                    'CA': '🇨🇦'
                };
                return flags[countryCode] || '🌍';
            }
        }

        function addDateRange() {
            dateRangeCount++;
            const dateRangesDiv = document.getElementById('date-ranges');
            const newRange = document.createElement('div');
            newRange.className = 'date-range';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Plage de dates ${dateRangeCount}</span>
                    <button type="button" class="text-red-500 hover:text-red-700" onclick="removeDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                        <input type="date" class="input-field date-start">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                        <input type="date" class="input-field date-end">
                    </div>
                </div>
            `;
            dateRangesDiv.appendChild(newRange);
        }

        function addDelayedDateRange() {
            const delayedDatesDiv = document.getElementById('delayed-dates');
            const existingRanges = delayedDatesDiv.querySelectorAll('.bg-blue-50').length;
            
            const newRange = document.createElement('div');
            newRange.className = 'bg-blue-50 border border-blue-200 rounded-lg p-4 mt-3';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <p class="text-sm text-blue-700 font-medium">📅 Période ${existingRanges + 1}</p>
                    <button type="button" class="text-red-500 hover:text-red-700 text-sm" onclick="removeDelayedDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                        <input type="date" class="input-field">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                        <input type="date" class="input-field">
                    </div>
                </div>
            `;
            
            // Insert before the "Ajouter" button
            const addButton = delayedDatesDiv.querySelector('button');
            addButton.parentNode.insertBefore(newRange, addButton);
        }

        function removeDelayedDateRange(button) {
            button.closest('.bg-blue-50').remove();
        }

        function removeDateRange(button) {
            button.closest('.date-range').remove();
        }

        function nextStep() {
            if (validateCurrentStep()) {
                currentStep++;
                if (currentStep > 4) currentStep = 4;
                showStep(currentStep);
                updateProgress();
            }
        }

        function prevStep() {
            currentStep--;
            if (currentStep < 1) currentStep = 1;
            showStep(currentStep);
            updateProgress();
        }

        function showStep(step) {
            // Hide all steps
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`step-${i}`).classList.add('hidden');
            }
            
            // Show current step
            document.getElementById(`step-${step}`).classList.remove('hidden');
            
            // Update step indicator
            document.getElementById('current-step').textContent = step;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const progress = (currentStep / 4) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            // Update step dots
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    dot.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    dot.classList.add('active');
                }
            });
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const country = document.getElementById('country').value;
                    const region = document.getElementById('region').value;
                    const city = document.getElementById('city').value;
                    const postalCode = document.getElementById('postal-code').value;
                    const bedrooms = document.getElementById('bedrooms').value;
                    const sleepingSpots = document.getElementById('sleeping-spots').value;
                    const housingType = document.getElementById('housing-type').value;
                    
                    if (!country || !region || !city || !postalCode || !bedrooms || !sleepingSpots || !housingType) {
                        showNotification('Veuillez remplir tous les champs obligatoires.', 'error');
                        return false;
                    }
                    break;
                    
                case 2:
                    if (!selectedExchangeStyle) {
                        showNotification('Veuillez choisir votre style d\'échange.', 'error');
                        return false;
                    }
                    
                    if (!selectedTravelWith) {
                        showNotification('Veuillez indiquer avec qui vous voyagez.', 'error');
                        return false;
                    }
                    
                    const hasPet = document.querySelector('input[name="has-pet"]:checked');
                    if (!hasPet) {
                        showNotification('Veuillez indiquer si vous avez un animal.', 'error');
                        return false;
                    }
                    break;
                    
                case 3:
                    const mainDestination = document.getElementById('main-destination').value;
                    if (!mainDestination) {
                        showNotification('Veuillez indiquer votre destination principale.', 'error');
                        return false;
                    }
                    
                    const dateStarts = document.querySelectorAll('.date-start');
                    const dateEnds = document.querySelectorAll('.date-end');
                    let hasValidDate = false;
                    
                    for (let i = 0; i < dateStarts.length; i++) {
                        if (dateStarts[i].value && dateEnds[i].value) {
                            hasValidDate = true;
                            break;
                        }
                    }
                    
                    if (!hasValidDate) {
                        showNotification('Veuillez renseigner au moins une plage de dates.', 'error');
                        return false;
                    }
                    
                    const experienceTitle = document.getElementById('experience-title').value;
                    const experienceDescription = document.getElementById('experience-description').value;
                    
                    if (!experienceTitle || !experienceDescription) {
                        showNotification('Veuillez remplir le titre et la description de votre expérience.', 'error');
                        return false;
                    }
                    break;
                    
                case 4:
                    const firstName = document.getElementById('first-name').value;
                    const lastName = document.getElementById('last-name').value;
                    const email = document.getElementById('email').value;
                    const age = document.getElementById('age').value;
                    
                    if (!firstName || !lastName || !email || !age) {
                        showNotification('Veuillez remplir tous les champs obligatoires du profil.', 'error');
                        return false;
                    }
                    break;
            }
            return true;
        }

        function completeProfile() {
            if (validateCurrentStep()) {
                // Collect all form data
                const formData = collectAllFormData();
                
                // Send to Zapier
                sendToZapier(formData);
                
                // Toujours afficher le rappel photos car elles seront demandées plus tard
                document.getElementById('photo-reminder').classList.remove('hidden');
                
                showNotification('✨ Profil créé avec succès !', 'success');
                setTimeout(() => {
                    document.getElementById('success-modal').classList.add('show');
                }, 1000);
            }
        }

        function collectAllFormData() {
            const data = {
                // Timestamp
                timestamp: new Date().toISOString(),
                
                // Étape 1 - Appartement
                country: document.getElementById('country').value,
                region: document.getElementById('region').value,
                city: document.getElementById('city').value,
                postalCode: document.getElementById('postal-code').value,
                bedrooms: document.getElementById('bedrooms').value,
                sleepingSpots: document.getElementById('sleeping-spots').value,
                surface: document.getElementById('surface').value,
                housingType: document.getElementById('housing-type').value,
                
                // Équipements
                equipment: Array.from(document.querySelectorAll('.equipment-checkbox:checked')).map(cb => cb.value),
                otherEquipment: document.getElementById('other-equipment').value,
                
                // Obligations pour le swapper
                obligations: Array.from(document.querySelectorAll('.obligation-checkbox:checked')).map(cb => cb.value),
                otherObligations: document.getElementById('other-obligations').value,
                
                // Étape 2 - Style d'échange
                exchangeStyle: selectedExchangeStyle,
                travelWith: selectedTravelWith,
                
                // Animaux
                hasPet: document.querySelector('input[name="has-pet"]:checked')?.value,
                travelWithPet: document.querySelector('input[name="travel-with-pet"]:checked')?.value,
                
                // Profil swapper idéal
                idealSwapperDescription: document.getElementById('ideal-swapper-description').value,
                agePreferences: Array.from(document.querySelectorAll('.age-preference:checked')).map(cb => cb.value),
                flexibilityPreferences: Array.from(document.querySelectorAll('.flexibility-preference:checked')).map(cb => cb.value),
                
                // Étape 3 - Expérience
                mainDestination: document.getElementById('main-destination').value,
                flexibleDuration: document.getElementById('flexible-duration').value,
                flexiblePeriod: document.getElementById('flexible-period').value,
                experienceTitle: document.getElementById('experience-title').value,
                experienceDescription: document.getElementById('experience-description').value,
                
                // Dates
                dateRanges: Array.from(document.querySelectorAll('.date-range')).map(range => ({
                    start: range.querySelector('.date-start').value,
                    end: range.querySelector('.date-end').value
                })).filter(range => range.start && range.end),
                
                // Options flexibles
                flexibleOptions: {
                    region: document.querySelector('[data-flexible-type="region"] input:checked') ? 
                           document.querySelector('[data-flexible-type="region"] #region-input input').value : null,
                    cities: document.querySelector('[data-flexible-type="cities"] input:checked') ? 
                           Array.from(document.querySelectorAll('[data-flexible-type="cities"] #cities-input input')).map(i => i.value).filter(v => v) : null,
                    destinationType: document.querySelector('[data-flexible-type="destination-type"] input:checked') ? 
                                   document.querySelector('[data-flexible-type="destination-type"] select').value : null
                },
                
                // Étape 4 - Profil personnel
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                age: document.getElementById('age').value,
                vieCompany: document.getElementById('vie-company').value,
                
                // Motivations et style
                reasons: Array.from(document.querySelectorAll('.reason-checkbox:checked')).map(cb => cb.value),
                otherReason: document.getElementById('other-reason').value,
                stayStyle: selectedStayStyle,
                
                // Infos personnelles
                smoker: document.querySelector('input[name="smoker"]:checked')?.value,
                remoteWork: document.querySelector('input[name="remote-work"]:checked')?.value,
                
                // Photos (seront demandées dans un second temps)
                hasApartmentPhotos: false,
                hasProfilePhoto: false
            };
            
            return data;
        }

        function sendToZapier(data) {
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            console.log('🚀 ENVOI À ZAPIER - Début');
            console.log('📡 URL Zapier:', zapierUrl);
            console.log('📦 Données à envoyer:', data);
            
            // Affichage visuel pour l'utilisateur
            showNotification('📡 Envoi des données à Zapier...', 'info');
            
            fetch(zapierUrl, {
                method: 'POST',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 Réponse Zapier reçue');
                console.log('📊 Status:', response.status);
                console.log('📋 Status Text:', response.statusText);
                console.log('🔗 URL finale:', response.url);
                
                if (response.ok || response.status === 200) {
                    console.log('✅ SUCCÈS - Données envoyées à Zapier avec succès !');
                    showNotification('✅ Données envoyées à Zapier avec succès !', 'success');
                    
                    // Lire la réponse pour plus de détails
                    return response.text();
                } else {
                    console.error('❌ ERREUR - Status HTTP:', response.status);
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(responseText => {
                console.log('📄 Réponse Zapier complète:', responseText);
            })
            .catch(error => {
                console.error('❌ ERREUR RÉSEAU - Détails complètes:', error);
                console.error('🔍 Type d\'erreur:', error.name);
                console.error('💬 Message d\'erreur:', error.message);
                console.error('📚 Stack trace:', error.stack);
                
                // Fallback : essayer avec une méthode alternative
                console.log('🔄 Tentative de fallback...');
                tryZapierFallback(data);
            });
        }

        function tryZapierFallback(data) {
            console.log('🔄 FALLBACK - Tentative avec méthode alternative');
            
            // Essayer avec une requête plus simple
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            fetch(zapierUrl, {
                method: 'POST',
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 FALLBACK - Réponse reçue:', response.status);
                if (response.ok || response.status === 200) {
                    console.log('✅ FALLBACK SUCCÈS !');
                    showNotification('✅ Données envoyées avec succès (méthode alternative)', 'success');
                } else {
                    throw new Error(`Fallback failed: ${response.status}`);
                }
            })
            .catch(fallbackError => {
                console.error('❌ FALLBACK ÉCHOUÉ:', fallbackError);
                
                // Sauvegarder localement en dernier recours
                try {
                    localStorage.setItem('swapp_profile_backup', JSON.stringify(data));
                    console.log('💾 Données sauvegardées localement');
                } catch (storageError) {
                    console.error('❌ Impossible de sauvegarder localement:', storageError);
                }
            });
        }

        function showFeedbackModal() {
            document.getElementById('feedback-modal').classList.add('show');
        }

        function closeFeedbackModal() {
            document.getElementById('feedback-modal').classList.remove('show');
        }

        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(function() {
                // Visual feedback
                const originalText = button.textContent;
                button.textContent = '✅ Copié !';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
                
                showNotification(`📋 ${text} copié dans le presse-papier !`, 'success');
            }).catch(function(err) {
                console.error('Erreur de copie:', err);
                showNotification('❌ Impossible de copier automatiquement', 'error');
            });
        }

        function showNotification(message, type = 'info') {
            // Créer la notification
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
            
            // Styles selon le type
            const styles = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                warning: 'bg-yellow-500 text-white',
                info: 'bg-blue-500 text-white'
            };
            
            notification.className += ` ${styles[type] || styles.info}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animation d'entrée
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Animation de sortie
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Fonctions pour les boutons d'aide
        function surpriseMe() {
            // Modal interactif pour choisir le mood et la région
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="emoji-large">🎲</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Surprends-moi !</h3>
                    <p class="text-gray-600 mb-6">Dis-moi ton mood et je te trouve la destination parfaite !</p>
                    
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌈 Ton mood ?</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="mer" class="mr-2">
                                    <span>🏖️ Mer & soleil</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="montagne" class="mr-2">
                                    <span>🏔️ Montagne & nature</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="ville" class="mr-2">
                                    <span>🏙️ Ville & culture</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="aventure" class="mr-2">
                                    <span>✨ Aventure</span>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌍 Région du monde ?</h4>
                            <div class="space-y-2">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="europe" class="mr-2">
                                    <span>🇪🇺 Europe</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-nord" class="mr-2">
                                    <span>🇺🇸 Amérique du Nord</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-sud" class="mr-2">
                                    <span>🇧🇷 Amérique du Sud</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="asie-oceanie" class="mr-2">
                                    <span>🌏 Asie / Océanie / Afrique</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="surprise" class="mr-2">
                                    <span>🎲 Surprise totale !</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="generateSurpriseDestination(this)">🎲 Surprends-moi !</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function generateSurpriseDestination(button) {
            const modal = button.closest('.modal');
            const mood = modal.querySelector('input[name="mood"]:checked')?.value;
            const region = modal.querySelector('input[name="region"]:checked')?.value;
            
            if (!mood || !region) {
                showNotification('Choisis ton mood et ta région préférée !', 'warning');
                return;
            }
            
            const destinations = {
                europe: {
                    mer: ['Barcelone (Espagne)', 'Lisbonne (Portugal)', 'Tarragone (Espagne)'],
                    montagne: ['Ski (Norvège)', 'Berlin (Allemagne)', 'Copenhague (Danemark)'],
                    ville: ['Paris (France)', 'Madrid (Espagne)', 'Bruxelles (Belgique)', 'Luxembourg', 'Berlin (Allemagne)'],
                    aventure: ['Kilkenny (Irlande)', 'Opole (Pologne)', 'Ski (Norvège)']
                },
                'amerique-nord': {
                    mer: ['Miami (États-Unis)', 'Los Angeles (États-Unis)', 'Playa del Carmen (Mexique)'],
                    montagne: ['Seattle (États-Unis)', 'Montréal (Canada)', 'Buffalo (États-Unis)'],
                    ville: ['New York (États-Unis)', 'Chicago (États-Unis)', 'Toronto (Canada)', 'Mexico City (Mexique)'],
                    aventure: ['Little Rock (États-Unis)', 'Santa Rosa (États-Unis)', 'Merida (Mexique)']
                },
                'amerique-sud': {
                    mer: ['Rio de Janeiro (Brésil)', 'Santo Domingo (République Dominicaine)'],
                    montagne: ['Belo Horizonte (Brésil)', 'Itajubá (Brésil)'],
                    ville: ['São Paulo (Brésil)', 'Monterrey (Mexique)', 'Puebla (Mexique)'],
                    aventure: ['Ribeirão Preto (Brésil)', 'San Juan de la Maguana (République Dominicaine)']
                },
                'asie-oceanie': {
                    mer: ['Sydney (Australie)'],
                    montagne: ['Chandigarh (Inde)'],
                    ville: ['Singapour', 'Mumbai (Inde)', 'Accra (Ghana)'],
                    aventure: ['Libreville (Gabon)', 'Chandigarh (Inde)']
                }
            };
            
            let selectedDestinations = [];
            
            if (region === 'surprise') {
                // Mélange toutes les destinations
                Object.values(destinations).forEach(regionDests => {
                    Object.values(regionDests).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                });
            } else {
                selectedDestinations = destinations[region]?.[mood] || [];
                
                // Si pas de destinations pour ce mood dans cette région, prendre toutes les destinations de la région
                if (selectedDestinations.length === 0) {
                    Object.values(destinations[region] || {}).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                }
            }
            
            if (selectedDestinations.length === 0) {
                showNotification('Aucune destination trouvée pour cette combinaison !', 'error');
                return;
            }
            
            const randomDestination = selectedDestinations[Math.floor(Math.random() * selectedDestinations.length)];
            document.getElementById('main-destination').value = randomDestination;
            
            closeModal(button);
            showNotification(`🎲 Destination surprise : ${randomDestination} !`, 'success');
        }

        function showAvailableCities() {
            const citiesByRegion = {
                '🇺🇸 États-Unis / Amérique du Nord': [
                    'New York', 'Boston', 'Chicago', 'Los Angeles', 'Philadelphia', 
                    'Washington DC', 'Houston', 'Dallas', 'Miami', 'Seattle', 
                    'Buffalo', 'Dayton', 'Little Rock', 'Lakeland', 'Santa Rosa', 'Iowa City'
                ],
                '🇨🇦 Canada': [
                    'Montréal', 'Toronto', 'Thorold'
                ],
                '🇲🇽 Mexique / Amérique centrale': [
                    'Mexico City', 'San Luis Potosí', 'Monterrey', 'Puebla', 
                    'Playa del Carmen', 'Merida (Yucatán)'
                ],
                '🇧🇷 Brésil': [
                    'São Paulo', 'Rio de Janeiro', 'Belo Horizonte', 
                    'Ribeirão Preto', 'Taubaté', 'Itajubá (MG)'
                ],
                '🇩🇴 République Dominicaine / Caraïbes': [
                    'Santo Domingo', 'San Juan de la Maguana'
                ],
                '🇪🇺 Europe': [
                    'Paris', 'Bruxelles', 'Luxembourg', 'Copenhague', 'Madrid', 
                    'Barcelone', 'Tarragone', 'Lisbonne', 'Opole', 'Kilkenny (Irlande)', 
                    'Berlin', 'Ski (Norvège)'
                ],
                '🌏 Asie / Océanie / Afrique': [
                    'Singapour', 'Sydney', 'Mumbai', 'Chandigarh', 
                    'Libreville (Gabon)', 'Accra (Ghana)'
                ]
            };
            
            let modalContent = '<div class="space-y-6">';
            
            Object.entries(citiesByRegion).forEach(([region, cities]) => {
                modalContent += `
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">${region}</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                `;
                
                cities.forEach(city => {
                    modalContent += `
                        <button class="city-vignette bg-blue-50 hover:bg-blue-100 border border-blue-200 hover:border-blue-400 rounded-lg px-3 py-2 text-sm text-blue-800 hover:text-blue-900 transition-all duration-200 cursor-pointer text-left" 
                                onclick="selectDestinationCity('${city.replace(/'/g, "\\'")}')">
                            📍 ${city}
                        </button>
                    `;
                });
                
                modalContent += '</div></div>';
            });
            
            modalContent += '</div>';
            
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🌍 Villes disponibles sur &SWAPP</h3>
                    <p class="text-sm text-gray-600 mb-6">💡 Cliquez sur une ville pour la sélectionner comme destination</p>
                    ${modalContent}
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function showExperienceExamples() {
            const examples = [
                '✨ "Échange Paris ↔ Lisbonne - Découverte culturelle en couple"',
                '🏖️ "Swap Lyon ↔ Barcelone - Soleil et architecture catalane"',
                '🎨 "Échange Marseille ↔ Florence - Immersion artistique"',
                '💻 "Swap Bordeaux ↔ Berlin - Télétravail et vie nocturne"',
                '🌿 "Échange Nantes ↔ Amsterdam - Vélo et canaux"',
                '🍝 "Swap Nice ↔ Rome - Gastronomie méditerranéenne"',
                '🏛️ "Échange Toulouse ↔ Prague - Architecture et histoire"',
                '🎭 "Swap Lille ↔ Londres - Théâtre et musées"'
            ];
            
            showModal('✨ Exemples d\'expériences inspirantes', examples.join('<br><br>'));
        }

        // NOUVEAUX ASSISTANTS INTERACTIFS

        function showSwapperAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">👤</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Profil Swapper</h3>
                        <p class="text-gray-600">Créons ensemble la description de votre swapper idéal !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Type de personne -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Type de personne recherchée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="young-professional" class="swapper-input">
                                    <span class="text-sm">Jeune professionnel</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="couple" class="swapper-input">
                                    <span class="text-sm">Couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="family" class="swapper-input">
                                    <span class="text-sm">Famille</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="student" class="swapper-input">
                                    <span class="text-sm">Étudiant</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="retiree" class="swapper-input">
                                    <span class="text-sm">Retraité actif</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="any" class="swapper-input">
                                    <span class="text-sm">Peu importe</span>
                                </label>
                            </div>
                        </div>

                        <!-- Qualités importantes -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Qualités importantes (max 4)</h4>
                            <div class="flex flex-wrap gap-2">
                                <span class="quality-tag" data-quality="respectful">Respectueux</span>
                                <span class="quality-tag" data-quality="calm">Calme</span>
                                <span class="quality-tag" data-quality="communicative">Communicatif</span>
                                <span class="quality-tag" data-quality="clean">Soigneux</span>
                                <span class="quality-tag" data-quality="flexible">Flexible</span>
                                <span class="quality-tag" data-quality="cultural">Amateur de culture</span>
                                <span class="quality-tag" data-quality="social">Sociable</span>
                                <span class="quality-tag" data-quality="independent">Indépendant</span>
                                <span class="quality-tag" data-quality="experienced">Voyageur expérimenté</span>
                                <span class="quality-tag" data-quality="open-minded">Ouvert d'esprit</span>
                            </div>
                        </div>

                        <!-- Centres d'intérêt -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Centres d'intérêt partagés (optionnel)</h4>
                            <input type="text" id="swapper-interests" class="input-field" placeholder="Ex: art, cuisine, sport, musique, nature...">
                        </div>

                        <!-- Critères spéciaux -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔧 Critères spéciaux (optionnel)</h4>
                            <textarea id="swapper-special" class="textarea-field" placeholder="Ex: non-fumeur, avec enfants, télétravailleur..." style="min-height: 80px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="swapper-preview" class="text-sm text-gray-700 italic">
                                Sélectionnez vos préférences pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useSwapperDescription()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupSwapperAssistantListeners(modal);
        }

        function setupSwapperAssistantListeners(modal) {
            // Quality tags selection
            modal.addEventListener('click', function(e) {
                if (e.target.classList.contains('quality-tag')) {
                    const selectedQualities = modal.querySelectorAll('.quality-tag.selected');
                    
                    if (e.target.classList.contains('selected')) {
                        e.target.classList.remove('selected');
                    } else if (selectedQualities.length < 4) {
                        e.target.classList.add('selected');
                    } else {
                        showNotification('Maximum 4 qualités sélectionnables', 'warning');
                    }
                    
                    updateSwapperPreview(modal);
                }
            });

            // Input changes
            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('swapper-input')) {
                    updateSwapperPreview(modal);
                }
            });

            modal.addEventListener('input', function(e) {
                if (e.target.id === 'swapper-interests' || e.target.id === 'swapper-special') {
                    updateSwapperPreview(modal);
                }
            });
        }

        function updateSwapperPreview(modal) {
            const type = modal.querySelector('input[name="swapper-type"]:checked')?.value;
            const qualities = Array.from(modal.querySelectorAll('.quality-tag.selected')).map(tag => tag.dataset.quality);
            const interests = modal.querySelector('#swapper-interests').value;
            const special = modal.querySelector('#swapper-special').value;

            let description = '';

            // Type de personne
            const typeTexts = {
                'young-professional': 'Je recherche un jeune professionnel',
                'couple': 'Je recherche un couple',
                'family': 'Je recherche une famille',
                'student': 'Je recherche un étudiant',
                'retiree': 'Je recherche un retraité actif',
                'any': 'Je suis ouvert à différents profils'
            };

            if (type && type !== 'any') {
                description += typeTexts[type];
            }

            // Qualités
            if (qualities.length > 0) {
                const qualityTexts = {
                    'respectful': 'respectueux',
                    'calm': 'calme',
                    'communicative': 'communicatif',
                    'clean': 'soigneux',
                    'flexible': 'flexible',
                    'cultural': 'amateur de culture',
                    'social': 'sociable',
                    'independent': 'indépendant',
                    'experienced': 'voyageur expérimenté',
                    'open-minded': 'ouvert d\'esprit'
                };

                const qualityList = qualities.map(q => qualityTexts[q]).join(', ');
                
                if (description) {
                    description += ', ';
                } else {
                    description += 'Je recherche une personne ';
                }
                
                if (qualities.length === 1) {
                    description += qualityList;
                } else if (qualities.length === 2) {
                    description += qualityList.replace(', ', ' et ');
                } else {
                    const lastComma = qualityList.lastIndexOf(', ');
                    description += qualityList.substring(0, lastComma) + ' et ' + qualityList.substring(lastComma + 2);
                }
            }

            // Centres d'intérêt
            if (interests.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Idéalement avec des centres d'intérêt comme : ${interests.trim()}`;
            }

            // Critères spéciaux
            if (special.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Critères importants : ${special.trim()}`;
            }

            if (description && !description.endsWith('.')) {
                description += '.';
            }

            modal.querySelector('#swapper-preview').textContent = description || 'Sélectionnez vos préférences pour voir l\'aperçu...';
        }

        function useSwapperDescription() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#swapper-preview').textContent;
            
            if (description && description !== 'Sélectionnez vos préférences pour voir l\'aperçu...') {
                document.getElementById('ideal-swapper-description').value = description;
                showNotification('✅ Description du swapper ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez sélectionner au moins une préférence', 'warning');
            }
        }

        function showTitleAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">✍️</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Titre d'Expérience</h3>
                        <p class="text-gray-600">Créons un titre accrocheur pour votre annonce !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Votre ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">📍 Votre ville (d'où vous venez)</h4>
                            <input type="text" id="title-origin" class="input-field title-input" placeholder="Ex: Paris, Lyon, Marseille...">
                        </div>

                        <!-- Durée du séjour -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">⏰ Durée souhaitée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="weekend" class="title-input">
                                    <span class="text-sm">Un week-end</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-week" class="title-input">
                                    <span class="text-sm">1 semaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-weeks" class="title-input">
                                    <span class="text-sm">2 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="3-weeks" class="title-input">
                                    <span class="text-sm">3 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-month" class="title-input">
                                    <span class="text-sm">1 mois</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-months" class="title-input">
                                    <span class="text-sm">2 mois</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-duration" class="input-field title-input" placeholder="Ou précisez votre durée : ex: 10 jours, 6 semaines...">
                            </div>
                        </div>

                        <!-- Type d'expérience -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Type d'expérience</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="cultural" class="title-input">
                                    <span class="text-sm">Découverte culturelle</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="work" class="title-input">
                                    <span class="text-sm">Télétravail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="relax" class="title-input">
                                    <span class="text-sm">Détente & repos</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="adventure" class="title-input">
                                    <span class="text-sm">Aventure urbaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="gastronomy" class="title-input">
                                    <span class="text-sm">Gastronomie</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="art" class="title-input">
                                    <span class="text-sm">Art & musées</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-type" class="input-field title-input" placeholder="Ou décrivez votre propre type d'expérience...">
                            </div>
                        </div>

                        <!-- Avec qui -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Avec qui voyagez-vous ?</h4>
                            <div class="grid grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="solo" class="title-input">
                                    <span class="text-sm">Solo</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="couple" class="title-input">
                                    <span class="text-sm">En couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="family" class="title-input">
                                    <span class="text-sm">En famille</span>
                                </label>
                            </div>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre titre :</h4>
                            <div id="title-preview" class="text-sm text-gray-700 italic font-medium">
                                Remplissez les champs pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useTitleDescription()">✅ Utiliser ce titre</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupTitleAssistantListeners(modal);
        }

        function setupTitleAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });

            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });
        }

        function updateTitlePreview(modal) {
            const origin = modal.querySelector('#title-origin').value.trim();
            const duration = modal.querySelector('input[name="duration"]:checked')?.value;
            const customDuration = modal.querySelector('#title-custom-duration').value.trim();
            const experienceType = modal.querySelector('input[name="experience-type"]:checked')?.value;
            const customType = modal.querySelector('#title-custom-type').value.trim();
            const travelGroup = modal.querySelector('input[name="travel-group"]:checked')?.value;

            let title = '';

            // Durée
            let durationText = '';
            if (customDuration) {
                durationText = customDuration;
            } else if (duration) {
                const durationTexts = {
                    'weekend': 'Week-end',
                    '1-week': '1 semaine',
                    '2-weeks': '2 semaines', 
                    '3-weeks': '3 semaines',
                    '1-month': '1 mois',
                    '2-months': '2 mois'
                };
                durationText = durationTexts[duration];
            }

            // Type d'expérience
            let experienceText = '';
            if (customType) {
                experienceText = customType;
            } else if (experienceType) {
                const typeTexts = {
                    'cultural': 'de découverte culturelle',
                    'work': 'de télétravail',
                    'relax': 'de détente',
                    'adventure': 'd\'aventure urbaine',
                    'gastronomy': 'd\'exploration gastronomique',
                    'art': 'd\'immersion artistique'
                };
                experienceText = typeTexts[experienceType];
            }

            // Construction du titre
            if (durationText && experienceText) {
                title = `${durationText} ${experienceText}`;
            } else if (durationText) {
                title = `${durationText} d'échange`;
            } else if (experienceText) {
                title = `Séjour ${experienceText}`;
            }

            // Ajout de l'origine si spécifiée
            if (origin && title) {
                title += ` depuis ${origin}`;
            } else if (origin && !title) {
                title = `Échange depuis ${origin}`;
            }

            // Groupe de voyage
            if (travelGroup && travelGroup !== 'solo' && title) {
                const groupTexts = {
                    'couple': 'en couple',
                    'family': 'en famille'
                };
                title += ` ${groupTexts[travelGroup]}`;
            }

            modal.querySelector('#title-preview').textContent = title || 'Remplissez les champs pour voir l\'aperçu...';
        }

        function useTitleDescription() {
            const modal = document.querySelector('.assistant-modal');
            const title = modal.querySelector('#title-preview').textContent;
            
            if (title && title !== 'Remplissez les champs pour voir l\'aperçu...') {
                document.getElementById('experience-title').value = title;
                showNotification('✅ Titre d\'expérience ajouté !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins la durée ou le type d\'expérience', 'warning');
            }
        }

        function showDescriptionAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">📝</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Description d'Expérience</h3>
                        <p class="text-gray-600">Créons une description complète et attractive !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Qui êtes-vous -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👤 Qui êtes-vous ?</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-who" class="input-field desc-input" placeholder="Ex: Marie et Thomas, couple de trentenaires parisiens">
                                <input type="text" id="desc-profession" class="input-field desc-input" placeholder="Ex: développeur et architecte">
                                <input type="text" id="desc-passions" class="input-field desc-input" placeholder="Ex: passionnés d'architecture et de gastronomie">
                            </div>
                        </div>

                        <!-- Votre projet -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Votre projet de voyage</h4>
                            <div class="space-y-3">
                                <textarea id="desc-motivation" class="textarea-field desc-input" placeholder="Ex: Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí..." style="min-height: 80px;"></textarea>
                            </div>
                        </div>

                        <!-- Votre quartier/ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🏘️ Votre quartier/ville</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-location" class="input-field desc-input" placeholder="Ex: 11ème arrondissement, quartier branché">
                                <textarea id="desc-neighborhood" class="textarea-field desc-input" placeholder="Ex: avec de nombreux bars et restaurants, proche du métro..." style="min-height: 60px;"></textarea>
                            </div>
                        </div>

                        <!-- Ce que vous offrez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎁 Ce que vous offrez</h4>
                            <textarea id="desc-offer" class="textarea-field desc-input" placeholder="Ex: Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Ce que vous recherchez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔍 Ce que vous recherchez</h4>
                            <textarea id="desc-looking" class="textarea-field desc-input" placeholder="Ex: Nous recherchons un couple ou une personne seule, flexible sur les dates..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="description-preview" class="text-sm text-gray-700" style="max-height: 200px; overflow-y: auto;">
                                Remplissez les sections pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useDescriptionText()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupDescriptionAssistantListeners(modal);
        }

        function setupDescriptionAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('desc-input')) {
                    updateDescriptionPreview(modal);
                }
            });
        }

        function updateDescriptionPreview(modal) {
            const who = modal.querySelector('#desc-who').value.trim();
            const profession = modal.querySelector('#desc-profession').value.trim();
            const passions = modal.querySelector('#desc-passions').value.trim();
            const motivation = modal.querySelector('#desc-motivation').value.trim();
            const location = modal.querySelector('#desc-location').value.trim();
            const neighborhood = modal.querySelector('#desc-neighborhood').value.trim();
            const offer = modal.querySelector('#desc-offer').value.trim();
            const looking = modal.querySelector('#desc-looking').value.trim();

            let description = '';

            // Qui êtes-vous
            if (who || profession || passions) {
                description += 'Salut ! ';
                
                if (who) {
                    description += `Nous sommes ${who}`;
                    if (profession) description += `, ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (profession) {
                    description += `Je suis ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (passions) {
                    description += `Nous sommes ${passions}`;
                }
                
                description += '. ';
            }

            // Motivation
            if (motivation) {
                description += `${motivation} `;
                if (!motivation.endsWith('.')) description += '. ';
            }

            // Quartier/ville
            if (location || neighborhood) {
                if (location) {
                    description += `Notre logement se trouve ${location}`;
                    if (neighborhood) description += `, ${neighborhood}`;
                } else if (neighborhood) {
                    description += `Notre quartier : ${neighborhood}`;
                }
                description += '. ';
            }

            // Ce que vous offrez
            if (offer) {
                description += `${offer} `;
                if (!offer.endsWith('.')) description += '. ';
            }

            // Ce que vous recherchez
            if (looking) {
                description += `${looking}`;
                if (!looking.endsWith('.')) description += '.';
            }

            modal.querySelector('#description-preview').textContent = description || 'Remplissez les sections pour voir l\'aperçu...';
        }

        function useDescriptionText() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#description-preview').textContent;
            
            if (description && description !== 'Remplissez les sections pour voir l\'aperçu...') {
                document.getElementById('experience-description').value = description;
                showNotification('✅ Description d\'expérience ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins une section', 'warning');
            }
        }

        function showAnnouncementExamples() {
            const examples = [
                '<strong>🏖️ Exemple 1 - Échange Paris ↔ Barcelone</strong><br><br>' +
                '"Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens passionnés d\'architecture et de gastronomie. Nous rêvons de découvrir l\'effervescence barcelonaise, ses marchés colorés et l\'œuvre de Gaudí.<br><br>' +
                'Notre appartement se trouve dans le 11ème arrondissement, quartier branché avec de nombreux bars et restaurants. Nous adorons partager nos bonnes adresses !<br><br>' +
                'Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange d\'une semaine en avril ou mai 2024."',
                '',
                '<strong>💻 Exemple 2 - Échange Lyon ↔ Lisbonne</strong><br><br>' +
                '"Hello ! Je suis Alex, développeur en télétravail de 28 ans. Après 2 ans de remote, j\'ai envie de changer d\'air tout en gardant ma routine de travail. Lisbonne m\'attire pour son climat, ses couleurs et sa scène tech dynamique.<br><br>' +
                'Mon studio lyonnais est parfait pour le télétravail : fibre, bureau ergonomique, quartier calme près du Rhône. Je peux partager tous mes spots favoris pour le sport et les sorties !<br><br>' +
                'Je cherche quelqu\'un dans le même état d\'esprit, qui télétravaille et veut découvrir Lyon. Flexible sur la durée (2 semaines à 2 mois)."',
                '',
                '<strong>🎨 Exemple 3 - Échange Marseille ↔ Florence</strong><br><br>' +
                '"Ciao ! Nous sommes une famille de 4 (parents + 2 ados) passionnée d\'art et d\'histoire. Florence est un rêve pour nous : les Offices, le Ponte Vecchio, l\'artisanat local...<br><br>' +
                'Notre maison marseillaise offre une vue mer, proche des calanques et du centre-ville. Les enfants connaissent tous les bons plans jeunes de la ville !<br><br>' +
                'Nous recherchons une famille ou un couple, pour 10-15 jours cet été. Nous sommes très soigneux et respectueux."'
            ];
            
            showModal('📝 Exemples d\'annonces inspirantes', examples.join('<br><br>'));
        }

        function showModal(title, content) {
            // Créer le modal
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">${title}</h3>
                    <div class="text-sm text-gray-700 leading-relaxed">${content}</div>
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function editProfile() {
            // Fermer le modal de succès
            document.getElementById('success-modal').classList.remove('show');
            
            // Retourner à l'étape 1
            currentStep = 1;
            showStep(currentStep);
            updateProgress();
            
            showNotification('✏️ Vous pouvez maintenant modifier votre profil', 'info');
        }

        function testZapier() {
            console.log('🧪 DÉBUT DU TEST ZAPIER COMPLET');
            showNotification('🧪 Lancement du test Zapier avec TOUS les champs (nouveaux inclus)...', 'info');
            
            // Données de test COMPLÈTES avec TOUS les champs, y compris les nouveaux
            const testData = {
                // === MÉTADONNÉES ===
                timestamp: new Date().toISOString(),
                createdAt: new Date().toISOString(),
                profileComplete: true,
                source: "web_form_test_complet",
                formVersion: "v2.2",
                profileScore: 98,
                
                // === ÉTAPE 1 - APPARTEMENT ===
                // Localisation
                country: "FR",
                region: "Île-de-France", 
                city: "Paris",
                postalCode: "75011",
                locationFull: "Paris, 75011, Île-de-France, France",
                
                // Caractéristiques logement
                bedrooms: "2",
                sleepingSpots: "4", 
                surface: "65",
                housingType: "apartment",
                housingDescription: "Appartement lumineux avec balcon, quartier République, proche métro",
                
                // Équipements (booléens individuels + liste)
                equipment: ["wifi", "workspace", "kitchen", "washing-machine", "balcony", "pets-accepted"],
                hasWifi: true,
                hasWorkspace: true,
                hasKitchen: true,
                hasWashingMachine: true,
                hasBalcony: true,
                hasParking: false,
                petsAccepted: true,
                otherEquipment: "Climatisation, lave-vaisselle, piano",
                equipmentCount: 6,
                
                // Obligations pour le swapper (NOUVEAUX CHAMPS - sans nettoyage)
                obligations: ["pet-care", "plant-care"],
                obligationPetCare: true,
                obligationPlantCare: true,
                obligationMailCollection: false,
                otherObligations: "Nourrir le chat 2x/jour (matin et soir), arroser les orchidées le dimanche uniquement",
                obligationCount: 2,
                
                // === ÉTAPE 2 - STYLE D'ÉCHANGE ===
                // Style d'échange
                exchangeStyle: "both",
                delayedDate1Start: "2024-07-15",
                delayedDate1End: "2024-07-30",
                delayedDate2Start: "2024-09-01", 
                delayedDate2End: "2024-09-15",
                delayedDate3Start: "2024-12-20",
                delayedDate3End: "2024-12-31",
                delayedDateRangeCount: 3,
                
                // Voyage
                travelWith: "couple",
                colocataireCount: null,
                otherTravelDetails: null,
                
                // Animaux
                hasPet: "yes",
                petType: "dog",
                petDescription: "Golden Retriever de 3 ans, très calme et sociable",
                travelWithPet: "no",
                
                // Profil swapper idéal (NOUVEAUX CHAMPS ASSISTANTS)
                idealSwapperDescription: "Je recherche un couple respectueux, calme, communicatif et soigneux. Idéalement avec des centres d'intérêt comme : art, cuisine, voyages, architecture. Critères importants : non-fumeur, soigneux, expérience en échange de logements.",
                agePreferences: ["26-35", "36-50"],
                agePreference18_25: false,
                agePreference26_35: true,
                agePreference36_50: true,
                agePreference50Plus: false,
                flexibilityPreferences: ["dates-flexible", "duration-flexible", "destination-flexible"],
                flexibilityDates: true,
                flexibilityDuration: true,
                flexibilityDestination: true,
                flexibilityExchangeType: false,
                
                // === ÉTAPE 3 - EXPÉRIENCE ===
                // Destination
                mainDestination: "Barcelone (Espagne)",
                destinationSummary: "Barcelone + alternatives Sud Espagne/Portugal + type soleil",
                
                // Options flexibles (NOUVEAUX CHAMPS)
                flexibleOptions: {
                    region: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                    cities: ["Madrid", "Séville", "Porto", "Lisbonne", "Valence"],
                    destinationType: "sunny"
                },
                flexibleRegion: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                flexibleCity1: "Madrid",
                flexibleCity2: "Séville", 
                flexibleCity3: "Porto",
                flexibleCity4: "Lisbonne",
                flexibleCity5: "Valence",
                flexibleDestinationType: "sunny",
                hasFlexibleOptions: true,
                flexibleOptionsCount: 3,
                
                // Dates de voyage
                dateRanges: [
                    { start: "2024-06-15", end: "2024-06-29" },
                    { start: "2024-07-20", end: "2024-08-03" },
                    { start: "2024-09-10", end: "2024-09-24" }
                ],
                travelDate1Start: "2024-06-15",
                travelDate1End: "2024-06-29",
                travelDate2Start: "2024-07-20",
                travelDate2End: "2024-08-03",
                travelDate3Start: "2024-09-10",
                travelDate3End: "2024-09-24",
                flexibleDuration: "2weeks",
                flexiblePeriod: "été 2024 ou début automne",
                dateRangeCount: 3,
                
                // Expérience (NOUVEAUX CHAMPS ASSISTANTS)
                experienceTitle: "2 semaines de découverte culturelle depuis Paris - Échange Paris ↔ Barcelone en couple",
                experienceDescription: "Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens, développeur et architecte, passionnés d'architecture et de gastronomie. Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí. Notre appartement se trouve 11ème arrondissement, quartier branché avec de nombreux bars et restaurants, proche du métro République. Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground. Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024.",
                experienceType: "cultural",
                generatedWithAssistant: true,
                
                // === ÉTAPE 4 - PROFIL PERSONNEL ===
                // Profil personnel
                firstName: "Marie",
                lastName: "Dupont",
                fullName: "Marie Dupont",
                email: "marie.dupont.test@example.com",
                phone: "+33 6 12 34 56 78",
                age: "29",
                vieCompany: "Airbus",
                
                // Motivations (NOUVEAUX CHAMPS)
                reasons: ["change-air", "culture"],
                reasonChangeAir: true,
                reasonCulture: true,
                reasonBreak: false,
                reasonFamily: false,
                reasonClimate: false,
                otherReason: "Améliorer notre espagnol et découvrir l'architecture catalane en immersion",
                motivationCount: 2,
                
                // Style et infos
                stayStyle: "immersive",
                smoker: "no",
                remoteWork: "yes",
                
                // === PHOTOS (seront demandées plus tard) ===
                hasApartmentPhotos: false,
                apartmentPhotosCount: 0,
                hasProfilePhoto: false,
                photosRequestedLater: true,
                
                // === NOUVEAUX CHAMPS ASSISTANTS ===
                // Assistant Swapper utilisé
                swapperAssistantUsed: true,
                swapperType: "couple",
                swapperQualities: ["respectful", "calm", "communicative", "clean"],
                swapperInterests: "art, cuisine, voyages, architecture",
                swapperSpecialCriteria: "non-fumeur, soigneux, expérience en échange de logements",
                
                // Assistant Titre utilisé
                titleAssistantUsed: true,
                titleOrigin: "Paris",
                titleDuration: "2-weeks",
                titleExperienceType: "cultural",
                titleTravelGroup: "couple",
                
                // Assistant Description utilisé
                descriptionAssistantUsed: true,
                descriptionWho: "Marie et Thomas, couple de trentenaires parisiens",
                descriptionProfession: "développeur et architecte",
                descriptionPassions: "passionnés d'architecture et de gastronomie",
                descriptionMotivation: "Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí",
                descriptionLocation: "11ème arrondissement, quartier branché",
                descriptionNeighborhood: "avec de nombreux bars et restaurants, proche du métro République",
                descriptionOffer: "Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground",
                descriptionLooking: "Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024",
                
                // === STATISTIQUES ET QUALITÉ ===
                formCompletionTime: "12 minutes",
                assistantsUsedCount: 3,
                fieldsCompletedCount: 45,
                optionalFieldsCompletedCount: 12,
                qualityScore: 98,
                readinessScore: 95,
                
                // === CHAMPS TECHNIQUES ===
                userAgent: navigator.userAgent,
                screenResolution: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                
                // === VALIDATION ===
                allRequiredFieldsCompleted: true,
                validationErrors: [],
                validationWarnings: ["Photos seront demandées dans un second temps"],
                
                // === POUR ZAPIER/NOTION ===
                notionPageTitle: "Marie Dupont - Paris ↔ Barcelone - Couple Culture",
                notionTags: ["Paris", "Barcelone", "Couple", "Culture", "Télétravail", "Été 2024"],
                zapierProcessed: false,
                zapierTimestamp: null
            };
            
            console.log('📦 DONNÉES DE TEST ULTRA-COMPLÈTES générées:', testData);
            console.log('📊 Nombre total de champs:', Object.keys(testData).length);
            console.log('🆕 Nouveaux champs inclus: obligations sans nettoyage, assistants IA, options flexibles, métadonnées');
            
            // Envoyer à Zapier
            sendToZapier(testData);
        }

        function selectDestinationCity(cityName) {
            // Remplir le champ destination principale
            document.getElementById('main-destination').value = cityName;
            
            // Animation de confirmation
            const destinationInput = document.getElementById('main-destination');
            destinationInput.style.borderColor = '#10b981';
            destinationInput.style.backgroundColor = '#f0fdf4';
            
            setTimeout(() => {
                destinationInput.style.borderColor = '';
                destinationInput.style.backgroundColor = '';
            }, 2000);
            
            // Fermer le modal
            const modal = document.querySelector('.modal.show');
            if (modal) {
                closeModal(modal.querySelector('button'));
            }
            

        }

        function closeModal(button) {
            const modal = button.closest('.modal');
            modal.classList.remove('show');
            setTimeout(() => {
                if (modal.parentNode) {
                    modal.parentNode.removeChild(modal);
                }
            }, 300);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ba10e946173b1',t:'MTc2MTY2NzA0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer mon profil &SWAPP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #f8fafc 100%);
            min-height: 100%;
        }
        
        html, body {
            height: 100%;
        }
        
        :root {
            --green-dark: #2E5941;
            --green-light: #A5C1AA;
            --yellow: #FFCC00;
            --yellow-hover: #e6b800;
        }
        
        .form-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .step-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(46, 89, 65, 0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .step-header {
            background: linear-gradient(135deg, var(--green-dark) 0%, #3a6b4f 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .step-content {
            padding: 2rem;
        }
        
        .selection-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .selection-card:hover {
            border-color: #d1d5db;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .selection-card.selected {
            border-color: var(--green-dark);
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
            box-shadow: 0 8px 25px rgba(46, 89, 65, 0.12);
            transform: translateY(-2px);
        }
        
        .selection-card.selected::after {
            content: '✓';
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--green-dark);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .input-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .textarea-field {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            font-size: 16px;
            width: 100%;
            min-height: 120px;
            resize: vertical;
        }
        
        .textarea-field:focus {
            outline: none;
            border-color: var(--green-dark);
            box-shadow: 0 0 0 4px rgba(46, 89, 65, 0.1);
        }
        
        .btn-primary {
            background: var(--yellow);
            color: var(--green-dark);
            border: none;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.3);
            font-size: 16px;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: var(--yellow-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: white;
            color: var(--green-dark);
            border: 2px solid var(--green-light);
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-secondary:hover {
            border-color: var(--green-dark);
            background: #f0f9f2;
            transform: translateY(-1px);
        }
        
        .btn-skip {
            background: #f8fafc;
            color: #64748b;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-skip:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        
        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--yellow) 0%, #ffd700 100%);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e5e7eb;
            margin: 0 6px;
            transition: all 0.3s ease;
        }
        
        .step-dot.active {
            background: var(--yellow);
            transform: scale(1.2);
        }
        
        .step-dot.completed {
            background: var(--green-dark);
        }
        
        .required::after {
            content: ' *';
            color: #ef4444;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }
        
        .modal.show .modal-content {
            transform: scale(1);
        }
        
        .emoji-large {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .date-range {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option {
            background: #f0f9ff;
            border: 2px solid #bae6fd;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .flexible-option.selected {
            border-color: var(--green-dark);
            background: #f0fdf4;
        }
        
        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .priority-1 {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .priority-2 {
            background: #fef3c7;
            color: #d97706;
        }
        
        .priority-3 {
            background: #f0f9ff;
            color: #2563eb;
        }

        .copy-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 0.5rem;
        }
        
        .copy-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }
        
        .copy-button.copied {
            background: #dcfce7;
            border-color: #16a34a;
            color: #16a34a;
        }

        .city-vignette {
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .city-vignette:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        
        .city-vignette:active {
            transform: translateY(0);
        }

        .assistant-modal .modal-content {
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            text-align: left;
        }

        .assistant-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .assistant-preview {
            background: #f0fdf4;
            border: 2px solid #bbf7d0;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 100px;
        }

        .quality-tag {
            display: inline-block;
            background: #e0f2fe;
            border: 1px solid #0891b2;
            border-radius: 20px;
            padding: 0.25rem 0.75rem;
            margin: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quality-tag.selected {
            background: var(--green-dark);
            color: white;
            border-color: var(--green-dark);
        }

        .quality-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .city-suggestion {
            padding: 0.75rem;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s ease;
        }

        .city-suggestion:hover {
            background-color: #f8fafc;
        }

        .city-suggestion:last-child {
            border-bottom: none;
        }

        .city-suggestion.highlighted {
            background-color: #f0f9ff;
            border-left: 3px solid var(--green-dark);
        }

        .city-suggestion-name {
            font-weight: 600;
            color: var(--green-dark);
        }

        .city-suggestion-details {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .form-container {
                padding: 1rem;
            }
            
            .step-card {
                border-radius: 16px;
            }
            
            .step-content {
                padding: 1.5rem;
            }

            .assistant-modal .modal-content {
                max-width: 95%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="min-h-full">
        <!-- Header -->
        <div class="bg-white border-b border-gray-100 sticky top-0 z-40">
            <div class="form-container py-4 px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="text-2xl font-bold text-green-800">&SWAPP</div>
                        <div class="ml-4 text-gray-600">
                            <span class="text-sm">✨ Création de profil</span>
                        </div>
                    </div>
                    <div class="text-sm text-gray-500">
                        Étape <span id="current-step">1</span> sur 4
                    </div>
                </div>
            </div>
        </div>

        <div class="form-container py-8 px-4">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                </div>
                <div class="step-indicator mt-4">
                    <div class="step-dot active" data-step="1"></div>
                    <div class="step-dot" data-step="2"></div>
                    <div class="step-dot" data-step="3"></div>
                    <div class="step-dot" data-step="4"></div>
                </div>
            </div>

            <!-- Étape 1: Info sur mon appartement -->
            <div class="step-card" id="step-1">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 1</div>
                    <div class="emoji-large">🏡</div>
                    <h2 class="text-2xl font-bold mb-2">Info sur mon appartement</h2>
                    <p class="text-green-100">Présentez votre logement aux futurs swappers</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <!-- Localisation -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📍 Localisation</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="country" class="block text-sm font-medium text-gray-700 mb-2 required">Pays</label>
                                    <select id="country" class="input-field" required>
                                        <option value="">Sélectionner un pays</option>
                                        <option value="FR">France</option>
                                        <option value="ES">Espagne</option>
                                        <option value="IT">Italie</option>
                                        <option value="DE">Allemagne</option>
                                        <option value="UK">Royaume-Uni</option>
                                        <option value="US">États-Unis</option>
                                        <option value="CA">Canada</option>
                                        <option value="PT">Portugal</option>
                                        <option value="BE">Belgique</option>
                                        <option value="CH">Suisse</option>
                                        <option value="NL">Pays-Bas</option>
                                        <option value="other">Autre</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="region" class="block text-sm font-medium text-gray-700 mb-2 required">Région / État / Département</label>
                                    <input type="text" id="region" class="input-field" placeholder="Ex: Île-de-France, Californie, Toscane..." required>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="city" class="block text-sm font-medium text-gray-700 mb-2 required">Ville</label>
                                        <div class="relative">
                                            <input type="text" id="city" class="input-field" placeholder="Ex: Paris, Lyon, Marseille..." required autocomplete="off">
                                            <div id="city-suggestions" class="absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg hidden max-h-60 overflow-y-auto"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="postal-code" class="block text-sm font-medium text-gray-700 mb-2 required">Code postal</label>
                                        <input type="text" id="postal-code" class="input-field" placeholder="Ex: 75001" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Caractéristiques -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🏘️ Caractéristiques</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de chambres</label>
                                    <select id="bedrooms" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="0">Studio</option>
                                        <option value="1">1 chambre</option>
                                        <option value="2">2 chambres</option>
                                        <option value="3">3 chambres</option>
                                        <option value="4">4 chambres</option>
                                        <option value="5+">5+ chambres</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nombre de couchages</label>
                                    <select id="sleeping-spots" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="1">1 personne</option>
                                        <option value="2">2 personnes</option>
                                        <option value="4">4 personnes</option>
                                        <option value="6">6 personnes</option>
                                        <option value="8+">8+ personnes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Superficie (m²)</label>
                                    <input type="number" id="surface" class="input-field" placeholder="Ex: 65">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Type de logement</label>
                                    <select id="housing-type" class="input-field" required>
                                        <option value="">Sélectionner</option>
                                        <option value="apartment">Appartement</option>
                                        <option value="house">Maison</option>
                                        <option value="room">Chambre</option>
                                        <option value="shared">Colocation complète</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Équipements -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">⚙️ Équipements essentiels</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="wifi">
                                    <span class="text-sm">📶 Wifi</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="workspace">
                                    <span class="text-sm">💻 Espace de travail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="kitchen">
                                    <span class="text-sm">🍳 Cuisine équipée</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="washing-machine">
                                    <span class="text-sm">🧺 Machine à laver</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="balcony">
                                    <span class="text-sm">🌿 Balcon / terrasse</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="parking">
                                    <span class="text-sm">🚗 Parking</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" class="equipment-checkbox" value="pets-accepted">
                                    <span class="text-sm">🐾 Animaux acceptés</span>
                                </label>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Autre équipement</label>
                                <input type="text" id="other-equipment" class="input-field" placeholder="Ex: piscine, jardin, climatisation...">
                            </div>
                        </div>

                        <!-- Obligations pour le swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📋 Obligations pour la personne qui vient chez moi (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez ce que vous attendez de votre swapper pendant son séjour</p>
                            
                            <div class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="pet-care">
                                        <span class="text-sm">🐾 Garder mon animal</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="plant-care">
                                        <span class="text-sm">🌱 Arroser mes plantes</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="obligation-checkbox" value="mail-collection">
                                        <span class="text-sm">📬 Relever le courrier</span>
                                    </label>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autres obligations ou instructions</label>
                                    <textarea id="other-obligations" class="textarea-field" placeholder="Ex: nourrir le chat 2x/jour, arroser les orchidées le dimanche, ne pas utiliser la machine à laver après 22h..." style="min-height: 80px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Photos -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📷 Photos de mon logement</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">📸</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photos demandées dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter vos photos après la création du profil pour optimiser vos chances de match !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Préparez 5-8 photos de qualité de votre logement (salon, chambre, cuisine, salle de bain, extérieur si applicable)</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between">
                            <div></div>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 2: Mon style d'échange et avec qui je veux échanger -->
            <div class="step-card hidden" id="step-2">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 2</div>
                    <div class="emoji-large">🔄</div>
                    <h2 class="text-2xl font-bold mb-2">Mon style d'échange et avec qui je veux échanger</h2>
                    <p class="text-green-100">Définissez vos préférences d'échange</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Style d'échange -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🔁 Mon style d'échange</h3>
                            <div class="space-y-4">
                                <div class="selection-card" data-exchange-style="reciprocal">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🔄</div>
                                        <div>
                                            <h4 class="font-semibold">Échange réciproque</h4>
                                            <p class="text-sm text-gray-600">Chacun séjourne chez l'autre aux mêmes dates</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="delayed">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⏳</div>
                                        <div>
                                            <h4 class="font-semibold">Échange décalé (non simultané)</h4>
                                            <p class="text-sm text-gray-600">Tu accueilles pendant ton absence, et séjournes plus tard chez l'autre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-exchange-style="both">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">⚖️</div>
                                        <div>
                                            <h4 class="font-semibold">Ouvert aux deux</h4>
                                            <p class="text-sm text-gray-600">Flexible selon les opportunités</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="delayed-dates">
                                <h4 class="font-semibold text-gray-700 mb-2">Dates où mon logement sera libre pour accueillir quelqu'un = je ne serais pas chez moi</h4>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <p class="text-sm text-blue-700 mb-3">📅 Sélectionnez les périodes où votre logement sera disponible</p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                                            <input type="date" class="input-field">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                                            <input type="date" class="input-field">
                                        </div>
                                    </div>
                                    <button type="button" class="btn-secondary mt-3" onclick="addDelayedDateRange()">➕ Ajouter une autre période</button>
                                </div>
                            </div>
                        </div>

                        <!-- Avec qui je voyage -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👥 Avec qui je voyage</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="selection-card" data-travel-with="alone">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👤</div>
                                        <div>
                                            <h4 class="font-semibold">Seul(e)</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="couple">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">💑</div>
                                        <div>
                                            <h4 class="font-semibold">En couple</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="colocation">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">🏘️</div>
                                        <div>
                                            <h4 class="font-semibold">En colocation</h4>
                                            <p class="text-sm text-gray-600">Préciser le nombre</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="family">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">👪</div>
                                        <div>
                                            <h4 class="font-semibold">En famille</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="selection-card" data-travel-with="other">
                                    <div class="flex items-center">
                                        <div class="text-2xl mr-4">✨</div>
                                        <div>
                                            <h4 class="font-semibold">Autre</h4>
                                            <p class="text-sm text-gray-600">À préciser</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 hidden" id="colocation-details">
                                <input type="number" class="input-field" placeholder="Nombre de colocataires" min="1" max="10">
                            </div>
                            <div class="mt-4 hidden" id="other-details">
                                <textarea class="textarea-field" placeholder="Précisez avec qui vous voyagez..."></textarea>
                            </div>
                        </div>

                        <!-- Animaux -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🐾 Animaux</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">As-tu un animal ?</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="has-pet" value="no" class="mr-2" required>
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="hidden" id="pet-details">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Type d'animal</label>
                                            <select class="input-field">
                                                <option value="">Sélectionner</option>
                                                <option value="dog">Chien</option>
                                                <option value="cat">Chat</option>
                                                <option value="other">Autre</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                            <textarea class="textarea-field" placeholder="Ex: petit chien calme, gros chat indépendant..."></textarea>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Voyages-tu avec ton animal ?</label>
                                            <div class="flex gap-4">
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="yes" class="mr-2">
                                                    <span>Oui</span>
                                                </label>
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="radio" name="travel-with-pet" value="no" class="mr-2">
                                                    <span>Non</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Profil idéal swapper -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">👤 Profil idéal de mon swapper (facultatif)</h3>
                            <p class="text-sm text-gray-600 mb-4">💡 Précisez le type de personne avec qui vous aimeriez échanger</p>
                            
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700">Description libre</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showSwapperAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="ideal-swapper-description" class="textarea-field" placeholder="Ex: Personne calme et respectueuse, amateur de culture, jeune professionnel, famille avec enfants..."></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Tranche d'âge souhaitée</label>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="18-25">
                                            <span class="text-sm">18-25 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="26-35">
                                            <span class="text-sm">26-35 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="36-50">
                                            <span class="text-sm">36-50 ans</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="age-preference" value="50+">
                                            <span class="text-sm">50+ ans</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">Flexibilité recherchée</label>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="dates-flexible">
                                            <span class="text-sm">🗓️ Flexible sur les dates</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="duration-flexible">
                                            <span class="text-sm">⏰ Flexible sur la durée</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="destination-flexible">
                                            <span class="text-sm">📍 Flexible sur la destination</span>
                                        </label>
                                        <label class="flex items-center space-x-2 cursor-pointer">
                                            <input type="checkbox" class="flexibility-preference" value="exchange-type-flexible">
                                            <span class="text-sm">🔄 Flexible sur le type d'échange</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 3: Création de mon expérience -->
            <div class="step-card hidden" id="step-3">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 3</div>
                    <div class="emoji-large">✨</div>
                    <h2 class="text-2xl font-bold mb-2">Création de mon expérience</h2>
                    <p class="text-green-100">Créons votre annonce d'échange attractive</p>
                </div>
                <div class="step-content">
                    <div class="space-y-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="flex items-center mb-2">
                                <div class="text-2xl mr-3">💡</div>
                                <h4 class="font-semibold text-blue-800">Qu'est-ce qu'une expérience &SWAPP ?</h4>
                            </div>
                            <p class="text-sm text-blue-700">
                                Une expérience, c'est votre annonce d'échange ! Elle contient votre destination souhaitée, vos dates, 
                                un titre accrocheur et une description qui donne envie. Plus elle est détaillée et inspirante, 
                                plus vous aurez de chances de trouver le swapper parfait ! 🚀
                            </p>
                        </div>

                        <!-- Destination -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🌍 Où je veux partir</h3>
                            <div>
                                <label for="main-destination" class="block text-sm font-medium text-gray-700 mb-2 required">Ville principale souhaitée</label>
                                <div class="relative">
                                    <input type="text" id="main-destination" class="input-field pr-20" placeholder="Ex: Lisbonne, Tokyo, New York..." required>
                                    <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-2xl hover:scale-110 transition-transform" onclick="surpriseMe()" title="Surprends-moi !">
                                        🎲
                                    </button>
                                </div>
                                <div class="mt-2 flex flex-wrap gap-2">
                                    <button type="button" class="btn-skip text-xs" onclick="showAvailableCities()">
                                        📍 Voir les villes disponibles
                                    </button>
                                    <button type="button" class="btn-skip text-xs" onclick="showExperienceExamples()">
                                        ✨ Voir des exemples d'expériences
                                    </button>
                                </div>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Options flexibles (facultatif - sélection multiple possible)</h4>
                                <p class="text-sm text-gray-600 mb-4">💡 Ajouter des options flexibles augmente vos chances de match !</p>
                                
                                <!-- Option région -->
                                <div class="flexible-option mb-3" data-flexible-type="region">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="region">
                                        <div>
                                            <h5 class="font-semibold">🌍 Région / zone géographique</h5>
                                            <p class="text-sm text-gray-600">Ex: Sud de la France, Ouest canadien, à moins de 3h de vol de Washington</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="region-input">
                                        <input type="text" class="input-field" placeholder="Décrivez la région souhaitée...">
                                    </div>
                                </div>

                                <!-- Option villes multiples -->
                                <div class="flexible-option mb-3" data-flexible-type="cities">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="cities">
                                        <div>
                                            <h5 class="font-semibold">📍 Liste de 3 à 5 autres villes</h5>
                                            <p class="text-sm text-gray-600">Ex: Barcelone, Rome, Porto, Séville, Madrid</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="cities-input">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                            <input type="text" class="input-field" placeholder="Ville 1">
                                            <input type="text" class="input-field" placeholder="Ville 2">
                                            <input type="text" class="input-field" placeholder="Ville 3">
                                            <input type="text" class="input-field" placeholder="Ville 4 (optionnel)">
                                            <input type="text" class="input-field" placeholder="Ville 5 (optionnel)">
                                        </div>
                                    </div>
                                </div>

                                <!-- Option type de destination -->
                                <div class="flexible-option" data-flexible-type="destination-type">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="flexible-checkbox mr-3" value="destination-type">
                                        <div>
                                            <h5 class="font-semibold">☀️ Type de destination</h5>
                                            <p class="text-sm text-gray-600">Ex: au soleil, en montagne, dans une capitale, ville culturelle</p>
                                        </div>
                                    </label>
                                    <div class="mt-3 hidden" id="destination-type-input">
                                        <select class="input-field">
                                            <option value="">Choisir un type</option>
                                            <option value="sunny">Au soleil</option>
                                            <option value="mountain">En montagne</option>
                                            <option value="capital">Dans une capitale</option>
                                            <option value="cultural">Ville culturelle</option>
                                            <option value="seaside">Bord de mer</option>
                                            <option value="countryside">À la campagne</option>
                                            <option value="historic">Ville historique</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dates -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">🗓️ Quand je veux partir</h3>
                            <div>
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Dates souhaitées</h4>
                                <div id="date-ranges">
                                    <div class="date-range">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                                                <input type="date" class="input-field date-start" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                                                <input type="date" class="input-field date-end" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary mt-3" onclick="addDateRange()">
                                    ➕ Ajouter une autre plage de dates
                                </button>
                            </div>

                            <div class="mt-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">Période ou durée flexible (facultatif)</h4>
                                <p class="text-sm text-gray-600 mb-4">🪄 Indiquer une période souple augmente les chances de match</p>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Durée souhaitée</label>
                                        <select class="input-field" id="flexible-duration">
                                            <option value="">Sélectionner une durée</option>
                                            <option value="weekend">Un week-end</option>
                                            <option value="week">Une semaine</option>
                                            <option value="2weeks">Deux semaines</option>
                                            <option value="month">Un mois</option>
                                            <option value="2months">Deux mois</option>
                                            <option value="3months">Plus de 3 mois</option>
                                            <option value="flexible">Flexible</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Période générale</label>
                                        <input type="text" id="flexible-period" class="input-field" placeholder="Ex: été 2024, automne, décembre 2025...">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Titre et description -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">📝 Mon annonce</h3>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Titre de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showTitleAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <input type="text" id="experience-title" class="input-field" placeholder="Ex: Échange Paris ↔ Lisbonne - Découverte culturelle en couple" required>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Mentionnez votre ville, la destination et le type d'expérience</p>
                                </div>
                                
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700 required">Description de mon expérience</label>
                                        <button type="button" class="text-blue-500 hover:text-blue-700 text-sm flex items-center" onclick="showDescriptionAssistant()" title="Assistant d'écriture">
                                            ✨ Assistant
                                        </button>
                                    </div>
                                    <textarea id="experience-description" class="textarea-field" placeholder="Décrivez votre projet d'échange, ce que vous recherchez, vos motivations, ce que vous pouvez offrir... Plus c'est détaillé et personnel, mieux c'est !" required style="min-height: 150px;"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">💡 Conseil: Parlez de vos motivations, de votre quartier, de ce que vous aimez faire, de vos recommandations locales...</p>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-center">
                                <button type="button" class="btn-skip text-xs" onclick="showAnnouncementExamples()">
                                    📝 Voir des exemples d'annonces inspirantes
                                </button>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="nextStep()">
                                Continuer →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Étape 4: Les infos sur moi -->
            <div class="step-card hidden" id="step-4">
                <div class="step-header">
                    <div class="priority-badge priority-1">ÉTAPE 4</div>
                    <div class="emoji-large">👤</div>
                    <h2 class="text-2xl font-bold mb-2">Les infos sur moi</h2>
                    <p class="text-green-100">Finalisez votre profil personnel</p>
                </div>
                <div class="step-content">
                    <div class="space-y-8">
                        <!-- Profil utilisateur -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4 required">👤 Mes informations personnelles</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Prénom</label>
                                    <input type="text" id="first-name" class="input-field" placeholder="Marie" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Nom</label>
                                    <input type="text" id="last-name" class="input-field" placeholder="Dupont" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Email</label>
                                    <input type="email" id="email" class="input-field" placeholder="marie@example.com" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Téléphone (WhatsApp)</label>
                                    <input type="tel" id="phone" class="input-field" placeholder="+33 6 12 34 56 78">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2 required">Âge</label>
                                    <input type="number" id="age" class="input-field" placeholder="28" min="18" max="99" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Société V.I.E (facultatif)</label>
                                    <input type="text" id="vie-company" class="input-field" placeholder="Ex: Airbus, Total, BNP Paribas...">
                                </div>
                            </div>
                        </div>

                        <!-- Style de séjour et motivations -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">💫 Mon style et mes motivations</h3>
                            
                            <!-- Pourquoi j'échange -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">💭 Pourquoi j'échange (2 choix max)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="change-air">
                                        <span class="text-sm">🌬️ Changer d'air / télétravailler ailleurs</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="culture">
                                        <span class="text-sm">🌍 Découvrir une autre culture</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="break">
                                        <span class="text-sm">😌 Faire une pause / un break</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="family">
                                        <span class="text-sm">👨‍👩‍👧‍👦 Rejoindre des proches</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="checkbox" class="reason-checkbox" value="climate">
                                        <span class="text-sm">☀️ Profiter d'un climat différent</span>
                                    </label>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Autre raison</label>
                                    <input type="text" id="other-reason" class="input-field" placeholder="Précisez votre motivation...">
                                </div>
                            </div>

                            <!-- Style de séjour -->
                            <div class="mb-6">
                                <h4 class="text-md font-semibold text-gray-700 mb-3">🌈 Mon style de séjour (1 choix max)</h4>
                                <div class="space-y-3">
                                    <div class="selection-card" data-stay-style="calm">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🧘</div>
                                            <div>
                                                <h5 class="font-semibold">Calme & reposant</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="dynamic">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🎉</div>
                                            <div>
                                                <h5 class="font-semibold">Dynamique & festif</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="immersive">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🏛️</div>
                                            <div>
                                                <h5 class="font-semibold">Immersif & local</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="work">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">💻</div>
                                            <div>
                                                <h5 class="font-semibold">Télétravail & routine</h5>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selection-card" data-stay-style="nature">
                                        <div class="flex items-center">
                                            <div class="text-2xl mr-4">🌲</div>
                                            <div>
                                                <h5 class="font-semibold">Nature & extérieur</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ce qu'il faut savoir sur moi -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">🔑 Ce qu'il faut savoir sur moi</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Fumeur</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="smoker" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Télétravail</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="yes" class="mr-2">
                                            <span>Oui</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="remote-work" value="no" class="mr-2">
                                            <span>Non</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Photo de profil -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">📸 Ma photo de profil</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-center mb-3">
                                    <div class="text-2xl mr-3">👤</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800">Photo demandée dans un second temps</h4>
                                        <p class="text-sm text-blue-700">Nous vous demanderons d'ajouter votre photo de profil après la création pour humaniser votre profil !</p>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-600">💡 Conseil : Une photo souriante et naturelle inspire confiance et augmente vos chances de match</p>
                            </div>
                        </div>

                        <div class="flex justify-between">
                            <button type="button" class="btn-secondary" onclick="prevStep()">
                                ← Retour
                            </button>
                            <button type="button" class="btn-primary" onclick="completeProfile()">
                                🚀 Finaliser mon profil
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content">
            <div class="emoji-large">🎉</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Félicitations !</h3>
            <p class="text-gray-600 mb-4">✨ Votre profil &SWAPP a été créé avec succès !</p>
            <div id="photo-reminder" class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4 hidden">
                <p class="text-sm text-yellow-800">💡 <strong>Conseil :</strong> Pensez à ajouter des photos de votre logement et une photo de profil dans un second temps pour maximiser vos chances de match !</p>
            </div>
            <p class="text-sm text-gray-500 mb-6">Vous pouvez maintenant découvrir les expériences de la communauté.</p>
            <div class="flex flex-col space-y-3">
                <button class="btn-primary" onclick="window.open('https://andswapp.com', '_blank')">
                    📧 Suivre le projet
                </button>
                <button class="btn-secondary" onclick="editProfile()">
                    ✏️ Modifier mon profil
                </button>
                <button class="btn-skip mt-2" onclick="showFeedbackModal()">
                    💬 Donner mon avis sur le formulaire
                </button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="emoji-large">💬</div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">Votre avis nous intéresse !</h3>
            <p class="text-gray-600 mb-6">Aidez-nous à améliorer ce formulaire en partageant vos suggestions avec Maxime :</p>
            
            <div class="space-y-6">
                <!-- Contact WhatsApp/SMS -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-green-800 flex items-center">
                            📱 WhatsApp / SMS
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('+33647034827', this)" title="Copier le numéro">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-green-700 font-mono text-lg mb-3">+33 6 47 03 48 27</p>
                    <p class="text-sm text-green-600">💬 Contactez Maxime directement sur ce numéro</p>
                </div>

                <!-- Contact Email -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-blue-800 flex items-center">
                            📧 Email
                        </h4>
                        <button class="copy-button" onclick="copyToClipboard('maxime.barret@andswapp.com', this)" title="Copier l'email">
                            📋 Copier
                        </button>
                    </div>
                    <p class="text-blue-700 font-mono text-lg mb-3">maxime.barret@andswapp.com</p>
                    <a href="mailto:maxime.barret@andswapp.com?subject=Feedback%20formulaire%20&SWAPP&body=Salut%20Maxime%20!%0A%0AJ'ai%20testé%20le%20formulaire%20de%20création%20de%20profil%20&SWAPP%20et%20j'aimerais%20partager%20mon%20feedback%20:%0A%0A" 
                       class="btn-secondary w-full inline-block text-center">
                        📧 Envoyer un email
                    </a>
                </div>

                <!-- Suggestions d'amélioration -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">💡 Idées de feedback :</h4>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• Étapes trop longues ou trop courtes ?</li>
                        <li>• Champs manquants ou inutiles ?</li>
                        <li>• Interface confuse ou claire ?</li>
                        <li>• Suggestions d'amélioration ?</li>
                        <li>• Bugs ou problèmes techniques ?</li>
                    </ul>
                </div>
            </div>
            
            <div class="flex space-x-3 mt-6">
                <button class="btn-secondary flex-1" onclick="closeFeedbackModal()">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedTravelWith = null;
        let selectedExchangeStyle = null;
        let selectedStayStyle = null;
        let dateRangeCount = 1;
        let selectedCityIndex = -1;

        // Base de données des villes françaises principales avec régions et codes postaux
        const frenchCities = [
            { name: "Paris", region: "Île-de-France", postalCode: "75001", country: "FR" },
            { name: "Lyon", region: "Auvergne-Rhône-Alpes", postalCode: "69001", country: "FR" },
            { name: "Marseille", region: "Provence-Alpes-Côte d'Azur", postalCode: "13001", country: "FR" },
            { name: "Toulouse", region: "Occitanie", postalCode: "31000", country: "FR" },
            { name: "Nice", region: "Provence-Alpes-Côte d'Azur", postalCode: "06000", country: "FR" },
            { name: "Nantes", region: "Pays de la Loire", postalCode: "44000", country: "FR" },
            { name: "Montpellier", region: "Occitanie", postalCode: "34000", country: "FR" },
            { name: "Strasbourg", region: "Grand Est", postalCode: "67000", country: "FR" },
            { name: "Bordeaux", region: "Nouvelle-Aquitaine", postalCode: "33000", country: "FR" },
            { name: "Lille", region: "Hauts-de-France", postalCode: "59000", country: "FR" },
            { name: "Rennes", region: "Bretagne", postalCode: "35000", country: "FR" },
            { name: "Reims", region: "Grand Est", postalCode: "51100", country: "FR" },
            { name: "Saint-Étienne", region: "Auvergne-Rhône-Alpes", postalCode: "42000", country: "FR" },
            { name: "Toulon", region: "Provence-Alpes-Côte d'Azur", postalCode: "83000", country: "FR" },
            { name: "Le Havre", region: "Normandie", postalCode: "76600", country: "FR" },
            { name: "Grenoble", region: "Auvergne-Rhône-Alpes", postalCode: "38000", country: "FR" },
            { name: "Dijon", region: "Bourgogne-Franche-Comté", postalCode: "21000", country: "FR" },
            { name: "Angers", region: "Pays de la Loire", postalCode: "49000", country: "FR" },
            { name: "Nîmes", region: "Occitanie", postalCode: "30000", country: "FR" },
            { name: "Villeurbanne", region: "Auvergne-Rhône-Alpes", postalCode: "69100", country: "FR" },
            { name: "Clermont-Ferrand", region: "Auvergne-Rhône-Alpes", postalCode: "63000", country: "FR" },
            { name: "Le Mans", region: "Pays de la Loire", postalCode: "72000", country: "FR" },
            { name: "Aix-en-Provence", region: "Provence-Alpes-Côte d'Azur", postalCode: "13100", country: "FR" },
            { name: "Brest", region: "Bretagne", postalCode: "29200", country: "FR" },
            { name: "Tours", region: "Centre-Val de Loire", postalCode: "37000", country: "FR" },
            { name: "Amiens", region: "Hauts-de-France", postalCode: "80000", country: "FR" },
            { name: "Limoges", region: "Nouvelle-Aquitaine", postalCode: "87000", country: "FR" },
            { name: "Annecy", region: "Auvergne-Rhône-Alpes", postalCode: "74000", country: "FR" },
            { name: "Perpignan", region: "Occitanie", postalCode: "66000", country: "FR" },
            { name: "Besançon", region: "Bourgogne-Franche-Comté", postalCode: "25000", country: "FR" },
            { name: "Orléans", region: "Centre-Val de Loire", postalCode: "45000", country: "FR" },
            { name: "Metz", region: "Grand Est", postalCode: "57000", country: "FR" },
            { name: "Rouen", region: "Normandie", postalCode: "76000", country: "FR" },
            { name: "Mulhouse", region: "Grand Est", postalCode: "68100", country: "FR" },
            { name: "Caen", region: "Normandie", postalCode: "14000", country: "FR" },
            { name: "Nancy", region: "Grand Est", postalCode: "54000", country: "FR" }
        ];

        // Villes internationales populaires pour les échanges
        const internationalCities = [
            { name: "Barcelone", region: "Catalogne", postalCode: "08001", country: "ES" },
            { name: "Madrid", region: "Communauté de Madrid", postalCode: "28001", country: "ES" },
            { name: "Lisbonne", region: "Région de Lisbonne", postalCode: "1000", country: "PT" },
            { name: "Rome", region: "Latium", postalCode: "00100", country: "IT" },
            { name: "Milan", region: "Lombardie", postalCode: "20100", country: "IT" },
            { name: "Florence", region: "Toscane", postalCode: "50100", country: "IT" },
            { name: "Berlin", region: "Berlin", postalCode: "10115", country: "DE" },
            { name: "Munich", region: "Bavière", postalCode: "80331", country: "DE" },
            { name: "Amsterdam", region: "Hollande-Septentrionale", postalCode: "1012", country: "NL" },
            { name: "Bruxelles", region: "Région de Bruxelles-Capitale", postalCode: "1000", country: "BE" },
            { name: "Londres", region: "Angleterre", postalCode: "SW1A", country: "UK" },
            { name: "New York", region: "New York", postalCode: "10001", country: "US" },
            { name: "Los Angeles", region: "Californie", postalCode: "90210", country: "US" },
            { name: "Montréal", region: "Québec", postalCode: "H2X", country: "CA" },
            { name: "Toronto", region: "Ontario", postalCode: "M5H", country: "CA" }
        ];

        // Combine toutes les villes
        const allCities = [...frenchCities, ...internationalCities];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            setupEventListeners();
            setupCityAutocomplete();
        });

        function setupEventListeners() {
            // Selection cards
            document.addEventListener('click', function(e) {
                const card = e.target.closest('.selection-card');
                if (card) {
                    const group = card.getAttribute('data-travel-with') || 
                                 card.getAttribute('data-exchange-style') || 
                                 card.getAttribute('data-stay-style');
                    
                    if (card.getAttribute('data-travel-with')) {
                        document.querySelectorAll('[data-travel-with]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedTravelWith = card.getAttribute('data-travel-with');
                        
                        // Show/hide additional inputs
                        document.getElementById('colocation-details').classList.toggle('hidden', selectedTravelWith !== 'colocation');
                        document.getElementById('other-details').classList.toggle('hidden', selectedTravelWith !== 'other');
                    }
                    
                    if (card.getAttribute('data-exchange-style')) {
                        document.querySelectorAll('[data-exchange-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedExchangeStyle = card.getAttribute('data-exchange-style');
                        
                        // Show/hide delayed dates
                        document.getElementById('delayed-dates').classList.toggle('hidden', selectedExchangeStyle !== 'delayed' && selectedExchangeStyle !== 'both');
                    }
                    
                    if (card.getAttribute('data-stay-style')) {
                        document.querySelectorAll('[data-stay-style]').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selectedStayStyle = card.getAttribute('data-stay-style');
                    }
                }
            });

            // Flexible options
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('flexible-checkbox')) {
                    const option = e.target.closest('.flexible-option');
                    const inputDiv = option.querySelector('div[id$="-input"]');
                    
                    if (e.target.checked) {
                        option.classList.add('selected');
                        inputDiv.classList.remove('hidden');
                    } else {
                        option.classList.remove('selected');
                        inputDiv.classList.add('hidden');
                    }
                }
            });

            // Pet details
            document.addEventListener('change', function(e) {
                if (e.target.name === 'has-pet') {
                    document.getElementById('pet-details').classList.toggle('hidden', e.target.value !== 'yes');
                }
            });

            // Photos seront demandées dans un second temps - pas de gestion d'upload ici

            // Reason checkboxes (max 2)
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('reason-checkbox')) {
                    const checked = document.querySelectorAll('.reason-checkbox:checked');
                    if (checked.length > 2) {
                        e.target.checked = false;
                        showNotification('Vous pouvez sélectionner maximum 2 raisons', 'error');
                    }
                }
            });
        }

        function setupCityAutocomplete() {
            const cityInput = document.getElementById('city');
            const suggestionsDiv = document.getElementById('city-suggestions');
            const regionInput = document.getElementById('region');
            const postalCodeInput = document.getElementById('postal-code');
            const countrySelect = document.getElementById('country');

            cityInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();
                selectedCityIndex = -1;

                if (query.length < 2) {
                    hideSuggestions();
                    return;
                }

                const matches = allCities.filter(city => 
                    city.name.toLowerCase().includes(query) ||
                    city.region.toLowerCase().includes(query)
                ).slice(0, 8); // Limite à 8 résultats

                if (matches.length > 0) {
                    showSuggestions(matches);
                } else {
                    hideSuggestions();
                }
            });

            cityInput.addEventListener('keydown', function(e) {
                const suggestions = suggestionsDiv.querySelectorAll('.city-suggestion');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    selectedCityIndex = Math.min(selectedCityIndex + 1, suggestions.length - 1);
                    updateHighlight(suggestions);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    selectedCityIndex = Math.max(selectedCityIndex - 1, -1);
                    updateHighlight(suggestions);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (selectedCityIndex >= 0 && suggestions[selectedCityIndex]) {
                        selectCity(suggestions[selectedCityIndex].dataset.cityIndex);
                    }
                } else if (e.key === 'Escape') {
                    hideSuggestions();
                }
            });

            // Fermer les suggestions en cliquant ailleurs
            document.addEventListener('click', function(e) {
                if (!cityInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                    hideSuggestions();
                }
            });

            function showSuggestions(cities) {
                suggestionsDiv.innerHTML = '';
                
                cities.forEach((city, index) => {
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.className = 'city-suggestion';
                    suggestionDiv.dataset.cityIndex = allCities.indexOf(city);
                    
                    const countryFlag = getCountryFlag(city.country);
                    
                    suggestionDiv.innerHTML = `
                        <div class="city-suggestion-name">${countryFlag} ${city.name}</div>
                        <div class="city-suggestion-details">${city.region} • ${city.postalCode}</div>
                    `;
                    
                    suggestionDiv.addEventListener('click', function() {
                        selectCity(this.dataset.cityIndex);
                    });
                    
                    suggestionsDiv.appendChild(suggestionDiv);
                });
                
                suggestionsDiv.classList.remove('hidden');
            }

            function hideSuggestions() {
                suggestionsDiv.classList.add('hidden');
                selectedCityIndex = -1;
            }

            function updateHighlight(suggestions) {
                suggestions.forEach((suggestion, index) => {
                    suggestion.classList.toggle('highlighted', index === selectedCityIndex);
                });
            }

            function selectCity(cityIndex) {
                const city = allCities[cityIndex];
                
                // Remplir automatiquement tous les champs
                cityInput.value = city.name;
                regionInput.value = city.region;
                postalCodeInput.value = city.postalCode;
                countrySelect.value = city.country;
                
                hideSuggestions();
                
                // Animation de confirmation
                cityInput.style.borderColor = '#10b981';
                setTimeout(() => {
                    cityInput.style.borderColor = '';
                }, 1000);
            }

            function getCountryFlag(countryCode) {
                const flags = {
                    'FR': '🇫🇷',
                    'ES': '🇪🇸', 
                    'IT': '🇮🇹',
                    'DE': '🇩🇪',
                    'PT': '🇵🇹',
                    'NL': '🇳🇱',
                    'BE': '🇧🇪',
                    'UK': '🇬🇧',
                    'US': '🇺🇸',
                    'CA': '🇨🇦'
                };
                return flags[countryCode] || '🌍';
            }
        }

        function addDateRange() {
            dateRangeCount++;
            const dateRangesDiv = document.getElementById('date-ranges');
            const newRange = document.createElement('div');
            newRange.className = 'date-range';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Plage de dates ${dateRangeCount}</span>
                    <button type="button" class="text-red-500 hover:text-red-700" onclick="removeDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de départ</label>
                        <input type="date" class="input-field date-start">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Date de retour</label>
                        <input type="date" class="input-field date-end">
                    </div>
                </div>
            `;
            dateRangesDiv.appendChild(newRange);
        }

        function addDelayedDateRange() {
            const delayedDatesDiv = document.getElementById('delayed-dates');
            const existingRanges = delayedDatesDiv.querySelectorAll('.bg-blue-50').length;
            
            const newRange = document.createElement('div');
            newRange.className = 'bg-blue-50 border border-blue-200 rounded-lg p-4 mt-3';
            newRange.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <p class="text-sm text-blue-700 font-medium">📅 Période ${existingRanges + 1}</p>
                    <button type="button" class="text-red-500 hover:text-red-700 text-sm" onclick="removeDelayedDateRange(this)">
                        ✕ Supprimer
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Du</label>
                        <input type="date" class="input-field">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-2">Au</label>
                        <input type="date" class="input-field">
                    </div>
                </div>
            `;
            
            // Insert before the "Ajouter" button
            const addButton = delayedDatesDiv.querySelector('button');
            addButton.parentNode.insertBefore(newRange, addButton);
        }

        function removeDelayedDateRange(button) {
            button.closest('.bg-blue-50').remove();
        }

        function removeDateRange(button) {
            button.closest('.date-range').remove();
        }

        function nextStep() {
            if (validateCurrentStep()) {
                currentStep++;
                if (currentStep > 4) currentStep = 4;
                showStep(currentStep);
                updateProgress();
            }
        }

        function prevStep() {
            currentStep--;
            if (currentStep < 1) currentStep = 1;
            showStep(currentStep);
            updateProgress();
        }

        function showStep(step) {
            // Hide all steps
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`step-${i}`).classList.add('hidden');
            }
            
            // Show current step
            document.getElementById(`step-${step}`).classList.remove('hidden');
            
            // Update step indicator
            document.getElementById('current-step').textContent = step;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const progress = (currentStep / 4) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            // Update step dots
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    dot.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    dot.classList.add('active');
                }
            });
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const country = document.getElementById('country').value;
                    const region = document.getElementById('region').value;
                    const city = document.getElementById('city').value;
                    const postalCode = document.getElementById('postal-code').value;
                    const bedrooms = document.getElementById('bedrooms').value;
                    const sleepingSpots = document.getElementById('sleeping-spots').value;
                    const housingType = document.getElementById('housing-type').value;
                    
                    if (!country || !region || !city || !postalCode || !bedrooms || !sleepingSpots || !housingType) {
                        showNotification('Veuillez remplir tous les champs obligatoires.', 'error');
                        return false;
                    }
                    break;
                    
                case 2:
                    if (!selectedExchangeStyle) {
                        showNotification('Veuillez choisir votre style d\'échange.', 'error');
                        return false;
                    }
                    
                    if (!selectedTravelWith) {
                        showNotification('Veuillez indiquer avec qui vous voyagez.', 'error');
                        return false;
                    }
                    
                    const hasPet = document.querySelector('input[name="has-pet"]:checked');
                    if (!hasPet) {
                        showNotification('Veuillez indiquer si vous avez un animal.', 'error');
                        return false;
                    }
                    break;
                    
                case 3:
                    const mainDestination = document.getElementById('main-destination').value;
                    if (!mainDestination) {
                        showNotification('Veuillez indiquer votre destination principale.', 'error');
                        return false;
                    }
                    
                    const dateStarts = document.querySelectorAll('.date-start');
                    const dateEnds = document.querySelectorAll('.date-end');
                    let hasValidDate = false;
                    
                    for (let i = 0; i < dateStarts.length; i++) {
                        if (dateStarts[i].value && dateEnds[i].value) {
                            hasValidDate = true;
                            break;
                        }
                    }
                    
                    if (!hasValidDate) {
                        showNotification('Veuillez renseigner au moins une plage de dates.', 'error');
                        return false;
                    }
                    
                    const experienceTitle = document.getElementById('experience-title').value;
                    const experienceDescription = document.getElementById('experience-description').value;
                    
                    if (!experienceTitle || !experienceDescription) {
                        showNotification('Veuillez remplir le titre et la description de votre expérience.', 'error');
                        return false;
                    }
                    break;
                    
                case 4:
                    const firstName = document.getElementById('first-name').value;
                    const lastName = document.getElementById('last-name').value;
                    const email = document.getElementById('email').value;
                    const age = document.getElementById('age').value;
                    
                    if (!firstName || !lastName || !email || !age) {
                        showNotification('Veuillez remplir tous les champs obligatoires du profil.', 'error');
                        return false;
                    }
                    break;
            }
            return true;
        }

        function completeProfile() {
            if (validateCurrentStep()) {
                // Collect all form data
                const formData = collectAllFormData();
                
                // Send to Zapier
                sendToZapier(formData);
                
                // Toujours afficher le rappel photos car elles seront demandées plus tard
                document.getElementById('photo-reminder').classList.remove('hidden');
                
                showNotification('✨ Profil créé avec succès !', 'success');
                setTimeout(() => {
                    document.getElementById('success-modal').classList.add('show');
                }, 1000);
            }
        }

        function collectAllFormData() {
            const data = {
                // Timestamp
                timestamp: new Date().toISOString(),
                
                // Étape 1 - Appartement
                country: document.getElementById('country').value,
                region: document.getElementById('region').value,
                city: document.getElementById('city').value,
                postalCode: document.getElementById('postal-code').value,
                bedrooms: document.getElementById('bedrooms').value,
                sleepingSpots: document.getElementById('sleeping-spots').value,
                surface: document.getElementById('surface').value,
                housingType: document.getElementById('housing-type').value,
                
                // Équipements
                equipment: Array.from(document.querySelectorAll('.equipment-checkbox:checked')).map(cb => cb.value),
                otherEquipment: document.getElementById('other-equipment').value,
                
                // Obligations pour le swapper
                obligations: Array.from(document.querySelectorAll('.obligation-checkbox:checked')).map(cb => cb.value),
                otherObligations: document.getElementById('other-obligations').value,
                
                // Étape 2 - Style d'échange
                exchangeStyle: selectedExchangeStyle,
                travelWith: selectedTravelWith,
                
                // Animaux
                hasPet: document.querySelector('input[name="has-pet"]:checked')?.value,
                travelWithPet: document.querySelector('input[name="travel-with-pet"]:checked')?.value,
                
                // Profil swapper idéal
                idealSwapperDescription: document.getElementById('ideal-swapper-description').value,
                agePreferences: Array.from(document.querySelectorAll('.age-preference:checked')).map(cb => cb.value),
                flexibilityPreferences: Array.from(document.querySelectorAll('.flexibility-preference:checked')).map(cb => cb.value),
                
                // Étape 3 - Expérience
                mainDestination: document.getElementById('main-destination').value,
                flexibleDuration: document.getElementById('flexible-duration').value,
                flexiblePeriod: document.getElementById('flexible-period').value,
                experienceTitle: document.getElementById('experience-title').value,
                experienceDescription: document.getElementById('experience-description').value,
                
                // Dates
                dateRanges: Array.from(document.querySelectorAll('.date-range')).map(range => ({
                    start: range.querySelector('.date-start').value,
                    end: range.querySelector('.date-end').value
                })).filter(range => range.start && range.end),
                
                // Options flexibles
                flexibleOptions: {
                    region: document.querySelector('[data-flexible-type="region"] input:checked') ? 
                           document.querySelector('[data-flexible-type="region"] #region-input input').value : null,
                    cities: document.querySelector('[data-flexible-type="cities"] input:checked') ? 
                           Array.from(document.querySelectorAll('[data-flexible-type="cities"] #cities-input input')).map(i => i.value).filter(v => v) : null,
                    destinationType: document.querySelector('[data-flexible-type="destination-type"] input:checked') ? 
                                   document.querySelector('[data-flexible-type="destination-type"] select').value : null
                },
                
                // Étape 4 - Profil personnel
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                age: document.getElementById('age').value,
                vieCompany: document.getElementById('vie-company').value,
                
                // Motivations et style
                reasons: Array.from(document.querySelectorAll('.reason-checkbox:checked')).map(cb => cb.value),
                otherReason: document.getElementById('other-reason').value,
                stayStyle: selectedStayStyle,
                
                // Infos personnelles
                smoker: document.querySelector('input[name="smoker"]:checked')?.value,
                remoteWork: document.querySelector('input[name="remote-work"]:checked')?.value,
                
                // Photos (seront demandées dans un second temps)
                hasApartmentPhotos: false,
                hasProfilePhoto: false
            };
            
            return data;
        }

        function sendToZapier(data) {
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            console.log('🚀 ENVOI À ZAPIER - Début');
            console.log('📡 URL Zapier:', zapierUrl);
            console.log('📦 Données à envoyer:', data);
            
            // Affichage visuel pour l'utilisateur
            showNotification('📡 Envoi des données à Zapier...', 'info');
            
            fetch(zapierUrl, {
                method: 'POST',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 Réponse Zapier reçue');
                console.log('📊 Status:', response.status);
                console.log('📋 Status Text:', response.statusText);
                console.log('🔗 URL finale:', response.url);
                
                if (response.ok || response.status === 200) {
                    console.log('✅ SUCCÈS - Données envoyées à Zapier avec succès !');
                    showNotification('✅ Données envoyées à Zapier avec succès !', 'success');
                    
                    // Lire la réponse pour plus de détails
                    return response.text();
                } else {
                    console.error('❌ ERREUR - Status HTTP:', response.status);
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(responseText => {
                console.log('📄 Réponse Zapier complète:', responseText);
            })
            .catch(error => {
                console.error('❌ ERREUR RÉSEAU - Détails complètes:', error);
                console.error('🔍 Type d\'erreur:', error.name);
                console.error('💬 Message d\'erreur:', error.message);
                console.error('📚 Stack trace:', error.stack);
                
                // Fallback : essayer avec une méthode alternative
                console.log('🔄 Tentative de fallback...');
                tryZapierFallback(data);
            });
        }

        function tryZapierFallback(data) {
            console.log('🔄 FALLBACK - Tentative avec méthode alternative');
            
            // Essayer avec une requête plus simple
            const zapierUrl = 'https://hooks.zapier.com/hooks/catch/25111863/urj4hbk/';
            
            fetch(zapierUrl, {
                method: 'POST',
                body: JSON.stringify(data)
            })
            .then(response => {
                console.log('📨 FALLBACK - Réponse reçue:', response.status);
                if (response.ok || response.status === 200) {
                    console.log('✅ FALLBACK SUCCÈS !');
                    showNotification('✅ Données envoyées avec succès (méthode alternative)', 'success');
                } else {
                    throw new Error(`Fallback failed: ${response.status}`);
                }
            })
            .catch(fallbackError => {
                console.error('❌ FALLBACK ÉCHOUÉ:', fallbackError);
                
                // Sauvegarder localement en dernier recours
                try {
                    localStorage.setItem('swapp_profile_backup', JSON.stringify(data));
                    console.log('💾 Données sauvegardées localement');
                } catch (storageError) {
                    console.error('❌ Impossible de sauvegarder localement:', storageError);
                }
            });
        }

        function showFeedbackModal() {
            document.getElementById('feedback-modal').classList.add('show');
        }

        function closeFeedbackModal() {
            document.getElementById('feedback-modal').classList.remove('show');
        }

        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(function() {
                // Visual feedback
                const originalText = button.textContent;
                button.textContent = '✅ Copié !';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
                
                showNotification(`📋 ${text} copié dans le presse-papier !`, 'success');
            }).catch(function(err) {
                console.error('Erreur de copie:', err);
                showNotification('❌ Impossible de copier automatiquement', 'error');
            });
        }

        function showNotification(message, type = 'info') {
            // Créer la notification
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
            
            // Styles selon le type
            const styles = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                warning: 'bg-yellow-500 text-white',
                info: 'bg-blue-500 text-white'
            };
            
            notification.className += ` ${styles[type] || styles.info}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animation d'entrée
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Animation de sortie
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Fonctions pour les boutons d'aide
        function surpriseMe() {
            // Modal interactif pour choisir le mood et la région
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="emoji-large">🎲</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Surprends-moi !</h3>
                    <p class="text-gray-600 mb-6">Dis-moi ton mood et je te trouve la destination parfaite !</p>
                    
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌈 Ton mood ?</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="mer" class="mr-2">
                                    <span>🏖️ Mer & soleil</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="montagne" class="mr-2">
                                    <span>🏔️ Montagne & nature</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="ville" class="mr-2">
                                    <span>🏙️ Ville & culture</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="mood" value="aventure" class="mr-2">
                                    <span>✨ Aventure</span>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">🌍 Région du monde ?</h4>
                            <div class="space-y-2">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="europe" class="mr-2">
                                    <span>🇪🇺 Europe</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-nord" class="mr-2">
                                    <span>🇺🇸 Amérique du Nord</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="amerique-sud" class="mr-2">
                                    <span>🇧🇷 Amérique du Sud</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="asie-oceanie" class="mr-2">
                                    <span>🌏 Asie / Océanie / Afrique</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="region" value="surprise" class="mr-2">
                                    <span>🎲 Surprise totale !</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="generateSurpriseDestination(this)">🎲 Surprends-moi !</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function generateSurpriseDestination(button) {
            const modal = button.closest('.modal');
            const mood = modal.querySelector('input[name="mood"]:checked')?.value;
            const region = modal.querySelector('input[name="region"]:checked')?.value;
            
            if (!mood || !region) {
                showNotification('Choisis ton mood et ta région préférée !', 'warning');
                return;
            }
            
            const destinations = {
                europe: {
                    mer: ['Barcelone (Espagne)', 'Lisbonne (Portugal)', 'Tarragone (Espagne)'],
                    montagne: ['Ski (Norvège)', 'Berlin (Allemagne)', 'Copenhague (Danemark)'],
                    ville: ['Paris (France)', 'Madrid (Espagne)', 'Bruxelles (Belgique)', 'Luxembourg', 'Berlin (Allemagne)'],
                    aventure: ['Kilkenny (Irlande)', 'Opole (Pologne)', 'Ski (Norvège)']
                },
                'amerique-nord': {
                    mer: ['Miami (États-Unis)', 'Los Angeles (États-Unis)', 'Playa del Carmen (Mexique)'],
                    montagne: ['Seattle (États-Unis)', 'Montréal (Canada)', 'Buffalo (États-Unis)'],
                    ville: ['New York (États-Unis)', 'Chicago (États-Unis)', 'Toronto (Canada)', 'Mexico City (Mexique)'],
                    aventure: ['Little Rock (États-Unis)', 'Santa Rosa (États-Unis)', 'Merida (Mexique)']
                },
                'amerique-sud': {
                    mer: ['Rio de Janeiro (Brésil)', 'Santo Domingo (République Dominicaine)'],
                    montagne: ['Belo Horizonte (Brésil)', 'Itajubá (Brésil)'],
                    ville: ['São Paulo (Brésil)', 'Monterrey (Mexique)', 'Puebla (Mexique)'],
                    aventure: ['Ribeirão Preto (Brésil)', 'San Juan de la Maguana (République Dominicaine)']
                },
                'asie-oceanie': {
                    mer: ['Sydney (Australie)'],
                    montagne: ['Chandigarh (Inde)'],
                    ville: ['Singapour', 'Mumbai (Inde)', 'Accra (Ghana)'],
                    aventure: ['Libreville (Gabon)', 'Chandigarh (Inde)']
                }
            };
            
            let selectedDestinations = [];
            
            if (region === 'surprise') {
                // Mélange toutes les destinations
                Object.values(destinations).forEach(regionDests => {
                    Object.values(regionDests).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                });
            } else {
                selectedDestinations = destinations[region]?.[mood] || [];
                
                // Si pas de destinations pour ce mood dans cette région, prendre toutes les destinations de la région
                if (selectedDestinations.length === 0) {
                    Object.values(destinations[region] || {}).forEach(moodDests => {
                        selectedDestinations.push(...moodDests);
                    });
                }
            }
            
            if (selectedDestinations.length === 0) {
                showNotification('Aucune destination trouvée pour cette combinaison !', 'error');
                return;
            }
            
            const randomDestination = selectedDestinations[Math.floor(Math.random() * selectedDestinations.length)];
            document.getElementById('main-destination').value = randomDestination;
            
            closeModal(button);
            showNotification(`🎲 Destination surprise : ${randomDestination} !`, 'success');
        }

        function showAvailableCities() {
            const citiesByRegion = {
                '🇺🇸 États-Unis / Amérique du Nord': [
                    'New York', 'Boston', 'Chicago', 'Los Angeles', 'Philadelphia', 
                    'Washington DC', 'Houston', 'Dallas', 'Miami', 'Seattle', 
                    'Buffalo', 'Dayton', 'Little Rock', 'Lakeland', 'Santa Rosa', 'Iowa City'
                ],
                '🇨🇦 Canada': [
                    'Montréal', 'Toronto', 'Thorold'
                ],
                '🇲🇽 Mexique / Amérique centrale': [
                    'Mexico City', 'San Luis Potosí', 'Monterrey', 'Puebla', 
                    'Playa del Carmen', 'Merida (Yucatán)'
                ],
                '🇧🇷 Brésil': [
                    'São Paulo', 'Rio de Janeiro', 'Belo Horizonte', 
                    'Ribeirão Preto', 'Taubaté', 'Itajubá (MG)'
                ],
                '🇩🇴 République Dominicaine / Caraïbes': [
                    'Santo Domingo', 'San Juan de la Maguana'
                ],
                '🇪🇺 Europe': [
                    'Paris', 'Bruxelles', 'Luxembourg', 'Copenhague', 'Madrid', 
                    'Barcelone', 'Tarragone', 'Lisbonne', 'Opole', 'Kilkenny (Irlande)', 
                    'Berlin', 'Ski (Norvège)'
                ],
                '🌏 Asie / Océanie / Afrique': [
                    'Singapour', 'Sydney', 'Mumbai', 'Chandigarh', 
                    'Libreville (Gabon)', 'Accra (Ghana)'
                ]
            };
            
            let modalContent = '<div class="space-y-6">';
            
            Object.entries(citiesByRegion).forEach(([region, cities]) => {
                modalContent += `
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">${region}</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                `;
                
                cities.forEach(city => {
                    modalContent += `
                        <button class="city-vignette bg-blue-50 hover:bg-blue-100 border border-blue-200 hover:border-blue-400 rounded-lg px-3 py-2 text-sm text-blue-800 hover:text-blue-900 transition-all duration-200 cursor-pointer text-left" 
                                onclick="selectDestinationCity('${city.replace(/'/g, "\\'")}')">
                            📍 ${city}
                        </button>
                    `;
                });
                
                modalContent += '</div></div>';
            });
            
            modalContent += '</div>';
            
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🌍 Villes disponibles sur &SWAPP</h3>
                    <p class="text-sm text-gray-600 mb-6">💡 Cliquez sur une ville pour la sélectionner comme destination</p>
                    ${modalContent}
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function showExperienceExamples() {
            const examples = [
                '✨ "Échange Paris ↔ Lisbonne - Découverte culturelle en couple"',
                '🏖️ "Swap Lyon ↔ Barcelone - Soleil et architecture catalane"',
                '🎨 "Échange Marseille ↔ Florence - Immersion artistique"',
                '💻 "Swap Bordeaux ↔ Berlin - Télétravail et vie nocturne"',
                '🌿 "Échange Nantes ↔ Amsterdam - Vélo et canaux"',
                '🍝 "Swap Nice ↔ Rome - Gastronomie méditerranéenne"',
                '🏛️ "Échange Toulouse ↔ Prague - Architecture et histoire"',
                '🎭 "Swap Lille ↔ Londres - Théâtre et musées"'
            ];
            
            showModal('✨ Exemples d\'expériences inspirantes', examples.join('<br><br>'));
        }

        // NOUVEAUX ASSISTANTS INTERACTIFS

        function showSwapperAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">👤</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Profil Swapper</h3>
                        <p class="text-gray-600">Créons ensemble la description de votre swapper idéal !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Type de personne -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Type de personne recherchée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="young-professional" class="swapper-input">
                                    <span class="text-sm">Jeune professionnel</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="couple" class="swapper-input">
                                    <span class="text-sm">Couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="family" class="swapper-input">
                                    <span class="text-sm">Famille</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="student" class="swapper-input">
                                    <span class="text-sm">Étudiant</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="retiree" class="swapper-input">
                                    <span class="text-sm">Retraité actif</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="swapper-type" value="any" class="swapper-input">
                                    <span class="text-sm">Peu importe</span>
                                </label>
                            </div>
                        </div>

                        <!-- Qualités importantes -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Qualités importantes (max 4)</h4>
                            <div class="flex flex-wrap gap-2">
                                <span class="quality-tag" data-quality="respectful">Respectueux</span>
                                <span class="quality-tag" data-quality="calm">Calme</span>
                                <span class="quality-tag" data-quality="communicative">Communicatif</span>
                                <span class="quality-tag" data-quality="clean">Soigneux</span>
                                <span class="quality-tag" data-quality="flexible">Flexible</span>
                                <span class="quality-tag" data-quality="cultural">Amateur de culture</span>
                                <span class="quality-tag" data-quality="social">Sociable</span>
                                <span class="quality-tag" data-quality="independent">Indépendant</span>
                                <span class="quality-tag" data-quality="experienced">Voyageur expérimenté</span>
                                <span class="quality-tag" data-quality="open-minded">Ouvert d'esprit</span>
                            </div>
                        </div>

                        <!-- Centres d'intérêt -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Centres d'intérêt partagés (optionnel)</h4>
                            <input type="text" id="swapper-interests" class="input-field" placeholder="Ex: art, cuisine, sport, musique, nature...">
                        </div>

                        <!-- Critères spéciaux -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔧 Critères spéciaux (optionnel)</h4>
                            <textarea id="swapper-special" class="textarea-field" placeholder="Ex: non-fumeur, avec enfants, télétravailleur..." style="min-height: 80px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="swapper-preview" class="text-sm text-gray-700 italic">
                                Sélectionnez vos préférences pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useSwapperDescription()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupSwapperAssistantListeners(modal);
        }

        function setupSwapperAssistantListeners(modal) {
            // Quality tags selection
            modal.addEventListener('click', function(e) {
                if (e.target.classList.contains('quality-tag')) {
                    const selectedQualities = modal.querySelectorAll('.quality-tag.selected');
                    
                    if (e.target.classList.contains('selected')) {
                        e.target.classList.remove('selected');
                    } else if (selectedQualities.length < 4) {
                        e.target.classList.add('selected');
                    } else {
                        showNotification('Maximum 4 qualités sélectionnables', 'warning');
                    }
                    
                    updateSwapperPreview(modal);
                }
            });

            // Input changes
            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('swapper-input')) {
                    updateSwapperPreview(modal);
                }
            });

            modal.addEventListener('input', function(e) {
                if (e.target.id === 'swapper-interests' || e.target.id === 'swapper-special') {
                    updateSwapperPreview(modal);
                }
            });
        }

        function updateSwapperPreview(modal) {
            const type = modal.querySelector('input[name="swapper-type"]:checked')?.value;
            const qualities = Array.from(modal.querySelectorAll('.quality-tag.selected')).map(tag => tag.dataset.quality);
            const interests = modal.querySelector('#swapper-interests').value;
            const special = modal.querySelector('#swapper-special').value;

            let description = '';

            // Type de personne
            const typeTexts = {
                'young-professional': 'Je recherche un jeune professionnel',
                'couple': 'Je recherche un couple',
                'family': 'Je recherche une famille',
                'student': 'Je recherche un étudiant',
                'retiree': 'Je recherche un retraité actif',
                'any': 'Je suis ouvert à différents profils'
            };

            if (type && type !== 'any') {
                description += typeTexts[type];
            }

            // Qualités
            if (qualities.length > 0) {
                const qualityTexts = {
                    'respectful': 'respectueux',
                    'calm': 'calme',
                    'communicative': 'communicatif',
                    'clean': 'soigneux',
                    'flexible': 'flexible',
                    'cultural': 'amateur de culture',
                    'social': 'sociable',
                    'independent': 'indépendant',
                    'experienced': 'voyageur expérimenté',
                    'open-minded': 'ouvert d\'esprit'
                };

                const qualityList = qualities.map(q => qualityTexts[q]).join(', ');
                
                if (description) {
                    description += ', ';
                } else {
                    description += 'Je recherche une personne ';
                }
                
                if (qualities.length === 1) {
                    description += qualityList;
                } else if (qualities.length === 2) {
                    description += qualityList.replace(', ', ' et ');
                } else {
                    const lastComma = qualityList.lastIndexOf(', ');
                    description += qualityList.substring(0, lastComma) + ' et ' + qualityList.substring(lastComma + 2);
                }
            }

            // Centres d'intérêt
            if (interests.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Idéalement avec des centres d'intérêt comme : ${interests.trim()}`;
            }

            // Critères spéciaux
            if (special.trim()) {
                if (description) {
                    description += '. ';
                }
                description += `Critères importants : ${special.trim()}`;
            }

            if (description && !description.endsWith('.')) {
                description += '.';
            }

            modal.querySelector('#swapper-preview').textContent = description || 'Sélectionnez vos préférences pour voir l\'aperçu...';
        }

        function useSwapperDescription() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#swapper-preview').textContent;
            
            if (description && description !== 'Sélectionnez vos préférences pour voir l\'aperçu...') {
                document.getElementById('ideal-swapper-description').value = description;
                showNotification('✅ Description du swapper ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez sélectionner au moins une préférence', 'warning');
            }
        }

        function showTitleAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">✍️</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Titre d'Expérience</h3>
                        <p class="text-gray-600">Créons un titre accrocheur pour votre annonce !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Votre ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">📍 Votre ville (d'où vous venez)</h4>
                            <input type="text" id="title-origin" class="input-field title-input" placeholder="Ex: Paris, Lyon, Marseille...">
                        </div>

                        <!-- Durée du séjour -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">⏰ Durée souhaitée</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="weekend" class="title-input">
                                    <span class="text-sm">Un week-end</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-week" class="title-input">
                                    <span class="text-sm">1 semaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-weeks" class="title-input">
                                    <span class="text-sm">2 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="3-weeks" class="title-input">
                                    <span class="text-sm">3 semaines</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="1-month" class="title-input">
                                    <span class="text-sm">1 mois</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="duration" value="2-months" class="title-input">
                                    <span class="text-sm">2 mois</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-duration" class="input-field title-input" placeholder="Ou précisez votre durée : ex: 10 jours, 6 semaines...">
                            </div>
                        </div>

                        <!-- Type d'expérience -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">✨ Type d'expérience</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="cultural" class="title-input">
                                    <span class="text-sm">Découverte culturelle</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="work" class="title-input">
                                    <span class="text-sm">Télétravail</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="relax" class="title-input">
                                    <span class="text-sm">Détente & repos</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="adventure" class="title-input">
                                    <span class="text-sm">Aventure urbaine</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="gastronomy" class="title-input">
                                    <span class="text-sm">Gastronomie</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="experience-type" value="art" class="title-input">
                                    <span class="text-sm">Art & musées</span>
                                </label>
                            </div>
                            <div class="mt-3">
                                <input type="text" id="title-custom-type" class="input-field title-input" placeholder="Ou décrivez votre propre type d'expérience...">
                            </div>
                        </div>

                        <!-- Avec qui -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👥 Avec qui voyagez-vous ?</h4>
                            <div class="grid grid-cols-3 gap-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="solo" class="title-input">
                                    <span class="text-sm">Solo</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="couple" class="title-input">
                                    <span class="text-sm">En couple</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="travel-group" value="family" class="title-input">
                                    <span class="text-sm">En famille</span>
                                </label>
                            </div>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre titre :</h4>
                            <div id="title-preview" class="text-sm text-gray-700 italic font-medium">
                                Remplissez les champs pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useTitleDescription()">✅ Utiliser ce titre</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupTitleAssistantListeners(modal);
        }

        function setupTitleAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });

            modal.addEventListener('change', function(e) {
                if (e.target.classList.contains('title-input')) {
                    updateTitlePreview(modal);
                }
            });
        }

        function updateTitlePreview(modal) {
            const origin = modal.querySelector('#title-origin').value.trim();
            const duration = modal.querySelector('input[name="duration"]:checked')?.value;
            const customDuration = modal.querySelector('#title-custom-duration').value.trim();
            const experienceType = modal.querySelector('input[name="experience-type"]:checked')?.value;
            const customType = modal.querySelector('#title-custom-type').value.trim();
            const travelGroup = modal.querySelector('input[name="travel-group"]:checked')?.value;

            let title = '';

            // Durée
            let durationText = '';
            if (customDuration) {
                durationText = customDuration;
            } else if (duration) {
                const durationTexts = {
                    'weekend': 'Week-end',
                    '1-week': '1 semaine',
                    '2-weeks': '2 semaines', 
                    '3-weeks': '3 semaines',
                    '1-month': '1 mois',
                    '2-months': '2 mois'
                };
                durationText = durationTexts[duration];
            }

            // Type d'expérience
            let experienceText = '';
            if (customType) {
                experienceText = customType;
            } else if (experienceType) {
                const typeTexts = {
                    'cultural': 'de découverte culturelle',
                    'work': 'de télétravail',
                    'relax': 'de détente',
                    'adventure': 'd\'aventure urbaine',
                    'gastronomy': 'd\'exploration gastronomique',
                    'art': 'd\'immersion artistique'
                };
                experienceText = typeTexts[experienceType];
            }

            // Construction du titre
            if (durationText && experienceText) {
                title = `${durationText} ${experienceText}`;
            } else if (durationText) {
                title = `${durationText} d'échange`;
            } else if (experienceText) {
                title = `Séjour ${experienceText}`;
            }

            // Ajout de l'origine si spécifiée
            if (origin && title) {
                title += ` depuis ${origin}`;
            } else if (origin && !title) {
                title = `Échange depuis ${origin}`;
            }

            // Groupe de voyage
            if (travelGroup && travelGroup !== 'solo' && title) {
                const groupTexts = {
                    'couple': 'en couple',
                    'family': 'en famille'
                };
                title += ` ${groupTexts[travelGroup]}`;
            }

            modal.querySelector('#title-preview').textContent = title || 'Remplissez les champs pour voir l\'aperçu...';
        }

        function useTitleDescription() {
            const modal = document.querySelector('.assistant-modal');
            const title = modal.querySelector('#title-preview').textContent;
            
            if (title && title !== 'Remplissez les champs pour voir l\'aperçu...') {
                document.getElementById('experience-title').value = title;
                showNotification('✅ Titre d\'expérience ajouté !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins la durée ou le type d\'expérience', 'warning');
            }
        }

        function showDescriptionAssistant() {
            const modal = document.createElement('div');
            modal.className = 'modal show assistant-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="text-center mb-6">
                        <div class="emoji-large">📝</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Assistant Description d'Expérience</h3>
                        <p class="text-gray-600">Créons une description complète et attractive !</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Qui êtes-vous -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">👤 Qui êtes-vous ?</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-who" class="input-field desc-input" placeholder="Ex: Marie et Thomas, couple de trentenaires parisiens">
                                <input type="text" id="desc-profession" class="input-field desc-input" placeholder="Ex: développeur et architecte">
                                <input type="text" id="desc-passions" class="input-field desc-input" placeholder="Ex: passionnés d'architecture et de gastronomie">
                            </div>
                        </div>

                        <!-- Votre projet -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎯 Votre projet de voyage</h4>
                            <div class="space-y-3">
                                <textarea id="desc-motivation" class="textarea-field desc-input" placeholder="Ex: Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí..." style="min-height: 80px;"></textarea>
                            </div>
                        </div>

                        <!-- Votre quartier/ville -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🏘️ Votre quartier/ville</h4>
                            <div class="space-y-3">
                                <input type="text" id="desc-location" class="input-field desc-input" placeholder="Ex: 11ème arrondissement, quartier branché">
                                <textarea id="desc-neighborhood" class="textarea-field desc-input" placeholder="Ex: avec de nombreux bars et restaurants, proche du métro..." style="min-height: 60px;"></textarea>
                            </div>
                        </div>

                        <!-- Ce que vous offrez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🎁 Ce que vous offrez</h4>
                            <textarea id="desc-offer" class="textarea-field desc-input" placeholder="Ex: Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Ce que vous recherchez -->
                        <div class="assistant-section">
                            <h4 class="font-semibold text-gray-700 mb-3">🔍 Ce que vous recherchez</h4>
                            <textarea id="desc-looking" class="textarea-field desc-input" placeholder="Ex: Nous recherchons un couple ou une personne seule, flexible sur les dates..." style="min-height: 60px;"></textarea>
                        </div>

                        <!-- Aperçu en temps réel -->
                        <div class="assistant-preview">
                            <h4 class="font-semibold text-green-700 mb-3">📝 Aperçu de votre description :</h4>
                            <div id="description-preview" class="text-sm text-gray-700" style="max-height: 200px; overflow-y: auto;">
                                Remplissez les sections pour voir l'aperçu...
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button class="btn-secondary flex-1" onclick="closeModal(this)">Annuler</button>
                        <button class="btn-primary flex-1" onclick="useDescriptionText()">✅ Utiliser cette description</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Event listeners pour l'aperçu en temps réel
            setupDescriptionAssistantListeners(modal);
        }

        function setupDescriptionAssistantListeners(modal) {
            modal.addEventListener('input', function(e) {
                if (e.target.classList.contains('desc-input')) {
                    updateDescriptionPreview(modal);
                }
            });
        }

        function updateDescriptionPreview(modal) {
            const who = modal.querySelector('#desc-who').value.trim();
            const profession = modal.querySelector('#desc-profession').value.trim();
            const passions = modal.querySelector('#desc-passions').value.trim();
            const motivation = modal.querySelector('#desc-motivation').value.trim();
            const location = modal.querySelector('#desc-location').value.trim();
            const neighborhood = modal.querySelector('#desc-neighborhood').value.trim();
            const offer = modal.querySelector('#desc-offer').value.trim();
            const looking = modal.querySelector('#desc-looking').value.trim();

            let description = '';

            // Qui êtes-vous
            if (who || profession || passions) {
                description += 'Salut ! ';
                
                if (who) {
                    description += `Nous sommes ${who}`;
                    if (profession) description += `, ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (profession) {
                    description += `Je suis ${profession}`;
                    if (passions) description += `, ${passions}`;
                } else if (passions) {
                    description += `Nous sommes ${passions}`;
                }
                
                description += '. ';
            }

            // Motivation
            if (motivation) {
                description += `${motivation} `;
                if (!motivation.endsWith('.')) description += '. ';
            }

            // Quartier/ville
            if (location || neighborhood) {
                if (location) {
                    description += `Notre logement se trouve ${location}`;
                    if (neighborhood) description += `, ${neighborhood}`;
                } else if (neighborhood) {
                    description += `Notre quartier : ${neighborhood}`;
                }
                description += '. ';
            }

            // Ce que vous offrez
            if (offer) {
                description += `${offer} `;
                if (!offer.endsWith('.')) description += '. ';
            }

            // Ce que vous recherchez
            if (looking) {
                description += `${looking}`;
                if (!looking.endsWith('.')) description += '.';
            }

            modal.querySelector('#description-preview').textContent = description || 'Remplissez les sections pour voir l\'aperçu...';
        }

        function useDescriptionText() {
            const modal = document.querySelector('.assistant-modal');
            const description = modal.querySelector('#description-preview').textContent;
            
            if (description && description !== 'Remplissez les sections pour voir l\'aperçu...') {
                document.getElementById('experience-description').value = description;
                showNotification('✅ Description d\'expérience ajoutée !', 'success');
                closeModal(modal.querySelector('button'));
            } else {
                showNotification('Veuillez remplir au moins une section', 'warning');
            }
        }

        function showAnnouncementExamples() {
            const examples = [
                '<strong>🏖️ Exemple 1 - Échange Paris ↔ Barcelone</strong><br><br>' +
                '"Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens passionnés d\'architecture et de gastronomie. Nous rêvons de découvrir l\'effervescence barcelonaise, ses marchés colorés et l\'œuvre de Gaudí.<br><br>' +
                'Notre appartement se trouve dans le 11ème arrondissement, quartier branché avec de nombreux bars et restaurants. Nous adorons partager nos bonnes adresses !<br><br>' +
                'Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange d\'une semaine en avril ou mai 2024."',
                '',
                '<strong>💻 Exemple 2 - Échange Lyon ↔ Lisbonne</strong><br><br>' +
                '"Hello ! Je suis Alex, développeur en télétravail de 28 ans. Après 2 ans de remote, j\'ai envie de changer d\'air tout en gardant ma routine de travail. Lisbonne m\'attire pour son climat, ses couleurs et sa scène tech dynamique.<br><br>' +
                'Mon studio lyonnais est parfait pour le télétravail : fibre, bureau ergonomique, quartier calme près du Rhône. Je peux partager tous mes spots favoris pour le sport et les sorties !<br><br>' +
                'Je cherche quelqu\'un dans le même état d\'esprit, qui télétravaille et veut découvrir Lyon. Flexible sur la durée (2 semaines à 2 mois)."',
                '',
                '<strong>🎨 Exemple 3 - Échange Marseille ↔ Florence</strong><br><br>' +
                '"Ciao ! Nous sommes une famille de 4 (parents + 2 ados) passionnée d\'art et d\'histoire. Florence est un rêve pour nous : les Offices, le Ponte Vecchio, l\'artisanat local...<br><br>' +
                'Notre maison marseillaise offre une vue mer, proche des calanques et du centre-ville. Les enfants connaissent tous les bons plans jeunes de la ville !<br><br>' +
                'Nous recherchons une famille ou un couple, pour 10-15 jours cet été. Nous sommes très soigneux et respectueux."'
            ];
            
            showModal('📝 Exemples d\'annonces inspirantes', examples.join('<br><br>'));
        }

        function showModal(title, content) {
            // Créer le modal
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">${title}</h3>
                    <div class="text-sm text-gray-700 leading-relaxed">${content}</div>
                    <div class="flex justify-center mt-6">
                        <button class="btn-secondary" onclick="closeModal(this)">Fermer</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant sur le fond
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.querySelector('button'));
                }
            });
        }

        function editProfile() {
            // Fermer le modal de succès
            document.getElementById('success-modal').classList.remove('show');
            
            // Retourner à l'étape 1
            currentStep = 1;
            showStep(currentStep);
            updateProgress();
            
            showNotification('✏️ Vous pouvez maintenant modifier votre profil', 'info');
        }

        function testZapier() {
            console.log('🧪 DÉBUT DU TEST ZAPIER COMPLET');
            showNotification('🧪 Lancement du test Zapier avec TOUS les champs (nouveaux inclus)...', 'info');
            
            // Données de test COMPLÈTES avec TOUS les champs, y compris les nouveaux
            const testData = {
                // === MÉTADONNÉES ===
                timestamp: new Date().toISOString(),
                createdAt: new Date().toISOString(),
                profileComplete: true,
                source: "web_form_test_complet",
                formVersion: "v2.2",
                profileScore: 98,
                
                // === ÉTAPE 1 - APPARTEMENT ===
                // Localisation
                country: "FR",
                region: "Île-de-France", 
                city: "Paris",
                postalCode: "75011",
                locationFull: "Paris, 75011, Île-de-France, France",
                
                // Caractéristiques logement
                bedrooms: "2",
                sleepingSpots: "4", 
                surface: "65",
                housingType: "apartment",
                housingDescription: "Appartement lumineux avec balcon, quartier République, proche métro",
                
                // Équipements (booléens individuels + liste)
                equipment: ["wifi", "workspace", "kitchen", "washing-machine", "balcony", "pets-accepted"],
                hasWifi: true,
                hasWorkspace: true,
                hasKitchen: true,
                hasWashingMachine: true,
                hasBalcony: true,
                hasParking: false,
                petsAccepted: true,
                otherEquipment: "Climatisation, lave-vaisselle, piano",
                equipmentCount: 6,
                
                // Obligations pour le swapper (NOUVEAUX CHAMPS - sans nettoyage)
                obligations: ["pet-care", "plant-care"],
                obligationPetCare: true,
                obligationPlantCare: true,
                obligationMailCollection: false,
                otherObligations: "Nourrir le chat 2x/jour (matin et soir), arroser les orchidées le dimanche uniquement",
                obligationCount: 2,
                
                // === ÉTAPE 2 - STYLE D'ÉCHANGE ===
                // Style d'échange
                exchangeStyle: "both",
                delayedDate1Start: "2024-07-15",
                delayedDate1End: "2024-07-30",
                delayedDate2Start: "2024-09-01", 
                delayedDate2End: "2024-09-15",
                delayedDate3Start: "2024-12-20",
                delayedDate3End: "2024-12-31",
                delayedDateRangeCount: 3,
                
                // Voyage
                travelWith: "couple",
                colocataireCount: null,
                otherTravelDetails: null,
                
                // Animaux
                hasPet: "yes",
                petType: "dog",
                petDescription: "Golden Retriever de 3 ans, très calme et sociable",
                travelWithPet: "no",
                
                // Profil swapper idéal (NOUVEAUX CHAMPS ASSISTANTS)
                idealSwapperDescription: "Je recherche un couple respectueux, calme, communicatif et soigneux. Idéalement avec des centres d'intérêt comme : art, cuisine, voyages, architecture. Critères importants : non-fumeur, soigneux, expérience en échange de logements.",
                agePreferences: ["26-35", "36-50"],
                agePreference18_25: false,
                agePreference26_35: true,
                agePreference36_50: true,
                agePreference50Plus: false,
                flexibilityPreferences: ["dates-flexible", "duration-flexible", "destination-flexible"],
                flexibilityDates: true,
                flexibilityDuration: true,
                flexibilityDestination: true,
                flexibilityExchangeType: false,
                
                // === ÉTAPE 3 - EXPÉRIENCE ===
                // Destination
                mainDestination: "Barcelone (Espagne)",
                destinationSummary: "Barcelone + alternatives Sud Espagne/Portugal + type soleil",
                
                // Options flexibles (NOUVEAUX CHAMPS)
                flexibleOptions: {
                    region: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                    cities: ["Madrid", "Séville", "Porto", "Lisbonne", "Valence"],
                    destinationType: "sunny"
                },
                flexibleRegion: "Sud de l'Espagne ou Portugal, à moins de 2h de vol de Barcelone",
                flexibleCity1: "Madrid",
                flexibleCity2: "Séville", 
                flexibleCity3: "Porto",
                flexibleCity4: "Lisbonne",
                flexibleCity5: "Valence",
                flexibleDestinationType: "sunny",
                hasFlexibleOptions: true,
                flexibleOptionsCount: 3,
                
                // Dates de voyage
                dateRanges: [
                    { start: "2024-06-15", end: "2024-06-29" },
                    { start: "2024-07-20", end: "2024-08-03" },
                    { start: "2024-09-10", end: "2024-09-24" }
                ],
                travelDate1Start: "2024-06-15",
                travelDate1End: "2024-06-29",
                travelDate2Start: "2024-07-20",
                travelDate2End: "2024-08-03",
                travelDate3Start: "2024-09-10",
                travelDate3End: "2024-09-24",
                flexibleDuration: "2weeks",
                flexiblePeriod: "été 2024 ou début automne",
                dateRangeCount: 3,
                
                // Expérience (NOUVEAUX CHAMPS ASSISTANTS)
                experienceTitle: "2 semaines de découverte culturelle depuis Paris - Échange Paris ↔ Barcelone en couple",
                experienceDescription: "Salut ! Nous sommes Marie et Thomas, couple de trentenaires parisiens, développeur et architecte, passionnés d'architecture et de gastronomie. Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí. Notre appartement se trouve 11ème arrondissement, quartier branché avec de nombreux bars et restaurants, proche du métro République. Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground. Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024.",
                experienceType: "cultural",
                generatedWithAssistant: true,
                
                // === ÉTAPE 4 - PROFIL PERSONNEL ===
                // Profil personnel
                firstName: "Marie",
                lastName: "Dupont",
                fullName: "Marie Dupont",
                email: "marie.dupont.test@example.com",
                phone: "+33 6 12 34 56 78",
                age: "29",
                vieCompany: "Airbus",
                
                // Motivations (NOUVEAUX CHAMPS)
                reasons: ["change-air", "culture"],
                reasonChangeAir: true,
                reasonCulture: true,
                reasonBreak: false,
                reasonFamily: false,
                reasonClimate: false,
                otherReason: "Améliorer notre espagnol et découvrir l'architecture catalane en immersion",
                motivationCount: 2,
                
                // Style et infos
                stayStyle: "immersive",
                smoker: "no",
                remoteWork: "yes",
                
                // === PHOTOS (seront demandées plus tard) ===
                hasApartmentPhotos: false,
                apartmentPhotosCount: 0,
                hasProfilePhoto: false,
                photosRequestedLater: true,
                
                // === NOUVEAUX CHAMPS ASSISTANTS ===
                // Assistant Swapper utilisé
                swapperAssistantUsed: true,
                swapperType: "couple",
                swapperQualities: ["respectful", "calm", "communicative", "clean"],
                swapperInterests: "art, cuisine, voyages, architecture",
                swapperSpecialCriteria: "non-fumeur, soigneux, expérience en échange de logements",
                
                // Assistant Titre utilisé
                titleAssistantUsed: true,
                titleOrigin: "Paris",
                titleDuration: "2-weeks",
                titleExperienceType: "cultural",
                titleTravelGroup: "couple",
                
                // Assistant Description utilisé
                descriptionAssistantUsed: true,
                descriptionWho: "Marie et Thomas, couple de trentenaires parisiens",
                descriptionProfession: "développeur et architecte",
                descriptionPassions: "passionnés d'architecture et de gastronomie",
                descriptionMotivation: "Nous rêvons de découvrir l'effervescence barcelonaise, ses marchés colorés et l'œuvre de Gaudí",
                descriptionLocation: "11ème arrondissement, quartier branché",
                descriptionNeighborhood: "avec de nombreux bars et restaurants, proche du métro République",
                descriptionOffer: "Nous adorons partager nos bonnes adresses ! Guide complet de nos spots favoris : meilleurs restaurants, bars cachés, parcs secrets, galeries d'art underground",
                descriptionLooking: "Nous recherchons un couple ou une personne seule, flexible sur les dates, pour un échange de 2 semaines entre juin et septembre 2024",
                
                // === STATISTIQUES ET QUALITÉ ===
                formCompletionTime: "12 minutes",
                assistantsUsedCount: 3,
                fieldsCompletedCount: 45,
                optionalFieldsCompletedCount: 12,
                qualityScore: 98,
                readinessScore: 95,
                
                // === CHAMPS TECHNIQUES ===
                userAgent: navigator.userAgent,
                screenResolution: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                
                // === VALIDATION ===
                allRequiredFieldsCompleted: true,
                validationErrors: [],
                validationWarnings: ["Photos seront demandées dans un second temps"],
                
                // === POUR ZAPIER/NOTION ===
                notionPageTitle: "Marie Dupont - Paris ↔ Barcelone - Couple Culture",
                notionTags: ["Paris", "Barcelone", "Couple", "Culture", "Télétravail", "Été 2024"],
                zapierProcessed: false,
                zapierTimestamp: null
            };
            
            console.log('📦 DONNÉES DE TEST ULTRA-COMPLÈTES générées:', testData);
            console.log('📊 Nombre total de champs:', Object.keys(testData).length);
            console.log('🆕 Nouveaux champs inclus: obligations sans nettoyage, assistants IA, options flexibles, métadonnées');
            
            // Envoyer à Zapier
            sendToZapier(testData);
        }

        function selectDestinationCity(cityName) {
            // Remplir le champ destination principale
            document.getElementById('main-destination').value = cityName;
            
            // Animation de confirmation
            const destinationInput = document.getElementById('main-destination');
            destinationInput.style.borderColor = '#10b981';
            destinationInput.style.backgroundColor = '#f0fdf4';
            
            setTimeout(() => {
                destinationInput.style.borderColor = '';
                destinationInput.style.backgroundColor = '';
            }, 2000);
            
            // Fermer le modal
            const modal = document.querySelector('.modal.show');
            if (modal) {
                closeModal(modal.querySelector('button'));
            }
            

        }

        function closeModal(button) {
            const modal = button.closest('.modal');
            modal.classList.remove('show');
            setTimeout(() => {
                if (modal.parentNode) {
                    modal.parentNode.removeChild(modal);
                }
            }, 300);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ba10e946173b1',t:'MTc2MTY2NzA0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

        }

        function selectDestinationCity(cityName) {
            // Remplir le champ destination principale
            document.getElementById('main-destination').value = cityName;
            
            // Animation de confirmation
            const destinationInput = document.getElementById('main-destination');
            destinationInput.style.borderColor = '#10b981';
            destinationInput.style.backgroundColor = '#f0fdf4';
            
            setTimeout(() => {
                destinationInput.style.borderColor = '';
                destinationInput.style.backgroundColor = '';
            }, 2000);
            
            // Fermer le modal
            const modal = document.querySelector('.modal.show');
            if (modal) {
                closeModal(modal.querySelector('button'));
            }
            

        }

        function closeModal(button) {
            const modal = button.closest('.modal');
            modal.classList.remove('show');
            setTimeout(() => {
                if (modal.parentNode) {
                    modal.parentNode.removeChild(modal);
                }
            }, 300);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ba10e946173b1',t:'MTc2MTY2NzA0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
